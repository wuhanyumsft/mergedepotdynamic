{"content":"    \r\n    <h1 id=\"System_ServiceModel_ServiceAuthorizationManager\">\r\n      <span class=\"lang-csharp\">ServiceAuthorizationManager</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Provides authorization access checking for service operations.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class ServiceAuthorizationManager</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">ServiceAuthorizationManager</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>This class is responsible for evaluating all policies (rules that define what a user is allowed to do), comparing the policies to claims made by a client, setting the resulting <a class=\"xref\" href=\"system.identitymodel.policy.authorizationcontext\" data-linktype=\"relative-path\">AuthorizationContext</a> to the <a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a>, and providing the authorization decision whether to allow or deny access for a given service operation for a caller.  </p>\n<p> The <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a> method is called by the <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/indigo1-md.md&quot; -->Windows Communication Foundation (WCF)<!--END INCLUDE --> infrastructure each time an attempt to access a resource is made. The method returns <code>true</code> or <code>false</code> to allow or deny access, respectively.  </p>\n<p> The ServiceAuthorizationManager is part of the <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/indigo2-md.md&quot; -->WCF<!--END INCLUDE --><em>Identity Model</em> infrastructure. The Identity Model enables you to create custom authorization policies and custom authorization schemes. <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/crabout-md.md&quot; -->For more information about<!--END INCLUDE --> how the Identity Model works, see <a href=\"../Topic/Managing%20Claims%20and%20Authorization%20with%20the%20Identity%20Model.md\" data-linktype=\"relative-path\">Managing Claims and Authorization with the Identity Model</a>.  </p>\n<h2 id=\"custom-authorization\">Custom Authorization</h2>\n<p> This class does not perform any authorization and allows users to access all service operations. To provide more restrictive authorization, you must create a custom authorization manager that checks custom policies. To do this, inherit from this class and override the <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a> method. Specify the instance of the derived class through the <a class=\"xref\" href=\"system.servicemodel.dispatcher.dispatchruntime#System_ServiceModel_Dispatcher_DispatchRuntime_ServiceAuthorizationManager_\" data-linktype=\"relative-path\">ServiceAuthorizationManager</a> property.  </p>\n<p> In <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a>, the application can use the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> object to access the caller identity (<a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_ServiceSecurityContext_\" data-linktype=\"relative-path\">ServiceSecurityContext</a>).  </p>\n<p> By getting the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_IncomingMessageHeaders_\" data-linktype=\"relative-path\">IncomingMessageHeaders</a> property, which returns a <a class=\"xref\" href=\"system.servicemodel.channels.messageheaders\" data-linktype=\"relative-path\">MessageHeaders</a> object, the application can access the service (<a class=\"xref\" href=\"system.servicemodel.channels.messageheaders#System_ServiceModel_Channels_MessageHeaders_To_\" data-linktype=\"relative-path\">To</a>), and the operation (<a class=\"xref\" href=\"system.servicemodel.channels.messageheaders#System_ServiceModel_Channels_MessageHeaders_Action_\" data-linktype=\"relative-path\">Action</a>).  </p>\n<p> By getting the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_RequestContext_\" data-linktype=\"relative-path\">RequestContext</a> property, which returns a <a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a> object, the application can access the entire request message (<a class=\"xref\" href=\"system.servicemodel.channels.requestcontext#System_ServiceModel_Channels_RequestContext_RequestMessage_\" data-linktype=\"relative-path\">RequestMessage</a>) and perform the authorization decision accordingly.  </p>\n<p> For an example, see <a href=\"../Topic/How%20to:%20Create%20a%20Custom%20Authorization%20Manager%20for%20a%20Service.md\" data-linktype=\"relative-path\">How to: Create a Custom Authorization Manager for a Service</a>.  </p>\n<p> To create custom authorization policies, implement the <a class=\"xref\" href=\"system.identitymodel.policy.iauthorizationpolicy\" data-linktype=\"relative-path\">IAuthorizationPolicy</a> class.  For an example, see <a href=\"../Topic/How%20to:%20Create%20a%20Custom%20Authorization%20Policy.md\" data-linktype=\"relative-path\">How to: Create a Custom Authorization Policy</a>.  </p>\n<p> To create a custom claim, use the <a class=\"xref\" href=\"system.identitymodel.claims.claim\" data-linktype=\"relative-path\">Claim</a> class.  For an example, see <a href=\"../Topic/How%20to:%20Create%20a%20Custom%20Claim.md\" data-linktype=\"relative-path\">How to: Create a Custom Claim</a>. To compare custom claims, you must compare claims, as shown in <a href=\"../Topic/How%20to:%20Compare%20Claims.md\" data-linktype=\"relative-path\">How to: Compare Claims</a>.  </p>\n<p> <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/crdefault-md.md&quot; -->For more information, see<!--END INCLUDE --> <a href=\"../Topic/Custom%20Authorization.md\" data-linktype=\"relative-path\">Custom Authorization</a>.  </p>\n<p> You can set the type of a custom authorization manager using the <a href=\"../Topic/%3CserviceAuthorization%3E%20element.md\" data-linktype=\"relative-path\">&amp;lt;serviceAuthorization&amp;gt;</a> in a client application configuration file.</p>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_ServiceAuthorizationManager__ctor\" data-linktype=\"self-bookmark\">ServiceAuthorizationManager()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager\" data-linktype=\"relative-path\">ServiceAuthorizationManager</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_ServiceAuthorizationManager_CheckAccess_System_ServiceModel_OperationContext_\" data-linktype=\"self-bookmark\">CheckAccess(OperationContext)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Checks authorization for the given operation context.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_ServiceAuthorizationManager_CheckAccess_System_ServiceModel_OperationContext_System_ServiceModel_Channels_Message__\" data-linktype=\"self-bookmark\">CheckAccess(OperationContext,Message)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Checks authorization for the given operation context when access to a message is required.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_System_ServiceModel_OperationContext_\" data-linktype=\"self-bookmark\">CheckAccessCore(OperationContext)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Checks authorization for the given operation context based on default policy evaluation.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_ServiceAuthorizationManager_GetAuthorizationPolicies_System_ServiceModel_OperationContext_\" data-linktype=\"self-bookmark\">GetAuthorizationPolicies(OperationContext)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the set of policies that participate in policy evaluation.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_ServiceAuthorizationManager__ctor\">\r\n    \r\n            <a id=\"System_ServiceModel_ServiceAuthorizationManager__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ServiceAuthorizationManager()</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager\" data-linktype=\"relative-path\">ServiceAuthorizationManager</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public ServiceAuthorizationManager ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_ServiceAuthorizationManager_CheckAccess_System_ServiceModel_OperationContext_\">\r\n    \r\n            <a id=\"System_ServiceModel_ServiceAuthorizationManager_CheckAccess_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CheckAccess(OperationContext)</div>        \r\n          </div>\r\n    \r\n            <p>Checks authorization for the given operation context.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual bool CheckAccess (System.ServiceModel.OperationContext operationContext);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>operationContext</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if access is granted; otherwise; otherwise <code>false</code>. The default is <code>true</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>In general, applications should override <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a> instead of this method.  </p>\n<p> Override CheckAccess if the application associates or introduces a different set of policies for the resulting <a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a> or provide a different policy evaluation (chaining) model.  </p>\n<p> This method is responsible for calling <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a>.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code shows how to override this method to enforce custom access control requirements.  </p>\n<pre><code class=\"lang-vb\" name=\"c_Federation#1\">    Public Class myServiceAuthorizationManager\n        Inherits ServiceAuthorizationManager\n\n        &#39; Override the CheckAccess method to enforce access control requirements.\n        Public Overloads Overrides Function CheckAccess(ByVal operationContext As OperationContext) As Boolean\n            Dim authContext = operationContext.ServiceSecurityContext.AuthorizationContext\n            If authContext.ClaimSets Is Nothing Then\n                Return False\n            End If\n\n            If authContext.ClaimSets.Count &lt;&gt; 1 Then\n                Return False\n            End If\n\n            Dim myClaimSet = authContext.ClaimSets(0)\n            If Not IssuedBySTS_B(myClaimSet) Then\n                Return False\n            End If\n            If myClaimSet.Count &lt;&gt; 1 Then\n                Return False\n            End If\n            Dim myClaim = myClaimSet(0)\n            If myClaim.ClaimType = &quot;http://www.tmpuri.org:accessAuthorized&quot; Then\n                Dim resource = TryCast(myClaim.Resource, String)\n                If resource Is Nothing Then\n                    Return False\n                End If\n                If resource &lt;&gt; &quot;true&quot; Then\n                    Return False\n                End If\n                Return True\n            Else\n                Return False\n            End If\n        End Function\n\n        &#39; This helper method checks whether SAML Token was issued by STS-B.     \n        &#39; It compares the Thumbprint Claim of the Issuer against the \n        &#39; Certificate of STS-B. \n        Private Function IssuedBySTS_B(ByVal myClaimSet As ClaimSet) As Boolean\n            Dim issuerClaimSet = myClaimSet.Issuer\n            If issuerClaimSet Is Nothing Then\n                Return False\n            End If\n            If issuerClaimSet.Count &lt;&gt; 1 Then\n                Return False\n            End If\n            Dim issuerClaim = issuerClaimSet(0)\n            If issuerClaim.ClaimType &lt;&gt; ClaimTypes.Thumbprint Then\n                Return False\n            End If\n            If issuerClaim.Resource Is Nothing Then\n                Return False\n            End If\n            Dim claimThumbprint() = CType(issuerClaim.Resource, Byte())\n            &#39; It is assumed that stsB_Certificate is a variable of type \n            &#39; X509Certificate2 that is initialized with the Certificate of \n            &#39; STS-B.\n            Dim stsB_Certificate = GetStsBCertificate()\n            Dim certThumbprint() = stsB_Certificate.GetCertHash()\n            If claimThumbprint.Length &lt;&gt; certThumbprint.Length Then\n                Return False\n            End If\n            For i = 0 To claimThumbprint.Length - 1\n                If claimThumbprint(i) &lt;&gt; certThumbprint(i) Then\n                    Return False\n                End If\n            Next i\n            Return True\n        End Function\n</code></pre><pre><code class=\"lang-cs\" name=\"c_Federation#1\">    public class myServiceAuthorizationManager : ServiceAuthorizationManager \n    {\n        // Override the CheckAccess method to enforce access control requirements.\n        public override bool CheckAccess(OperationContext operationContext)\n        {\n            AuthorizationContext authContext =\n            operationContext.ServiceSecurityContext.AuthorizationContext;\n            if (authContext.ClaimSets == null) return false;\n            if (authContext.ClaimSets.Count != 1) return false;\n            ClaimSet myClaimSet = authContext.ClaimSets[0];\n            if (!IssuedBySTS_B(myClaimSet)) return false;\n            if (myClaimSet.Count != 1) return false;\n            Claim myClaim = myClaimSet[0];\n            if (myClaim.ClaimType ==\n              &quot;http://www.tmpuri.org:accessAuthorized&quot;)\n            {\n                string resource = myClaim.Resource as string;\n                if (resource == null) return false;\n                if (resource != &quot;true&quot;) return false;\n                return true;\n            }\n            else return false;\n        }\n\n        // This helper method checks whether SAML Token was issued by STS-B.     \n        // It compares the Thumbprint Claim of the Issuer against the \n        // Certificate of STS-B. \n        private bool IssuedBySTS_B(ClaimSet myClaimSet)\n        {\n            ClaimSet issuerClaimSet = myClaimSet.Issuer;\n            if (issuerClaimSet == null) return false;\n            if (issuerClaimSet.Count != 1) return false;\n            Claim issuerClaim = issuerClaimSet[0];\n            if (issuerClaim.ClaimType != ClaimTypes.Thumbprint)\n                return false;\n            if (issuerClaim.Resource == null) return false;\n            byte[] claimThumbprint = (byte[])issuerClaim.Resource;\n            // It is assumed that stsB_Certificate is a variable of type \n            // X509Certificate2 that is initialized with the Certificate of \n            // STS-B.\n            X509Certificate2 stsB_Certificate = GetStsBCertificate();\n            byte[] certThumbprint = stsB_Certificate.GetCertHash();\n            if (claimThumbprint.Length != certThumbprint.Length)\n                return false;\n            for (int i = 0; i &lt; claimThumbprint.Length; i++)\n            {\n                if (claimThumbprint[i] != certThumbprint[i]) return false;\n            }\n            return true;\n        }\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_ServiceAuthorizationManager_CheckAccess_System_ServiceModel_OperationContext_System_ServiceModel_Channels_Message__\">\r\n    \r\n            <a id=\"System_ServiceModel_ServiceAuthorizationManager_CheckAccess_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CheckAccess(OperationContext,Message)</div>        \r\n          </div>\r\n    \r\n            <p>Checks authorization for the given operation context when access to a message is required.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual bool CheckAccess (System.ServiceModel.OperationContext operationContext, ref System.ServiceModel.Channels.Message message);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>operationContext</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>message</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.message\" data-linktype=\"relative-path\">Message</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.channels.message\" data-linktype=\"relative-path\">Message</a> to be examined to determine authorization.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if access is granted; otherwise; otherwise <code>false</code>. The default is <code>true</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>In general, applications should override <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a> instead of this method, which should only be used if the authorization decision depends on the message body. Because of performance issues, if possible you should redesign your application so that the authorization decision does not require access to the message body.  </p>\n<p> Override this method if the application associates or introduces a different set of policies for the resulting <a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a> and <a class=\"xref\" href=\"system.servicemodel.channels.message\" data-linktype=\"relative-path\">Message</a> or provide a different policy evaluation (chaining) model.  </p>\n<p> This method is responsible for calling <a class=\"xref\" href=\"system.servicemodel.serviceauthorizationmanager#System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\" data-linktype=\"relative-path\">CheckAccessCore</a>.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code shows how to override this method to enforce custom access control requirements that require access to the message body.  </p>\n<pre><code class=\"lang-vb\" name=\"c_Federation#6\">    Public Class myService_M_AuthorizationManager\n        Inherits ServiceAuthorizationManager\n\n        &#39; set max size for message\n        Private someMaxSize As Integer = 16000\n\n        Public Overrides Function CheckAccess(ByVal operationContext As OperationContext, _\n                                              ByRef message As Message) As Boolean\n            Dim accessAllowed = False\n            Dim requestBuffer = Message.CreateBufferedCopy(someMaxSize)\n\n            &#39; do access checks using the message parameter value and set accessAllowed appropriately\n            If accessAllowed Then\n                &#39; replace incoming message with fresh copy since accessing the message consumes it\n                Message = requestBuffer.CreateMessage()\n            End If\n            Return accessAllowed\n        End Function\n    End Class\n</code></pre><pre><code class=\"lang-cs\" name=\"c_Federation#6\">    public class myService_M_AuthorizationManager : ServiceAuthorizationManager \n    {\n        // set max size for message\n        int someMaxSize = 16000;\n        protected override bool CheckAccessCore(OperationContext operationContext, ref Message message)\n        {\n            bool accessAllowed = false;\n            MessageBuffer requestBuffer = message.CreateBufferedCopy(someMaxSize);\n\n            // do access checks using the message parameter value and set accessAllowed appropriately\n            if (accessAllowed)\n            {\n                // replace incoming message with fresh copy since accessing the message consumes it\n                message = requestBuffer.CreateMessage();\n            }\n            return accessAllowed;\n        }\n    }\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_System_ServiceModel_OperationContext_\">\r\n    \r\n            <a id=\"System_ServiceModel_ServiceAuthorizationManager_CheckAccessCore_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CheckAccessCore(OperationContext)</div>        \r\n          </div>\r\n    \r\n            <p>Checks authorization for the given operation context based on default policy evaluation.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual bool CheckAccessCore (System.ServiceModel.OperationContext operationContext);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>operationContext</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> for the current authorization request.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if access is granted; otherwise, <code>false</code>. The default is <code>true</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p><a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_ServiceSecurityContext_\" data-linktype=\"relative-path\">ServiceSecurityContext</a> is generally the result from the default policy evaluation.  </p>\n<p> Override this method to provide custom authorization decisions.  </p>\n<p> This method can be used to make authorization decisions based on claim sets that are inferred based on incoming tokens, or added through external authorization policies. It can also make authorization decisions based on properties of the incoming message: for example, the action header.  </p>\n<p> In this method, the application can use the <code>operationContext</code> parameter to access the caller identity (<a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_ServiceSecurityContext_\" data-linktype=\"relative-path\">ServiceSecurityContext</a>). By returning the <a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a> object from the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_RequestContext_\" data-linktype=\"relative-path\">RequestContext</a> property, the application can access the entire request message (<a class=\"xref\" href=\"system.servicemodel.channels.requestcontext#System_ServiceModel_Channels_RequestContext_RequestMessage_\" data-linktype=\"relative-path\">RequestMessage</a>). By returning the <a class=\"xref\" href=\"system.servicemodel.channels.messageheaders\" data-linktype=\"relative-path\">MessageHeaders</a> object from the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_IncomingMessageHeaders_\" data-linktype=\"relative-path\">IncomingMessageHeaders</a> property, the application can access the service URL (<a class=\"xref\" href=\"system.servicemodel.channels.messageheaders#System_ServiceModel_Channels_MessageHeaders_To_\" data-linktype=\"relative-path\">To</a>) and the operation (<a class=\"xref\" href=\"system.servicemodel.channels.messageheaders#System_ServiceModel_Channels_MessageHeaders_Action_\" data-linktype=\"relative-path\">Action</a>). With this information, the application can perform the authorization decision accordingly.  </p>\n<p> The claims made by a user are found in the <a class=\"xref\" href=\"system.identitymodel.claims.claimset\" data-linktype=\"relative-path\">ClaimSet</a> returned by the <a class=\"xref\" href=\"system.identitymodel.policy.authorizationcontext#System_IdentityModel_Policy_AuthorizationContext_ClaimSets_\" data-linktype=\"relative-path\">ClaimSets</a> property of the <code>AuthorizationContext</code>. The current <code>AuthorizationContext</code> is returned by the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_ServiceSecurityContext_\" data-linktype=\"relative-path\">ServiceSecurityContext</a> property of the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> class.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows an override of the CheckAccessCore method.  </p>\n<pre><code class=\"lang-cs\" name=\"c_CustomAuthMgr#6\">\tprotected override bool CheckAccessCore(OperationContext operationContext)\n\t{                \n\t  // Extract the action URI from the OperationContext. Match this against the claims\n\t  // in the AuthorizationContext.\n\t  string action = operationContext.RequestContext.RequestMessage.Headers.Action;\n\t  \n\t  // Iterate through the various claim sets in the AuthorizationContext.\n\t  foreach(ClaimSet cs in operationContext.ServiceSecurityContext.AuthorizationContext.ClaimSets)\n\t  {\n\t\t// Examine only those claim sets issued by System.\n\t\tif (cs.Issuer == ClaimSet.System)\n\t\t{\n\t\t  // Iterate through claims of type &quot;http://www.contoso.com/claims/allowedoperation&quot;.\n            foreach (Claim c in cs.FindClaims(&quot;http://www.contoso.com/claims/allowedoperation&quot;, Rights.PossessProperty))\n\t\t  {\n\t\t\t// If the Claim resource matches the action URI then return true to allow access.\n\t\t\tif (action == c.Resource.ToString())\n\t\t\t  return true;\n\t\t  }\n\t\t}\n\t  }\n\t  \n\t  // If this point is reached, return false to deny access.\n\t  return false;                 \n\t}\n</code></pre><pre><code class=\"lang-vb\" name=\"c_CustomAuthMgr#6\">    Protected Overrides Function CheckAccessCore(ByVal operationContext As OperationContext) As Boolean \n        &#39; Extract the action URI from the OperationContext. Match this against the claims.\n        &#39; in the AuthorizationContext.\n        Dim action As String = operationContext.RequestContext.RequestMessage.Headers.Action\n        \n        &#39; Iterate through the various claimsets in the AuthorizationContext.\n        Dim cs As ClaimSet\n        For Each cs In  operationContext.ServiceSecurityContext.AuthorizationContext.ClaimSets\n            &#39; Examine only those claim sets issued by System.\n            If cs.Issuer Is ClaimSet.System Then\n                &#39; Iterate through claims of type &quot;http://www.contoso.com/claims/allowedoperation&quot;.\n                Dim c As Claim\n                For Each c In  cs.FindClaims(&quot;http://www.contoso.com/claims/allowedoperation&quot;, _\n                     Rights.PossessProperty)\n                    &#39; If the Claim resource matches the action URI then return true to allow access.\n                    If action = c.Resource.ToString() Then\n                        Return True\n                    End If\n                Next c\n            End If\n        Next cs \n        &#39; If this point is reached, return false to deny access.\n        Return False\n    \n    End Function \n</code></pre><p> For another example, see <a href=\"../Topic/How%20to:%20Create%20a%20Custom%20Authorization%20Manager%20for%20a%20Service.md\" data-linktype=\"relative-path\">How to: Create a Custom Authorization Manager for a Service</a>.</p>\n\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_ServiceAuthorizationManager_GetAuthorizationPolicies_System_ServiceModel_OperationContext_\">\r\n    \r\n            <a id=\"System_ServiceModel_ServiceAuthorizationManager_GetAuthorizationPolicies_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetAuthorizationPolicies(OperationContext)</div>        \r\n          </div>\r\n    \r\n            <p>Gets the set of policies that participate in policy evaluation.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IdentityModel.Policy.IAuthorizationPolicy&gt; GetAuthorizationPolicies (System.ServiceModel.OperationContext operationContext);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>operationContext</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> of the current authorization request.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.readonlycollection-1\" data-linktype=\"relative-path\">ReadOnlyCollection</a>&lt;<a class=\"xref\" href=\"system.identitymodel.policy.iauthorizationpolicy\" data-linktype=\"relative-path\">IAuthorizationPolicy</a>&gt;</div>\r\n                  </div>\r\n                  <p>A <span class=\"xref\">stem.Collections.ObjectModel.ReadOnlyCollection`1</span> of type <a class=\"xref\" href=\"system.identitymodel.policy.iauthorizationpolicy\" data-linktype=\"relative-path\">IAuthorizationPolicy</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/indigo1-md.md&quot; -->Windows Communication Foundation (WCF)<!--END INCLUDE --> implementation provides a default set of authorization policies. These include the primary token that contains the credentials of the requester and all supporting tokens, transport tokens, and external policies if specified.  </p>\n<p> You can override this implementation and provide a different set of policies.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.ServiceModel.ServiceAuthorizationManager.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.ServiceModel.ServiceAuthorizationManager.yml\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.ServiceAuthorizationManager\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.ServiceAuthorizationManager..ctor\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.ServiceAuthorizationManager.CheckAccess\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.ServiceAuthorizationManager.CheckAccessCore\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.ServiceAuthorizationManager.GetAuthorizationPolicies\">\r\n<meta name=\"APILocation\" content=\"System.ServiceModel.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"38de183d-2ea1-cd04-3049-156b8405fc39\">\r\n<meta name=\"original_ecmaxml_local_path\" content=\"W:\\vejk\\s\\fulldocset\\xml\\System.ServiceModel\\ServiceAuthorizationManager.xml\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides authorization access checking for service operations.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.ServiceModel/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.ServiceModel.ServiceAuthorizationManager\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.ServiceModel.ServiceAuthorizationManager.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.ServiceModel.ServiceAuthorizationManager.yml","open_to_public_contributors":true,"api_name":["System.ServiceModel.ServiceAuthorizationManager","System.ServiceModel.ServiceAuthorizationManager..ctor","System.ServiceModel.ServiceAuthorizationManager.CheckAccess","System.ServiceModel.ServiceAuthorizationManager.CheckAccessCore","System.ServiceModel.ServiceAuthorizationManager.GetAuthorizationPolicies"],"api_location":["System.ServiceModel.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.ServiceModel.ServiceAuthorizationManager","System::ServiceModel::ServiceAuthorizationManager","System.ServiceModel.ServiceAuthorizationManager.#ctor","System::ServiceModel::ServiceAuthorizationManager::#ctor","System.ServiceModel.ServiceAuthorizationManager.CheckAccess","System::ServiceModel::ServiceAuthorizationManager::CheckAccess","System.ServiceModel.ServiceAuthorizationManager.CheckAccessCore","System::ServiceModel::ServiceAuthorizationManager::CheckAccessCore","System.ServiceModel.ServiceAuthorizationManager.GetAuthorizationPolicies","System::ServiceModel::ServiceAuthorizationManager::GetAuthorizationPolicies"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"38de183d-2ea1-cd04-3049-156b8405fc39","original_ecmaxml_local_path":"W:\\vejk\\s\\fulldocset\\xml\\System.ServiceModel\\ServiceAuthorizationManager.xml","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.ServiceModel/ServiceAuthorizationManager.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ServiceAuthorizationManager class | Microsoft Docs","_op_ogTitle":"ServiceAuthorizationManager class","description":"Provides authorization access checking for service operations.\n","toc_asset_id":"_splitted/System.ServiceModel/toc.json","toc_rel":"_splitted/System.ServiceModel/toc.json","source_url":"","ms.assetid":"System.ServiceModel.ServiceAuthorizationManager","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.servicemodel.serviceauthorizationmanager","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.servicemodel.serviceauthorizationmanager","fileRelativePath":"System.ServiceModel.ServiceAuthorizationManager.html"},"themesRelativePathToOutputRoot":"_themes/"}