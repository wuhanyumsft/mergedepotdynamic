{"content":"    \r\n    <h1 id=\"System_Runtime_InteropServices_MarshalAsAttribute\">\r\n      <span class=\"lang-csharp\">MarshalAsAttribute</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Indicates how to marshal the data between managed and unmanaged code.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">[System.AttributeUsage(System.AttributeTargets.Field | System.AttributeTargets.Parameter | System.AttributeTargets.ReturnValue, Inherited=false)]\n[System.Runtime.InteropServices.ComVisible(true)]\npublic sealed class MarshalAsAttribute : Attribute</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a>\r\n          </div>\r\n        </li>\r\n        <li class=\"l1\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute\" data-linktype=\"relative-path\">System.Attribute</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l2\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">MarshalAsAttribute</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_Assembly_System_Type_\" data-linktype=\"relative-path\">GetCustomAttribute(Assembly,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_Assembly_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttribute(Assembly,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_MemberInfo_System_Type_\" data-linktype=\"relative-path\">GetCustomAttribute(MemberInfo,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_MemberInfo_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttribute(MemberInfo,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_Module_System_Type_\" data-linktype=\"relative-path\">GetCustomAttribute(Module,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_Module_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttribute(Module,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_ParameterInfo_System_Type_\" data-linktype=\"relative-path\">GetCustomAttribute(ParameterInfo,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttribute_System_Reflection_ParameterInfo_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttribute(ParameterInfo,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Assembly_\" data-linktype=\"relative-path\">GetCustomAttributes(Assembly)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Assembly_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(Assembly,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Assembly_System_Type_\" data-linktype=\"relative-path\">GetCustomAttributes(Assembly,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Assembly_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(Assembly,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_MemberInfo_\" data-linktype=\"relative-path\">GetCustomAttributes(MemberInfo)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_MemberInfo_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(MemberInfo,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_MemberInfo_System_Type_\" data-linktype=\"relative-path\">GetCustomAttributes(MemberInfo,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_MemberInfo_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(MemberInfo,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Module_\" data-linktype=\"relative-path\">GetCustomAttributes(Module)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Module_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(Module,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Module_System_Type_\" data-linktype=\"relative-path\">GetCustomAttributes(Module,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_Module_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(Module,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_ParameterInfo_\" data-linktype=\"relative-path\">GetCustomAttributes(ParameterInfo)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_ParameterInfo_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(ParameterInfo,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_ParameterInfo_System_Type_\" data-linktype=\"relative-path\">GetCustomAttributes(ParameterInfo,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetCustomAttributes_System_Reflection_ParameterInfo_System_Type_System_Boolean_\" data-linktype=\"relative-path\">GetCustomAttributes(ParameterInfo,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefaultAttribute\" data-linktype=\"relative-path\">IsDefaultAttribute()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_Assembly_System_Type_\" data-linktype=\"relative-path\">IsDefined(Assembly,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_Assembly_System_Type_System_Boolean_\" data-linktype=\"relative-path\">IsDefined(Assembly,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_MemberInfo_System_Type_\" data-linktype=\"relative-path\">IsDefined(MemberInfo,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_MemberInfo_System_Type_System_Boolean_\" data-linktype=\"relative-path\">IsDefined(MemberInfo,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_Module_System_Type_\" data-linktype=\"relative-path\">IsDefined(Module,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_Module_System_Type_System_Boolean_\" data-linktype=\"relative-path\">IsDefined(Module,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_ParameterInfo_System_Type_\" data-linktype=\"relative-path\">IsDefined(ParameterInfo,Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_IsDefined_System_Reflection_ParameterInfo_System_Type_System_Boolean_\" data-linktype=\"relative-path\">IsDefined(ParameterInfo,Type,Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_Match_System_Object_\" data-linktype=\"relative-path\">Match(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_System_Runtime_InteropServices__Attribute_GetIDsOfNames_System_Guid__System_IntPtr_System_UInt32_System_UInt32_System_IntPtr_\" data-linktype=\"relative-path\">_Attribute.GetIDsOfNames(Guid,IntPtr,UInt32,UInt32,IntPtr)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_System_Runtime_InteropServices__Attribute_GetTypeInfo_System_UInt32_System_UInt32_System_IntPtr_\" data-linktype=\"relative-path\">_Attribute.GetTypeInfo(UInt32,UInt32,IntPtr)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_System_Runtime_InteropServices__Attribute_GetTypeInfoCount_System_UInt32__\" data-linktype=\"relative-path\">_Attribute.GetTypeInfoCount(UInt32)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_System_Runtime_InteropServices__Attribute_Invoke_System_UInt32_System_Guid__System_UInt32_System_Int16_System_IntPtr_System_IntPtr_System_IntPtr_System_IntPtr_\" data-linktype=\"relative-path\">_Attribute.Invoke(UInt32,Guid,UInt32,Int16,IntPtr,IntPtr,IntPtr,IntPtr)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.attribute#System_Attribute_TypeId\" data-linktype=\"relative-path\">TypeId</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>You can apply this attribute to parameters, fields, or return values.  </p>\n<p> This attribute is optional, as each data type has a default marshaling behavior. This attribute is only necessary when a given type can be marshaled to multiple types. For example, you can marshal a string to unmanaged code as either a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>, a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>, a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>, or a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>. By default, the common language runtime marshals a string parameter as a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> to COM methods. You can apply the MarshalAsAttribute attribute to an individual field or parameter to cause that particular string to be marshaled as a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> instead of a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>. The <a href=\"../Topic/Tlbexp.exe%20(Type%20Library%20Exporter).md\" data-linktype=\"relative-path\">Tlbexp.exe (Type Library Exporter)</a> passes your marshaling preferences to the common language runtime.  </p>\n<p> Some parameters and return values have different default marshaling behavior when used with COM interop or platform invoke. By default, the runtime marshals a string parameter (and fields in a value type) as a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> to a platform invoke method or function. For additional information, see <a href=\"../Topic/Default%20Marshaling%20Behavior.md\" data-linktype=\"relative-path\">Default Marshaling Behavior</a>.  </p>\n<p> In most cases, the attribute simply identifies the format of the unmanaged data using the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> enumeration, as shown in the following C# signature:  </p>\n<pre><code class=\"lang-cs\" name=\"system.runtime.interopservices.MarshalAsAttribute#2\">   public void SomeMethod([MarshalAs(UnmanagedType.LPStr)] String s)\n</code></pre><pre><code class=\"lang-vb\" name=\"system.runtime.interopservices.MarshalAsAttribute#2\">   Public Sub SomeMethod(&lt;MarshalAs(UnmanagedType.LPStr)&gt; s As String)\n</code></pre><p> Some <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> enumeration members require additional information. For example, additional information is needed when the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> is <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>. For a complete description of how to use this attribute with arrays, see <a href=\"../Topic/Default%20Marshaling%20for%20Arrays.md\" data-linktype=\"relative-path\">Default Marshaling for Arrays</a>.  </p>\n<p> The <a href=\"../Topic/Tlbimp.exe%20(Type%20Library%20Importer).md\" data-linktype=\"relative-path\">Tlbimp.exe (Type Library Importer)</a> also applies this attribute to parameters, fields, and return values to indicate that the data type in the input type library is not the default type for the corresponding managed data type. Tlbimp.exe always applies the MarshalAsAttribute to <a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a> and <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a> types for clarity, regardless of the type specified in the input type library.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The MarshalAsAttribute does not support marshaling of generic types.</p>\n</div>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Int16_\" data-linktype=\"self-bookmark\">MarshalAsAttribute(Int16)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute\" data-linktype=\"relative-path\">MarshalAsAttribute</a> class with the specified <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> value.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Runtime_InteropServices_UnmanagedType_\" data-linktype=\"self-bookmark\">MarshalAsAttribute(UnmanagedType)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute\" data-linktype=\"relative-path\">MarshalAsAttribute</a> class with the specified <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> enumeration member.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Fields\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_ArraySubType\" data-linktype=\"self-bookmark\">ArraySubType</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Specifies the element type of the unmanaged <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> or <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_IidParameterIndex\" data-linktype=\"self-bookmark\">IidParameterIndex</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Specifies the parameter index of the unmanaged <code>iid_is</code> attribute used by COM.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_MarshalCookie\" data-linktype=\"self-bookmark\">MarshalCookie</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Provides additional information to a custom marshaler.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\" data-linktype=\"self-bookmark\">MarshalType</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Specifies the fully qualified name of a custom marshaler.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef\" data-linktype=\"self-bookmark\">MarshalTypeRef</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Implements <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\" data-linktype=\"relative-path\">MarshalType</a> as a type.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType\" data-linktype=\"self-bookmark\">SafeArraySubType</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Indicates the element type of the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_SafeArrayUserDefinedSubType\" data-linktype=\"self-bookmark\">SafeArrayUserDefinedSubType</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Indicates the user-defined element type of the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_SizeConst\" data-linktype=\"self-bookmark\">SizeConst</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Indicates the number of elements in the fixed-length array or the number of characters (not bytes) in a string to import.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex\" data-linktype=\"self-bookmark\">SizeParamIndex</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Indicates the zero-based parameter that contains the count of array elements, similar to <code>size_is</code> in COM.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Runtime_InteropServices_MarshalAsAttribute_Value\" data-linktype=\"self-bookmark\">Value</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> value the data is to be marshaled as.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Int16_\">\r\n    \r\n            <a id=\"System_Runtime_InteropServices_MarshalAsAttribute__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">MarshalAsAttribute(Int16)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute\" data-linktype=\"relative-path\">MarshalAsAttribute</a> class with the specified <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> value.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public MarshalAsAttribute (short unmanagedType);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>unmanagedType</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.int16\" data-linktype=\"relative-path\">Int16</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The value the data is to be marshaled as.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This constructor takes an underlying 16-bit signed integer that represents each <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> enumeration member. The <a href=\"../Topic/Tlbimp.exe%20(Type%20Library%20Importer).md\" data-linktype=\"relative-path\">Tlbimp.exe (Type Library Importer)</a> uses this constructor.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Runtime_InteropServices_UnmanagedType_\">\r\n    \r\n            <a id=\"System_Runtime_InteropServices_MarshalAsAttribute__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">MarshalAsAttribute(UnmanagedType)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute\" data-linktype=\"relative-path\">MarshalAsAttribute</a> class with the specified <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> enumeration member.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public MarshalAsAttribute (System.Runtime.InteropServices.UnmanagedType unmanagedType);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>unmanagedType</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The value the data is to be marshaled as.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>For readable code that is less prone to error, always use this constructor.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"fields\">\r\n        <h2>Fields\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_ArraySubType\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ArraySubType</div>        \r\n          </div>\r\n    \r\n            <p>Specifies the element type of the unmanaged <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> or <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Runtime.InteropServices.UnmanagedType ArraySubType;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>You can set this parameter to a value from the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">System.Runtime.InteropServices.UnmanagedType</a> enumeration to specify the type of the array&#39;s elements. If a type is not specified, the default unmanaged type corresponding to the managed array&#39;s element type is used. For example, the <code>ArraySubType</code> for a <code>LPWStr</code> array in COM is <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">System.Runtime.InteropServices.UnmanagedType</a>. For additional information, see <a href=\"../Topic/Default%20Marshaling%20for%20Arrays.md\" data-linktype=\"relative-path\">Default Marshaling for Arrays</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_IidParameterIndex\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IidParameterIndex</div>        \r\n          </div>\r\n    \r\n            <p>Specifies the parameter index of the unmanaged <code>iid_is</code> attribute used by COM.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public int IidParameterIndex;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_MarshalCookie\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">MarshalCookie</div>        \r\n          </div>\r\n    \r\n            <p>Provides additional information to a custom marshaler.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public string MarshalCookie;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This field is optional when using a custom marshaler.  </p>\n<p> You can set this field to a string that supplies additional information to a custom marshaler. For example, the same marshaler can be used to provide a number of wrappers, where the cookie is used to indicate the specific wrapper.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">MarshalType</div>        \r\n          </div>\r\n    \r\n            <p>Specifies the fully qualified name of a custom marshaler.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public string MarshalType;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>You can use either the MarshalType or <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef\" data-linktype=\"relative-path\">System.Runtime.InteropServices.MarshalAsAttribute.MarshalTypeRef</a> field specify a custom marshaler type for the attributed parameter, field, or return type. The MarshalType field enables you to specify a string representing the fully qualified name of a custom marshaler. It is useful for late-bound references, but is less preferred than <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef\" data-linktype=\"relative-path\">MarshalTypeRef</a> for specifying a custom marshaler. For additional information about creating and using custom marshalers, see <a href=\"http://msdn.microsoft.com/en-us/49f9ac47-1619-4d6e-9da6-bf06bba12079\" data-linktype=\"external\">Custom Marshaling</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">MarshalTypeRef</div>        \r\n          </div>\r\n    \r\n            <p>Implements <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\" data-linktype=\"relative-path\">MarshalType</a> as a type.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public Type MarshalTypeRef;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>You can use either the MarshalTypeRef or <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\" data-linktype=\"relative-path\">MarshalType</a> field to specify a custom marshaler type for the attributed parameter, field, or return type. The MarshalTypeRef field allows easier usage of <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\" data-linktype=\"relative-path\">MarshalType</a> by shortening the syntax. In the following example, the first line represents syntax using <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType\" data-linktype=\"relative-path\">MarshalType</a> and the second line represents syntax using MarshalTypeRef.  </p>\n<pre><code>[MarshalAs(UnmanagedType.CustomMarshaler, MarshalType = &quot;Assembly, NameSpace.TypeName&quot;)]   \n</code></pre><pre><code>[MarshalAs(UnmanagedType.CustomMarshaler, MarshalTypeRef = typeof(NameSpace.TypeName)]  \n</code></pre><p> You can set a <a class=\"xref\" href=\"system.type\" data-linktype=\"relative-path\">Type</a> object using <code>typeof</code> in C#, <code>GetType</code> in Visual Basic, or <code>typeid</code> in C++. For additional information about creating and using custom marshalers, see <a href=\"http://msdn.microsoft.com/en-us/49f9ac47-1619-4d6e-9da6-bf06bba12079\" data-linktype=\"external\">Custom Marshaling</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SafeArraySubType</div>        \r\n          </div>\r\n    \r\n            <p>Indicates the element type of the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Runtime.InteropServices.VarEnum SafeArraySubType;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>You can set this field to a value from the <a class=\"xref\" href=\"system.runtime.interopservices.varenum\" data-linktype=\"relative-path\">System.Runtime.InteropServices.VarEnum</a> enumeration to specify the type of the safe array&#39;s elements. If a type is not specified, the managed element type&#39;s default type (if passed as a VARIANT) is used. For example, the <code>SafeArraySubType</code> for an <code>int</code> array in COM is <a class=\"xref\" href=\"system.runtime.interopservices.varenum\" data-linktype=\"relative-path\">VarEnum</a>. For additional information, see <a href=\"../Topic/Default%20Marshaling%20for%20Arrays.md\" data-linktype=\"relative-path\">Default Marshaling for Arrays</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_SafeArrayUserDefinedSubType\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SafeArrayUserDefinedSubType</div>        \r\n          </div>\r\n    \r\n            <p>Indicates the user-defined element type of the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public Type SafeArrayUserDefinedSubType;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Initialize this field with your custom type to enable the elements of the <code>SAFEARRAY</code> to be marshaled successfully. This field is only needed when the <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType\" data-linktype=\"relative-path\">System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType</a> is either <a class=\"xref\" href=\"system.runtime.interopservices.varenum\" data-linktype=\"relative-path\">System.Runtime.InteropServices.VarEnum</a>, <a class=\"xref\" href=\"system.runtime.interopservices.varenum\" data-linktype=\"relative-path\">System.Runtime.InteropServices.VarEnum</a>, or <a class=\"xref\" href=\"system.runtime.interopservices.varenum\" data-linktype=\"relative-path\">System.Runtime.InteropServices.VarEnum</a>. For additional information, see <a href=\"../Topic/Default%20Marshaling%20for%20Arrays.md\" data-linktype=\"relative-path\">Default Marshaling for Arrays</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_SizeConst\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SizeConst</div>        \r\n          </div>\r\n    \r\n            <p>Indicates the number of elements in the fixed-length array or the number of characters (not bytes) in a string to import.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public int SizeConst;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This field is required for the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> and <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> members of the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">System.Runtime.InteropServices.UnmanagedType</a> enumeration. Because the compressed format of the metadata is limited to 0x1FFFFFFF, the range of allowed values for SizeConst are (&gt;= 0 and &lt;= 0x1FFFFFFF).  </p>\n<p> For additional information, see <a href=\"../Topic/Default%20Marshaling%20for%20Arrays.md\" data-linktype=\"relative-path\">Default Marshaling for Arrays</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SizeParamIndex</div>        \r\n          </div>\r\n    \r\n            <p>Indicates the zero-based parameter that contains the count of array elements, similar to <code>size_is</code> in COM.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public short SizeParamIndex;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The SizeParamIndex field supports managed-to-unmanaged and unmanaged-to-managed calls. It does not have any effect on managed code that calls COM objects.  </p>\n<p> Depending on the managed type and the attributes applied to it, the array can be passed as a safe array or C-style array.  </p>\n<p> When arrays are passed as C-style arrays, the marshaler cannot determine the size of the array. Therefore, to pass an managed array to an unmanaged function or method, you must provide two arguments:  </p>\n<ul>\n<li><p>The array, defined by reference or value.  </p>\n</li>\n<li><p>The array size, defined by reference or value.  </p>\n<p>The zero-based index of the array size parameter is defined by using the SizeParamIndex field.  </p>\n<p>If you specify both SizeParamIndex and <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute#System_Runtime_InteropServices_MarshalAsAttribute_SizeConst\" data-linktype=\"relative-path\">System.Runtime.InteropServices.MarshalAsAttribute.SizeConst</a> with a <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">System.Runtime.InteropServices.UnmanagedType</a> field, the sum of the fields&#39; values produces a size total.  </p>\n<p>For more information, see <a href=\"../Topic/Default%20Marshaling%20for%20Arrays.md\" data-linktype=\"relative-path\">Default Marshaling for Arrays</a>.</p>\n</li>\n</ul>\n\r\n    \r\n            <h4>Example</h4>\r\n            <pre><code class=\"lang-cpp\" name=\"System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex#1\">using namespace System;\nusing namespace System::Runtime::InteropServices;\n\n// Force the layout of your fields to the C-style struct layout.\n// Without this, the .NET Framework will reorder your fields.\n\n[StructLayoutAttribute(LayoutKind::Sequential)]\nvalue struct Vertex\n{\npublic:\n   float x;\n   float y;\n   float z;\n};\n\n\n// Add [In] or [In, Out] attributes as appropriate.\n// Marshal as a C-style array of Vertex, where the second (SizeParamIndex is zero-based)\n// parameter (size) contains the count of array elements.\n\n[DllImport(&quot;SomeDLL.dll&quot;)]\nextern void SomeUnsafeMethod( [MarshalAs(UnmanagedType::LPArray,SizeParamIndex=1)]array&lt;Vertex&gt;^data, long size );\nint main()\n{\n   array&lt;Vertex&gt;^verts = gcnew array&lt;Vertex&gt;(3);\n   SomeUnsafeMethod( verts, verts-&gt;Length );\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex#1\">Option Strict Off\n\nImports System.Runtime.InteropServices\nImports SomeNamespace\n\nNamespace SomeNamespace\n    &#39; Force the layout of your fields to the C style struct layout.\n    &#39; Without this, the .NET Framework will reorder your fields.\n    \n    &lt;StructLayout(LayoutKind.Sequential)&gt; _\n    Structure Vertex\n        Dim x As Decimal\n        Dim y As Decimal\n        Dim z As Decimal\n    End Structure\n\n    Class SomeClass\n        &#39; Add [In] or [In, Out] attributes as approppriate.\n        &#39; Marshal as a C style array of Vertex, where the second (SizeParamIndex is zero-based)\n        &#39;  parameter (size) contains the count of array elements.\n\n        Declare Auto Sub SomeUnsafeMethod Lib &quot;somelib.dll&quot; ( _\n                                      &lt;MarshalAs(UnmanagedType.LPArray, SizeParamIndex:=1)&gt; data() As Vertex, _\n                                      size As Long ) \n\n        Public Sub SomeMethod()\n            Dim verts(3) As Vertex\n            SomeUnsafeMethod( verts, verts.Length )\n        End Sub\n\n    End Class\n\nEnd Namespace\n\nModule Test\n\tSub Main\n        Dim AClass As New SomeClass\n\n        AClass.SomeMethod\n    \tEnd Sub\nEnd Module\n</code></pre><pre><code class=\"lang-cs\" name=\"System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex#1\">using System.Runtime.InteropServices;\nusing SomeNamespace;\n\nnamespace SomeNamespace\n{\n    // Force the layout of your fields to the C style struct layout.\n    // Without this, the .NET Framework will reorder your fields.\n    [StructLayout(LayoutKind.Sequential)]\n    public struct Vertex\n    {\n    \tfloat\tx;\n\tfloat\ty;\n    \tfloat\tz;\n    }\n\n    class SomeClass\n    {\n        // Add [In] or [In, Out] attributes as approppriate.\n        // Marshal as a C style array of Vertex, where the second (SizeParamIndex is zero-based)\n        //  parameter (size) contains the count of array elements.\n        [DllImport (&quot;SomeDll.dll&quot;)]\n        public static extern void SomeUnsafeMethod(\n                                      [MarshalAs(UnmanagedType.LPArray, SizeParamIndex=1)] Vertex[] data,\n                                      long size );\n\n        public void SomeMethod()\n        {\n            Vertex[] verts = new Vertex[3];\n            SomeUnsafeMethod( verts, verts.Length );\n        }\n\n    }\n}\n\nclass Test\n{\n\tpublic static void Main()\n    {\n        SomeClass AClass = new SomeClass();\n\n        AClass.SomeMethod();\n    }\n}\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Runtime_InteropServices_MarshalAsAttribute_Value\">\r\n    \r\n            <a id=\"System_Runtime_InteropServices_MarshalAsAttribute_Value_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Value</div>        \r\n          </div>\r\n    \r\n            <p>Gets the <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> value the data is to be marshaled as.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Runtime.InteropServices.UnmanagedType Value { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> value the data is to be marshaled as.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This value is used with <a class=\"xref\" href=\"system.runtime.interopservices.marshalasattribute\" data-linktype=\"relative-path\">MarshalAsAttribute</a> to indicate how types should be marshaled between managed and unmanaged code. In some cases, you can use this field with certain <code>UnmanagedType</code> enumeration members. For <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a> and <a class=\"xref\" href=\"system.runtime.interopservices.unmanagedtype\" data-linktype=\"relative-path\">UnmanagedType</a>, you must use additional named parameters.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Runtime.InteropServices.MarshalAsAttribute.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Runtime.InteropServices.MarshalAsAttribute.yml\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute..ctor\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.IidParameterIndex\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.MarshalCookie\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.MarshalType\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.MarshalTypeRef\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.SizeConst\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex\">\r\n<meta name=\"APIName\" content=\"System.Runtime.InteropServices.MarshalAsAttribute.Value\">\r\n<meta name=\"APILocation\" content=\"mscorlib.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"83f7b0d3-7276-eb94-d8a2-9be398341250\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Indicates how to marshal the data between managed and unmanaged code.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Runtime.InteropServices/toc.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Runtime.InteropServices.MarshalAsAttribute\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Runtime.InteropServices.MarshalAsAttribute.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Runtime.InteropServices.MarshalAsAttribute.yml","open_to_public_contributors":true,"api_name":["System.Runtime.InteropServices.MarshalAsAttribute","System.Runtime.InteropServices.MarshalAsAttribute..ctor","System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType","System.Runtime.InteropServices.MarshalAsAttribute.IidParameterIndex","System.Runtime.InteropServices.MarshalAsAttribute.MarshalCookie","System.Runtime.InteropServices.MarshalAsAttribute.MarshalType","System.Runtime.InteropServices.MarshalAsAttribute.MarshalTypeRef","System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType","System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType","System.Runtime.InteropServices.MarshalAsAttribute.SizeConst","System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex","System.Runtime.InteropServices.MarshalAsAttribute.Value"],"api_location":["mscorlib.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Runtime.InteropServices.MarshalAsAttribute","System::Runtime::InteropServices::MarshalAsAttribute","System.Runtime.InteropServices.MarshalAsAttribute.#ctor","System::Runtime::InteropServices::MarshalAsAttribute::#ctor","System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType","System::Runtime::InteropServices::MarshalAsAttribute::ArraySubType","System.Runtime.InteropServices.MarshalAsAttribute.IidParameterIndex","System::Runtime::InteropServices::MarshalAsAttribute::IidParameterIndex","System.Runtime.InteropServices.MarshalAsAttribute.MarshalCookie","System::Runtime::InteropServices::MarshalAsAttribute::MarshalCookie","System.Runtime.InteropServices.MarshalAsAttribute.MarshalType","System::Runtime::InteropServices::MarshalAsAttribute::MarshalType","System.Runtime.InteropServices.MarshalAsAttribute.MarshalTypeRef","System::Runtime::InteropServices::MarshalAsAttribute::MarshalTypeRef","System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType","System::Runtime::InteropServices::MarshalAsAttribute::SafeArraySubType","System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType","System::Runtime::InteropServices::MarshalAsAttribute::SafeArrayUserDefinedSubType","System.Runtime.InteropServices.MarshalAsAttribute.SizeConst","System::Runtime::InteropServices::MarshalAsAttribute::SizeConst","System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex","System::Runtime::InteropServices::MarshalAsAttribute::SizeParamIndex","System.Runtime.InteropServices.MarshalAsAttribute.Value","System::Runtime::InteropServices::MarshalAsAttribute::Value"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"83f7b0d3-7276-eb94-d8a2-9be398341250","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Runtime.InteropServices/MarshalAsAttribute.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"MarshalAsAttribute class | Microsoft Docs","_op_ogTitle":"MarshalAsAttribute class","description":"Indicates how to marshal the data between managed and unmanaged code.\n","toc_asset_id":"_splitted/System.Runtime.InteropServices/toc.json","toc_rel":"_splitted/System.Runtime.InteropServices/toc.json","source_url":"","ms.assetid":"System.Runtime.InteropServices.MarshalAsAttribute","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.runtime.interopservices.marshalasattribute","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.runtime.interopservices.marshalasattribute","fileRelativePath":"System.Runtime.InteropServices.MarshalAsAttribute.html"},"themesRelativePathToOutputRoot":"_themes/"}