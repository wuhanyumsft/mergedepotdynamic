{"content":"    \r\n    <h1 id=\"System_ServiceModel_OperationContext\">\r\n      <span class=\"lang-csharp\">OperationContext</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Provides access to the execution context of a service method.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public sealed class OperationContext : System.ServiceModel.IExtensibleObject&lt;System.ServiceModel.OperationContext&gt;</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">OperationContext</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>Use the OperationContext from within a service operation to access the current operation execution environment. In particular, the operation context is used to access callback channels in duplex services, to store extra state data across portions of the operations, and to access incoming message headers and properties as well as add outgoing message headers and properties.  </p>\n<p> For more information about using extensions to store state data, see <a href=\"../Topic/Extensible%20Objects.md\" data-linktype=\"relative-path\">Extensible Objects</a>.  </p>\n<p> The OperationContext has the following properties and methods.  </p>\n<ul>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_Current_\" data-linktype=\"relative-path\">Current</a> property returns the OperationContext object representing the current execution context.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_ServiceSecurityContext_\" data-linktype=\"relative-path\">ServiceSecurityContext</a> property returns the security environment under which the method executes.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_EndpointDispatcher_\" data-linktype=\"relative-path\">EndpointDispatcher</a> property gets the operation&#39;s <a class=\"xref\" href=\"system.servicemodel.dispatcher.endpointdispatcher\" data-linktype=\"relative-path\">System.ServiceModel.Dispatcher.EndpointDispatcher</a>.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_Extensions_\" data-linktype=\"relative-path\">Extensions</a> property returns an extension collection for the current OperationContext.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_Host_\" data-linktype=\"relative-path\">Host</a> property returns the <a class=\"xref\" href=\"system.servicemodel.servicehostbase\" data-linktype=\"relative-path\">ServiceHostBase</a> object that manages the service.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_HasSupportingTokens_\" data-linktype=\"relative-path\">HasSupportingTokens</a> property returns a value that indicates whether the method has supporting tokens, if so, the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_SupportingTokens_\" data-linktype=\"relative-path\">SupportingTokens</a> property gets them.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_IncomingMessageHeaders_\" data-linktype=\"relative-path\">IncomingMessageHeaders</a>, <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_IncomingMessageProperties_\" data-linktype=\"relative-path\">IncomingMessageProperties</a>, and <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_IncomingMessageVersion_\" data-linktype=\"relative-path\">IncomingMessageVersion</a> properties get these items from the incoming message.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_OperationCompleted\" data-linktype=\"relative-path\">OperationCompleted</a> event is fired when the operation has completed.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_OutgoingMessageHeaders_\" data-linktype=\"relative-path\">OutgoingMessageHeaders</a> and <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_OutgoingMessageProperties_\" data-linktype=\"relative-path\">OutgoingMessageProperties</a> properties get these items for the outbound message.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_RequestContext_\" data-linktype=\"relative-path\">RequestContext</a> property returns the <a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a> implementation for the method.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_InstanceContext_\" data-linktype=\"relative-path\">InstanceContext</a> property returns the <a class=\"xref\" href=\"system.servicemodel.instancecontext\" data-linktype=\"relative-path\">InstanceContext</a> associated with the operation.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_SessionId_\" data-linktype=\"relative-path\">SessionId</a> property returns the session identifier for the current channel and object.  </p>\n</li>\n<li><p>The &lt;xref:System.ServiceModel.OperationContext.GetCallbackChannel%2A&gt; method returns a callback channel to the caller in the case of duplex communication.  </p>\n</li>\n<li><p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_SetTransactionComplete_\" data-linktype=\"relative-path\">SetTransactionComplete</a> method commits the current transaction.</p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext__ctor_System_ServiceModel_IContextChannel_\" data-linktype=\"self-bookmark\">OperationContext(IContextChannel)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> class that uses the specified <a class=\"xref\" href=\"system.servicemodel.icontextchannel\" data-linktype=\"relative-path\">IContextChannel</a> in a client application.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_Channel\" data-linktype=\"self-bookmark\">Channel</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the channel associated with the current <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> object.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_ClaimsPrincipal\" data-linktype=\"self-bookmark\">ClaimsPrincipal</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the claims-based principal associated with the operation.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_Current\" data-linktype=\"self-bookmark\">Current</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets the execution context for the current thread.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_EndpointDispatcher\" data-linktype=\"self-bookmark\">EndpointDispatcher</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets the endpoint dispatcher for the endpoint to inspect or modify.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_Extensions\" data-linktype=\"self-bookmark\">Extensions</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the collection of service extensions from the current message context.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_HasSupportingTokens\" data-linktype=\"self-bookmark\">HasSupportingTokens</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a value that indicates whether the incoming message has supporting tokens.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_Host\" data-linktype=\"self-bookmark\">Host</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the <a class=\"xref\" href=\"system.servicemodel.servicehost\" data-linktype=\"relative-path\">ServiceHost</a> for the current service object.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_IncomingMessageHeaders\" data-linktype=\"self-bookmark\">IncomingMessageHeaders</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the incoming message headers for the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_IncomingMessageProperties\" data-linktype=\"self-bookmark\">IncomingMessageProperties</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the message properties for the incoming message in the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_IncomingMessageVersion\" data-linktype=\"self-bookmark\">IncomingMessageVersion</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the incoming SOAP message version for the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_InstanceContext\" data-linktype=\"self-bookmark\">InstanceContext</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the <a class=\"xref\" href=\"system.servicemodel.instancecontext\" data-linktype=\"relative-path\">InstanceContext</a> object that manages the current service instance.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_IsUserContext\" data-linktype=\"self-bookmark\">IsUserContext</a></div>\r\n          </td>\r\n            <td>\r\n            <p>This property is intended for system use and should not be called by users.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_OutgoingMessageHeaders\" data-linktype=\"self-bookmark\">OutgoingMessageHeaders</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the outgoing message headers for the active <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_OutgoingMessageProperties\" data-linktype=\"self-bookmark\">OutgoingMessageProperties</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the message properties for the outbound message in the active <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_RequestContext\" data-linktype=\"self-bookmark\">RequestContext</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets the <a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a> implementation for this method.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_ServiceSecurityContext\" data-linktype=\"self-bookmark\">ServiceSecurityContext</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets the <a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a> within which this method executes.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_SessionId\" data-linktype=\"self-bookmark\">SessionId</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the <a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a> used to identify the current session.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_SupportingTokens\" data-linktype=\"self-bookmark\">SupportingTokens</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a <span class=\"xref\">stem.Collections.Generic.ICollection`1</span> of type <a class=\"xref\" href=\"system.identitymodel.tokens.securitytoken\" data-linktype=\"relative-path\">SecurityToken</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_GetCallbackChannel__1\" data-linktype=\"self-bookmark\">GetCallbackChannel&lt;T&gt;()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a channel to the client instance that called the current operation.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_SetTransactionComplete\" data-linktype=\"self-bookmark\">SetTransactionComplete()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Commits the currently executing transaction.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Events\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_ServiceModel_OperationContext_OperationCompleted\" data-linktype=\"self-bookmark\">OperationCompleted</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Occurs when the operation has completed.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext__ctor_System_ServiceModel_IContextChannel_\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OperationContext(IContextChannel)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> class that uses the specified <a class=\"xref\" href=\"system.servicemodel.icontextchannel\" data-linktype=\"relative-path\">IContextChannel</a> in a client application.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public OperationContext (System.ServiceModel.IContextChannel channel);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>channel</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.icontextchannel\" data-linktype=\"relative-path\">IContextChannel</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.icontextchannel\" data-linktype=\"relative-path\">IContextChannel</a> used to create a new client <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The channel is null.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use the OperationContext constructor to create a new operation context within the scope of which the proxy is associated in order to modify outbound items such as headers.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to use the <a class=\"xref\" href=\"system.servicemodel.operationcontextscope\" data-linktype=\"relative-path\">OperationContextScope</a> to create a new context in a client application in order to add a custom header to the outgoing message.  </p>\n<pre><code class=\"lang-cs\" name=\"OperationContextScope#4\">SampleServiceClient wcfClient = new SampleServiceClient(new InstanceContext(this));\ntry\n{\n  using (OperationContextScope scope = new OperationContextScope(wcfClient.InnerChannel))\n  {\n    MessageHeader header\n      = MessageHeader.CreateHeader(\n      &quot;Service-Bound-CustomHeader&quot;,\n      &quot;http://Microsoft.WCF.Documentation&quot;,\n      &quot;Custom Happy Value.&quot;\n      );\n    OperationContext.Current.OutgoingMessageHeaders.Add(header);\n\n    // Making calls.\n    Console.WriteLine(&quot;Enter the greeting to send: &quot;);\n    string greeting = Console.ReadLine();\n\n    //Console.ReadLine();\n    header = MessageHeader.CreateHeader(\n        &quot;Service-Bound-OneWayHeader&quot;,\n        &quot;http://Microsoft.WCF.Documentation&quot;,\n        &quot;Different Happy Value.&quot;\n      );\n    OperationContext.Current.OutgoingMessageHeaders.Add(header);\n\n    // One-way\n    wcfClient.Push(greeting);\n    this.wait.WaitOne();\n\n    // Done with service. \n    wcfClient.Close();\n    Console.WriteLine(&quot;Done!&quot;);\n    Console.ReadLine();\n  }\n}\ncatch (TimeoutException timeProblem)\n{\n  Console.WriteLine(&quot;The service operation timed out. &quot; + timeProblem.Message);\n  Console.ReadLine();\n  wcfClient.Abort();\n}\ncatch (CommunicationException commProblem)\n{\n  Console.WriteLine(&quot;There was a communication problem. &quot; + commProblem.Message);\n  Console.ReadLine();\n  wcfClient.Abort();\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"OperationContextScope#4\">Dim wcfClient As New SampleServiceClient(New InstanceContext(Me))\nTry\n  Using scope As New OperationContextScope(wcfClient.InnerChannel)\n               Dim header As MessageHeader = MessageHeader.CreateHeader(&quot;Service-Bound-CustomHeader&quot;, _\n                                   &quot;http://Microsoft.WCF.Documentation&quot;, &quot;Custom Happy Value.&quot;)\n\tOperationContext.Current.OutgoingMessageHeaders.Add(header)\n\n\t&#39; Making calls.\n\tConsole.WriteLine(&quot;Enter the greeting to send: &quot;)\n\tDim greeting As String = Console.ReadLine()\n\n\t&#39;Console.ReadLine();\n               header = MessageHeader.CreateHeader(&quot;Service-Bound-OneWayHeader&quot;, _\n                                                   &quot;http://Microsoft.WCF.Documentation&quot;, &quot;Different Happy Value.&quot;)\n\tOperationContext.Current.OutgoingMessageHeaders.Add(header)\n\n\t&#39; One-way\n\twcfClient.Push(greeting)\n\tMe.wait.WaitOne()\n\n\t&#39; Done with service. \n\twcfClient.Close()\n\tConsole.WriteLine(&quot;Done!&quot;)\n\tConsole.ReadLine()\n  End Using\nCatch timeProblem As TimeoutException\n  Console.WriteLine(&quot;The service operation timed out. &quot; &amp; timeProblem.Message)\n  Console.ReadLine()\n  wcfClient.Abort()\nCatch commProblem As CommunicationException\n  Console.WriteLine(&quot;There was a communication problem. &quot; &amp; commProblem.Message)\n  Console.ReadLine()\n  wcfClient.Abort()\nEnd Try\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_Channel\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_Channel_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Channel</div>        \r\n          </div>\r\n    \r\n            <p>Gets the channel associated with the current <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> object.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.IContextChannel Channel { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.icontextchannel\" data-linktype=\"relative-path\">IContextChannel</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.servicemodel.icontextchannel\" data-linktype=\"relative-path\">IContextChannel</a> associated with the current <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_ClaimsPrincipal\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_ClaimsPrincipal_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ClaimsPrincipal</div>        \r\n          </div>\r\n    \r\n            <p>Gets the claims-based principal associated with the operation.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Security.Claims.ClaimsPrincipal ClaimsPrincipal { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.claims.claimsprincipal\" data-linktype=\"relative-path\">ClaimsPrincipal</a></div>\r\n                  </div>\r\n                  <p>The claims principal.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_Current\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_Current_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Current</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets the execution context for the current thread.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.ServiceModel.OperationContext Current { get; set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> that represents the messaging and execution context of the current method.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use the Current property to obtain the execution and message context for the current method.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the Current property and &lt;xref:System.ServiceModel.OperationContext.GetCallbackChannel%2A&gt; method to create a channel back to the caller from within a method. All methods in this example are one-way methods, enabling the service and the client to communicate in both directions independently. In this case, the example client application expects only one return call before it exits, but another client, for example a Windows Forms client, can receive any number of calls from the service.  </p>\n<pre><code class=\"lang-cs\" name=\"SCA.CallbackContract#1\">using System;\nusing System.Collections.Generic;\nusing System.ServiceModel;\nusing System.Threading;\n\nnamespace Microsoft.WCF.Documentation\n{\n  [ServiceContract(\n    Name = &quot;SampleDuplexHello&quot;,\n    Namespace = &quot;http://microsoft.wcf.documentation&quot;,\n    CallbackContract = typeof(IHelloCallbackContract),\n    SessionMode = SessionMode.Required\n  )]\n  public interface IDuplexHello\n  {\n    [OperationContract(IsOneWay = true)]\n    void Hello(string greeting);\n  }\n\n  public interface IHelloCallbackContract\n  {\n    [OperationContract(IsOneWay = true)]\n    void Reply(string responseToGreeting);\n  }\n\n  public class DuplexHello : IDuplexHello\n  {\n    public DuplexHello()\n    {\n      Console.WriteLine(&quot;Service object created: &quot; + this.GetHashCode().ToString());\n    }\n\n    ~DuplexHello()\n    {\n      Console.WriteLine(&quot;Service object destroyed: &quot; + this.GetHashCode().ToString());\n    }\n\n    public void Hello(string greeting)\n    {\n      Console.WriteLine(&quot;Caller sent: &quot; + greeting);\n      Console.WriteLine(&quot;Session ID: &quot; + OperationContext.Current.SessionId);\n      Console.WriteLine(&quot;Waiting two seconds before returning call.&quot;);\n      // Put a slight delay to demonstrate asynchronous behavior on client.\n      Thread.Sleep(2000);\n      IHelloCallbackContract callerProxy\n        = OperationContext.Current.GetCallbackChannel&lt;IHelloCallbackContract&gt;();\n      string response = &quot;Service object &quot; + this.GetHashCode().ToString() + &quot; received: &quot; + greeting;\n      Console.WriteLine(&quot;Sending back: &quot; + response);\n      callerProxy.Reply(response);\n    }\n  }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"SCA.CallbackContract#1\">\n\nImports System\nImports System.Collections.Generic\nImports System.ServiceModel\nImports System.Threading\n\nNamespace Microsoft.WCF.Documentation\n    &lt;ServiceContract(Name:=&quot;SampleDuplexHello&quot;, Namespace:=&quot;http://microsoft.wcf.documentation&quot;, _\n                     CallbackContract:=GetType(IHelloCallbackContract), SessionMode:=SessionMode.Required)&gt; _\n  Public Interface IDuplexHello\n        &lt;OperationContract(IsOneWay:=True)&gt; _\n        Sub Hello(ByVal greeting As String)\n    End Interface\n\n  Public Interface IHelloCallbackContract\n\t&lt;OperationContract(IsOneWay := True)&gt; _\n\tSub Reply(ByVal responseToGreeting As String)\n  End Interface\n\n  Public Class DuplexHello\n\t  Implements IDuplexHello\n\tPublic Sub New()\n\t  Console.WriteLine(&quot;Service object created: &quot; &amp; Me.GetHashCode().ToString())\n\tEnd Sub\n\n\tProtected Overrides Sub Finalize()\n\t  Console.WriteLine(&quot;Service object destroyed: &quot; &amp; Me.GetHashCode().ToString())\n\tEnd Sub\n\n\tPublic Sub Hello(ByVal greeting As String) Implements IDuplexHello.Hello\n\t  Console.WriteLine(&quot;Caller sent: &quot; &amp; greeting)\n\t  Console.WriteLine(&quot;Session ID: &quot; &amp; OperationContext.Current.SessionId)\n\t  Console.WriteLine(&quot;Waiting two seconds before returning call.&quot;)\n\t  &#39; Put a slight delay to demonstrate asynchronous behavior on client.\n\t  Thread.Sleep(2000)\n            Dim callerProxy = OperationContext.Current.GetCallbackChannel(Of IHelloCallbackContract)()\n            Dim response = &quot;Service object &quot; &amp; Me.GetHashCode().ToString() &amp; &quot; received: &quot; &amp; greeting\n\t  Console.WriteLine(&quot;Sending back: &quot; &amp; response)\n\t  callerProxy.Reply(response)\n\tEnd Sub\n  End Class\nEnd Namespace\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_EndpointDispatcher\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_EndpointDispatcher_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">EndpointDispatcher</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets the endpoint dispatcher for the endpoint to inspect or modify.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Dispatcher.EndpointDispatcher EndpointDispatcher { get; set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.dispatcher.endpointdispatcher\" data-linktype=\"relative-path\">EndpointDispatcher</a></div>\r\n                  </div>\r\n                  <p>The endpoint dispatcher for the endpoint to inspect or modify.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_Extensions\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_Extensions_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Extensions</div>        \r\n          </div>\r\n    \r\n            <p>Gets the collection of service extensions from the current message context.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.IExtensionCollection&lt;System.ServiceModel.OperationContext&gt; Extensions { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.iextensioncollection-1\" data-linktype=\"relative-path\">IExtensionCollection</a>&lt;<a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>&gt;</div>\r\n                  </div>\r\n                  <p>A collection of extensions of <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use the Extensions property to obtain a collection of all extensions of the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> used to modify the context or add custom state. For more information about extensions, see <a href=\"../Topic/Extensible%20Objects.md\" data-linktype=\"relative-path\">Extensible Objects</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_HasSupportingTokens\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_HasSupportingTokens_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">HasSupportingTokens</div>        \r\n          </div>\r\n    \r\n            <p>Gets a value that indicates whether the incoming message has supporting tokens.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public bool HasSupportingTokens { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the incoming message has supporting tokens; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_Host\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_Host_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Host</div>        \r\n          </div>\r\n    \r\n            <p>Gets the <a class=\"xref\" href=\"system.servicemodel.servicehost\" data-linktype=\"relative-path\">ServiceHost</a> for the current service object.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.ServiceHostBase Host { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.servicehostbase\" data-linktype=\"relative-path\">ServiceHostBase</a></div>\r\n                  </div>\r\n                  <p>A <a class=\"xref\" href=\"system.servicemodel.servicehost\" data-linktype=\"relative-path\">ServiceHost</a> object.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_IncomingMessageHeaders\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_IncomingMessageHeaders_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IncomingMessageHeaders</div>        \r\n          </div>\r\n    \r\n            <p>Gets the incoming message headers for the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Channels.MessageHeaders IncomingMessageHeaders { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.messageheaders\" data-linktype=\"relative-path\">MessageHeaders</a></div>\r\n                  </div>\r\n                  <p>A <a class=\"xref\" href=\"system.servicemodel.channels.messageheaders\" data-linktype=\"relative-path\">MessageHeaders</a> object that contains the incoming message headers.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this property to inspect or modify the request headers that arrive at a service operation or reply headers that arrive at a client proxy.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example shows how to read the incoming message headers in a service operation.  </p>\n<pre><code class=\"lang-cs\" name=\"OperationContextScope#2\">class SampleService : ISampleService\n{\n#region ISampleService Members\n\n  public void Push(string msg)\n  {\n    Console.WriteLine(&quot;Proxy: &quot; + msg);\n    this.WriteHeaders(OperationContext.Current.IncomingMessageHeaders);\n    MessageHeader outBoundHeader\n      = MessageHeader.CreateHeader(\n        &quot;Client-Bound-One-Way-Header&quot;, \n        &quot;http://Microsoft.WCF.Documentation&quot;, \n        &quot;Custom Outbound Header&quot;\n      );\n    OperationContext.Current.OutgoingMessageHeaders.Add(outBoundHeader);\n    Console.ForegroundColor = ConsoleColor.Red;\n    Console.WriteLine(&quot;OutgoingHeader:&quot;);\n    Console.Write(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot;);\n    Console.ForegroundColor = ConsoleColor.Blue;\n    Console.WriteLine(outBoundHeader.ToString());\n    Console.ResetColor();\n    OperationContext.Current.GetCallbackChannel&lt;IClientCallbackContract&gt;().PushBack(&quot;Here&#39;s something to examine in response.&quot;);\n  }\n\n  void WriteHeaders(MessageHeaders headers)\n  {\n    Console.ForegroundColor = ConsoleColor.Red;\n    Console.WriteLine(&quot;IncomingHeader:&quot;);\n    Console.ForegroundColor = ConsoleColor.Blue;\n    foreach (MessageHeaderInfo h in headers)\n    {\n      if (!h.Actor.Equals(String.Empty))\n        Console.WriteLine(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot; + h.Actor);\n      Console.ForegroundColor = ConsoleColor.White;\n      Console.WriteLine(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot; + h.Name);\n      Console.ForegroundColor = ConsoleColor.Blue;\n      Console.WriteLine(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot; + h.Namespace);\n      Console.WriteLine(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot; + h.Relay);\n      if (h.IsReferenceParameter == true)\n      {\n          Console.WriteLine(&quot;IsReferenceParameter header detected: &quot; + h.ToString());\n      }\n    }\n    Console.ResetColor();\n  }\n</code></pre><pre><code class=\"lang-vb\" name=\"OperationContextScope#2\"> Friend Class SampleService\n  Implements ISampleService\n #Region &quot;ISampleService Members&quot;\n\nPublic Sub Push(ByVal msg As String) Implements ISampleService.Push\n\t Console.WriteLine(&quot;Proxy: &quot; &amp; msg)\n  Me.WriteHeaders(OperationContext.Current.IncomingMessageHeaders)\n  Dim outBoundHeader As MessageHeader = MessageHeader.CreateHeader(&quot;Client-Bound-One-Way-Header&quot;, &quot;http://Microsoft.WCF.Documentation&quot;, &quot;Custom Outbound Header&quot;)\n  OperationContext.Current.OutgoingMessageHeaders.Add(outBoundHeader)\n  Console.ForegroundColor = ConsoleColor.Red\n  Console.WriteLine(&quot;OutgoingHeader:&quot;)\n  Console.Write(vbTab)\n  Console.ForegroundColor = ConsoleColor.Blue\n  Console.WriteLine(outBoundHeader.ToString())\n  Console.ResetColor()\n  OperationContext.Current.GetCallbackChannel(Of IClientCallbackContract)().PushBack(&quot;Here&#39;s something to examine in response.&quot;)\nEnd Sub\n\nPrivate Sub WriteHeaders(ByVal headers As MessageHeaders)\n  Console.ForegroundColor = ConsoleColor.Red\n  Console.WriteLine(&quot;IncomingHeader:&quot;)\n  Console.ForegroundColor = ConsoleColor.Blue\n           For Each h In headers\n               If Not h.Actor.Equals(String.Empty) Then\n                   Console.WriteLine(vbTab &amp; h.Actor)\n               End If\n               Console.ForegroundColor = ConsoleColor.White\n               Console.WriteLine(vbTab &amp; h.Name)\n               Console.ForegroundColor = ConsoleColor.Blue\n               Console.WriteLine(vbTab &amp; h.Namespace)\n               Console.WriteLine(vbTab &amp; h.Relay)\n               If h.IsReferenceParameter = True Then\n                   Console.WriteLine(&quot;IsReferenceParameter header detected: &quot; &amp; h.ToString())\n               End If\n           Next h\n  Console.ResetColor()\nEnd Sub\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_IncomingMessageProperties\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_IncomingMessageProperties_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IncomingMessageProperties</div>        \r\n          </div>\r\n    \r\n            <p>Gets the message properties for the incoming message in the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Channels.MessageProperties IncomingMessageProperties { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.messageproperties\" data-linktype=\"relative-path\">MessageProperties</a></div>\r\n                  </div>\r\n                  <p>A <a class=\"xref\" href=\"system.servicemodel.channels.messageproperties\" data-linktype=\"relative-path\">MessageProperties</a> object that contains the message properties on the incoming message.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this property to inspect or modify the message properties for a request message in a service operation or a reply message in a client proxy.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_IncomingMessageVersion\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_IncomingMessageVersion_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IncomingMessageVersion</div>        \r\n          </div>\r\n    \r\n            <p>Gets the incoming SOAP message version for the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Channels.MessageVersion IncomingMessageVersion { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.messageversion\" data-linktype=\"relative-path\">MessageVersion</a></div>\r\n                  </div>\r\n                  <p>The SOAP version of the incoming message.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this property to inspect the SOAP version of the request message that arrives at a service operation or the SOAP version of the reply message that arrives at a client proxy.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_InstanceContext\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_InstanceContext_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">InstanceContext</div>        \r\n          </div>\r\n    \r\n            <p>Gets the <a class=\"xref\" href=\"system.servicemodel.instancecontext\" data-linktype=\"relative-path\">InstanceContext</a> object that manages the current service instance.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.InstanceContext InstanceContext { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.instancecontext\" data-linktype=\"relative-path\">InstanceContext</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.servicemodel.instancecontext\" data-linktype=\"relative-path\">InstanceContext</a> object for the current service.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use the InstanceContext property to access the run-time object that manages the current service object.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_IsUserContext\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_IsUserContext_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IsUserContext</div>        \r\n          </div>\r\n    \r\n            <p>This property is intended for system use and should not be called by users.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public bool IsUserContext { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_OutgoingMessageHeaders\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_OutgoingMessageHeaders_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OutgoingMessageHeaders</div>        \r\n          </div>\r\n    \r\n            <p>Gets the outgoing message headers for the active <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Channels.MessageHeaders OutgoingMessageHeaders { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.messageheaders\" data-linktype=\"relative-path\">MessageHeaders</a></div>\r\n                  </div>\r\n                  <p>A <a class=\"xref\" href=\"system.servicemodel.channels.messageheaders\" data-linktype=\"relative-path\">MessageHeaders</a> object that contains outbound message headers for the active <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this property to add reply headers that are sent by a service operation or request headers that are sent by a WCF client object.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to use the <a class=\"xref\" href=\"system.servicemodel.operationcontextscope\" data-linktype=\"relative-path\">OperationContextScope</a> to create a new context in a client application in order to add a custom header to the outgoing message.  </p>\n<pre><code class=\"lang-cs\" name=\"OperationContextScope#4\">SampleServiceClient wcfClient = new SampleServiceClient(new InstanceContext(this));\ntry\n{\n  using (OperationContextScope scope = new OperationContextScope(wcfClient.InnerChannel))\n  {\n    MessageHeader header\n      = MessageHeader.CreateHeader(\n      &quot;Service-Bound-CustomHeader&quot;,\n      &quot;http://Microsoft.WCF.Documentation&quot;,\n      &quot;Custom Happy Value.&quot;\n      );\n    OperationContext.Current.OutgoingMessageHeaders.Add(header);\n\n    // Making calls.\n    Console.WriteLine(&quot;Enter the greeting to send: &quot;);\n    string greeting = Console.ReadLine();\n\n    //Console.ReadLine();\n    header = MessageHeader.CreateHeader(\n        &quot;Service-Bound-OneWayHeader&quot;,\n        &quot;http://Microsoft.WCF.Documentation&quot;,\n        &quot;Different Happy Value.&quot;\n      );\n    OperationContext.Current.OutgoingMessageHeaders.Add(header);\n\n    // One-way\n    wcfClient.Push(greeting);\n    this.wait.WaitOne();\n\n    // Done with service. \n    wcfClient.Close();\n    Console.WriteLine(&quot;Done!&quot;);\n    Console.ReadLine();\n  }\n}\ncatch (TimeoutException timeProblem)\n{\n  Console.WriteLine(&quot;The service operation timed out. &quot; + timeProblem.Message);\n  Console.ReadLine();\n  wcfClient.Abort();\n}\ncatch (CommunicationException commProblem)\n{\n  Console.WriteLine(&quot;There was a communication problem. &quot; + commProblem.Message);\n  Console.ReadLine();\n  wcfClient.Abort();\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"OperationContextScope#4\">Dim wcfClient As New SampleServiceClient(New InstanceContext(Me))\nTry\n  Using scope As New OperationContextScope(wcfClient.InnerChannel)\n               Dim header As MessageHeader = MessageHeader.CreateHeader(&quot;Service-Bound-CustomHeader&quot;, _\n                                   &quot;http://Microsoft.WCF.Documentation&quot;, &quot;Custom Happy Value.&quot;)\n\tOperationContext.Current.OutgoingMessageHeaders.Add(header)\n\n\t&#39; Making calls.\n\tConsole.WriteLine(&quot;Enter the greeting to send: &quot;)\n\tDim greeting As String = Console.ReadLine()\n\n\t&#39;Console.ReadLine();\n               header = MessageHeader.CreateHeader(&quot;Service-Bound-OneWayHeader&quot;, _\n                                                   &quot;http://Microsoft.WCF.Documentation&quot;, &quot;Different Happy Value.&quot;)\n\tOperationContext.Current.OutgoingMessageHeaders.Add(header)\n\n\t&#39; One-way\n\twcfClient.Push(greeting)\n\tMe.wait.WaitOne()\n\n\t&#39; Done with service. \n\twcfClient.Close()\n\tConsole.WriteLine(&quot;Done!&quot;)\n\tConsole.ReadLine()\n  End Using\nCatch timeProblem As TimeoutException\n  Console.WriteLine(&quot;The service operation timed out. &quot; &amp; timeProblem.Message)\n  Console.ReadLine()\n  wcfClient.Abort()\nCatch commProblem As CommunicationException\n  Console.WriteLine(&quot;There was a communication problem. &quot; &amp; commProblem.Message)\n  Console.ReadLine()\n  wcfClient.Abort()\nEnd Try\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_OutgoingMessageProperties\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_OutgoingMessageProperties_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OutgoingMessageProperties</div>        \r\n          </div>\r\n    \r\n            <p>Gets the message properties for the outbound message in the active <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Channels.MessageProperties OutgoingMessageProperties { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.messageproperties\" data-linktype=\"relative-path\">MessageProperties</a></div>\r\n                  </div>\r\n                  <p>A <a class=\"xref\" href=\"system.servicemodel.channels.messageproperties\" data-linktype=\"relative-path\">MessageProperties</a> object that contains the message properties on the outbound message.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this property to add message properties for a reply message from a service operation or message properties for a request message from a client proxy.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_RequestContext\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_RequestContext_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">RequestContext</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets the <a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a> implementation for this method.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.Channels.RequestContext RequestContext { get; set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.servicemodel.channels.requestcontext\" data-linktype=\"relative-path\">RequestContext</a> implementation, or null if there is no request context.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>One-way operations are do not have a request context.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_ServiceSecurityContext\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_ServiceSecurityContext_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ServiceSecurityContext</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets the <a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a> within which this method executes.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.ServiceModel.ServiceSecurityContext ServiceSecurityContext { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a></div>\r\n                  </div>\r\n                  <p>A <a class=\"xref\" href=\"system.servicemodel.servicesecuritycontext\" data-linktype=\"relative-path\">ServiceSecurityContext</a> object.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_SessionId\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_SessionId_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SessionId</div>        \r\n          </div>\r\n    \r\n            <p>Gets the <a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a> used to identify the current session.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public string SessionId { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </div>\r\n                  <p>The session identifier.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_SupportingTokens\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_SupportingTokens_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SupportingTokens</div>        \r\n          </div>\r\n    \r\n            <p>Gets a <span class=\"xref\">stem.Collections.Generic.ICollection`1</span> of type <a class=\"xref\" href=\"system.identitymodel.tokens.securitytoken\" data-linktype=\"relative-path\">SecurityToken</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Collections.Generic.ICollection&lt;System.ServiceModel.Security.SupportingTokenSpecification&gt; SupportingTokens { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.generic.icollection-1\" data-linktype=\"relative-path\">ICollection</a>&lt;<a class=\"xref\" href=\"system.servicemodel.security.supportingtokenspecification\" data-linktype=\"relative-path\">SupportingTokenSpecification</a>&gt;</div>\r\n                  </div>\r\n                  <p>A collection of security tokens.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_GetCallbackChannel__1\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_GetCallbackChannel_T__\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetCallbackChannel&lt;T&gt;()</div>        \r\n          </div>\r\n    \r\n            <p>Gets a channel to the client instance that called the current operation.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public T GetCallbackChannel&lt;T&gt; ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><span class=\"xref\">T</span></div>\r\n                  </div>\r\n                  <p>A channel to the client instance that called the operation of the type specified in the <span class=\"xref\">stem.ServiceModel.ServiceContractAttribute.CallbackContract*</span> property.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Call the GetCallbackChannel(T) property to obtain a channel that you can use to call operations on the client instance that called the service.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the <a class=\"xref\" href=\"system.servicemodel.operationcontext#System_ServiceModel_OperationContext_Current_\" data-linktype=\"relative-path\">Current</a> property and GetCallbackChannel(T) method to create a channel back to the caller from within a operation. All operations in this example are one-way operations, enabling the service and the client to communicate in both directions independently. In this case, the example client application expects only one return call before it exits, but another client, for example a Windows Forms client, can receive any number of calls from the service.  </p>\n<pre><code class=\"lang-cs\" name=\"SCA.CallbackContract#1\">using System;\nusing System.Collections.Generic;\nusing System.ServiceModel;\nusing System.Threading;\n\nnamespace Microsoft.WCF.Documentation\n{\n  [ServiceContract(\n    Name = &quot;SampleDuplexHello&quot;,\n    Namespace = &quot;http://microsoft.wcf.documentation&quot;,\n    CallbackContract = typeof(IHelloCallbackContract),\n    SessionMode = SessionMode.Required\n  )]\n  public interface IDuplexHello\n  {\n    [OperationContract(IsOneWay = true)]\n    void Hello(string greeting);\n  }\n\n  public interface IHelloCallbackContract\n  {\n    [OperationContract(IsOneWay = true)]\n    void Reply(string responseToGreeting);\n  }\n\n  public class DuplexHello : IDuplexHello\n  {\n    public DuplexHello()\n    {\n      Console.WriteLine(&quot;Service object created: &quot; + this.GetHashCode().ToString());\n    }\n\n    ~DuplexHello()\n    {\n      Console.WriteLine(&quot;Service object destroyed: &quot; + this.GetHashCode().ToString());\n    }\n\n    public void Hello(string greeting)\n    {\n      Console.WriteLine(&quot;Caller sent: &quot; + greeting);\n      Console.WriteLine(&quot;Session ID: &quot; + OperationContext.Current.SessionId);\n      Console.WriteLine(&quot;Waiting two seconds before returning call.&quot;);\n      // Put a slight delay to demonstrate asynchronous behavior on client.\n      Thread.Sleep(2000);\n      IHelloCallbackContract callerProxy\n        = OperationContext.Current.GetCallbackChannel&lt;IHelloCallbackContract&gt;();\n      string response = &quot;Service object &quot; + this.GetHashCode().ToString() + &quot; received: &quot; + greeting;\n      Console.WriteLine(&quot;Sending back: &quot; + response);\n      callerProxy.Reply(response);\n    }\n  }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"SCA.CallbackContract#1\">\n\nImports System\nImports System.Collections.Generic\nImports System.ServiceModel\nImports System.Threading\n\nNamespace Microsoft.WCF.Documentation\n    &lt;ServiceContract(Name:=&quot;SampleDuplexHello&quot;, Namespace:=&quot;http://microsoft.wcf.documentation&quot;, _\n                     CallbackContract:=GetType(IHelloCallbackContract), SessionMode:=SessionMode.Required)&gt; _\n  Public Interface IDuplexHello\n        &lt;OperationContract(IsOneWay:=True)&gt; _\n        Sub Hello(ByVal greeting As String)\n    End Interface\n\n  Public Interface IHelloCallbackContract\n\t&lt;OperationContract(IsOneWay := True)&gt; _\n\tSub Reply(ByVal responseToGreeting As String)\n  End Interface\n\n  Public Class DuplexHello\n\t  Implements IDuplexHello\n\tPublic Sub New()\n\t  Console.WriteLine(&quot;Service object created: &quot; &amp; Me.GetHashCode().ToString())\n\tEnd Sub\n\n\tProtected Overrides Sub Finalize()\n\t  Console.WriteLine(&quot;Service object destroyed: &quot; &amp; Me.GetHashCode().ToString())\n\tEnd Sub\n\n\tPublic Sub Hello(ByVal greeting As String) Implements IDuplexHello.Hello\n\t  Console.WriteLine(&quot;Caller sent: &quot; &amp; greeting)\n\t  Console.WriteLine(&quot;Session ID: &quot; &amp; OperationContext.Current.SessionId)\n\t  Console.WriteLine(&quot;Waiting two seconds before returning call.&quot;)\n\t  &#39; Put a slight delay to demonstrate asynchronous behavior on client.\n\t  Thread.Sleep(2000)\n            Dim callerProxy = OperationContext.Current.GetCallbackChannel(Of IHelloCallbackContract)()\n            Dim response = &quot;Service object &quot; &amp; Me.GetHashCode().ToString() &amp; &quot; received: &quot; &amp; greeting\n\t  Console.WriteLine(&quot;Sending back: &quot; &amp; response)\n\t  callerProxy.Reply(response)\n\tEnd Sub\n  End Class\nEnd Namespace\n</code></pre><p> The following client implements the <code>SampleDuplexHelloCallback</code> to receive the callback message. The imported callback contract is not the same name as the one in the service, due to the use of the <a class=\"xref\" href=\"system.servicemodel.servicecontractattribute#System_ServiceModel_ServiceContractAttribute_Name_\" data-linktype=\"relative-path\">Name</a> property in the preceding example. Note that the client makes no assumptions about whether or when it might receive a callback; the server callback is entirely independent of the client&#39;s outbound call.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> For an example that uses the <a class=\"xref\" href=\"system.servicemodel.operationcontext\" data-linktype=\"relative-path\">OperationContext</a> class in a client scenario, see <a class=\"xref\" href=\"system.servicemodel.operationcontextscope\" data-linktype=\"relative-path\">OperationContextScope</a>.  </p>\n</div>\n<pre><code class=\"lang-cs\" name=\"SCA.CallbackContract#3\">using System;\nusing System.ServiceModel;\nusing System.ServiceModel.Channels;\nusing System.Threading;\n\nnamespace Microsoft.WCF.Documentation\n{\n  public class Client : SampleDuplexHelloCallback\n  {\n    AutoResetEvent waitHandle;\n\n    public Client()\n    {\n      waitHandle = new AutoResetEvent(false);\n    }\n\n    public void Run()\n    {\n      // Picks up configuration from the config file.\n      SampleDuplexHelloClient wcfClient \n        = new SampleDuplexHelloClient(new InstanceContext(this));\n      try\n      {\n        Console.ForegroundColor = ConsoleColor.White;\n        Console.WriteLine(&quot;Enter a greeting to send and press ENTER: &quot;);\n        Console.Write(&quot;&gt;&gt;&gt; &quot;);\n        Console.ForegroundColor = ConsoleColor.Green;\n        string greeting = Console.ReadLine();\n        Console.ForegroundColor = ConsoleColor.White;\n        Console.WriteLine(&quot;Called service with: \\r<br>&nbsp;&nbsp;&nbsp;&nbsp;&quot; + greeting);\n        wcfClient.Hello(greeting);\n        Console.WriteLine(&quot;Execution passes service call and moves to the WaitHandle.&quot;);\n        this.waitHandle.WaitOne();\n        Console.ForegroundColor = ConsoleColor.Blue;\n        Console.WriteLine(&quot;Set was called.&quot;);\n        Console.Write(&quot;Press &quot;);\n        Console.ForegroundColor = ConsoleColor.Red;\n        Console.Write(&quot;ENTER&quot;);\n        Console.ForegroundColor = ConsoleColor.Blue;\n        Console.Write(&quot; to exit...&quot;);\n        Console.ReadLine();\n        wcfClient.Close();\n      }\n      catch (TimeoutException timeProblem)\n      {\n        Console.WriteLine(&quot;The service operation timed out. &quot; + timeProblem.Message);\n        Console.ReadLine();\n        wcfClient.Abort();\n      }\n      catch (CommunicationException commProblem)\n      {\n        Console.WriteLine(&quot;There was a communication problem. &quot; + commProblem.Message);\n        Console.ReadLine();\n        wcfClient.Abort();\n      }\n    }\n\n    public static void Main()\n    {\n      Client client = new Client();\n      client.Run();\n    }\n\n    public void Reply(string response)\n    {\n      Console.WriteLine(&quot;Received output.&quot;);\n      Console.WriteLine(&quot;\\r<br>&nbsp;&nbsp;&nbsp;&nbsp;&quot; + response);\n      this.waitHandle.Set();\n    }\n  }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"SCA.CallbackContract#3\">\nImports Microsoft.VisualBasic\nImports System\nImports System.ServiceModel\nImports System.ServiceModel.Channels\nImports System.Threading\n\nNamespace Microsoft.WCF.Documentation\n  Public Class Client\n\t  Implements SampleDuplexHelloCallback\n\tPrivate waitHandle As AutoResetEvent\n\n\tPublic Sub New()\n\t  waitHandle = New AutoResetEvent(False)\n\tEnd Sub\n\n\tPublic Sub Run()\n\t  &#39; Picks up configuration from the config file.\n\t  Dim wcfClient As New SampleDuplexHelloClient(New InstanceContext(Me))\n\t  Try\n\t\tConsole.ForegroundColor = ConsoleColor.White\n\t\tConsole.WriteLine(&quot;Enter a greeting to send and press ENTER: &quot;)\n\t\tConsole.Write(&quot;&gt;&gt;&gt; &quot;)\n\t\tConsole.ForegroundColor = ConsoleColor.Green\n                Dim greeting = Console.ReadLine()\n\t\tConsole.ForegroundColor = ConsoleColor.White\n\t\tConsole.WriteLine(&quot;Called service with: &quot; &amp; Constants.vbCrLf &amp; Constants.vbTab &amp; greeting)\n\t\twcfClient.Hello(greeting)\n\t\tConsole.WriteLine(&quot;Execution passes service call and moves to the WaitHandle.&quot;)\n\t\tMe.waitHandle.WaitOne()\n\t\tConsole.ForegroundColor = ConsoleColor.Blue\n\t\tConsole.WriteLine(&quot;Set was called.&quot;)\n\t\tConsole.Write(&quot;Press &quot;)\n\t\tConsole.ForegroundColor = ConsoleColor.Red\n\t\tConsole.Write(&quot;ENTER&quot;)\n\t\tConsole.ForegroundColor = ConsoleColor.Blue\n\t\tConsole.Write(&quot; to exit...&quot;)\n\t\tConsole.ReadLine()\n\t\twcfClient.Close()\n\t  Catch timeProblem As TimeoutException\n\t\tConsole.WriteLine(&quot;The service operation timed out. &quot; &amp; timeProblem.Message)\n\t\tConsole.ReadLine()\n\t\twcfClient.Abort()\n\t  Catch commProblem As CommunicationException\n\t\tConsole.WriteLine(&quot;There was a communication problem. &quot; &amp; commProblem.Message)\n\t\tConsole.ReadLine()\n\t\twcfClient.Abort()\n\t  End Try\n\tEnd Sub\n\n\tPublic Shared Sub Main()\n\t  Dim client As New Client()\n\t  client.Run()\n\tEnd Sub\n\n\tPublic Sub Reply(ByVal response As String) Implements SampleDuplexHelloCallback.Reply\n\t  Console.WriteLine(&quot;Received output.&quot;)\n\t  Console.WriteLine(Constants.vbCrLf &amp; Constants.vbTab &amp; response)\n\t  Me.waitHandle.Set()\n\tEnd Sub\n  End Class\nEnd Namespace\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_SetTransactionComplete\">\r\n    \r\n            <a id=\"System_ServiceModel_OperationContext_SetTransactionComplete_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SetTransactionComplete()</div>        \r\n          </div>\r\n    \r\n            <p>Commits the currently executing transaction.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void SetTransactionComplete ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>There is no transaction in the context.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This is only useful in operations that set <a class=\"xref\" href=\"system.servicemodel.operationbehaviorattribute#System_ServiceModel_OperationBehaviorAttribute_TransactionAutoComplete_\" data-linktype=\"relative-path\">TransactionAutoComplete</a> to <code>false</code>. Typically, services do this on some but not all operations. When <a class=\"xref\" href=\"system.servicemodel.operationbehaviorattribute#System_ServiceModel_OperationBehaviorAttribute_TransactionAutoComplete_\" data-linktype=\"relative-path\">TransactionAutoComplete</a> is false the transaction completes automatically. Use SetTransactionComplete in cases where it is not possible to determine at design-time whether an operation needs to complete the transaction.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"events\">\r\n        <h2>Events\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_ServiceModel_OperationContext_OperationCompleted\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OperationCompleted</div>        \r\n          </div>\r\n    \r\n            <p>Occurs when the operation has completed.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public event EventHandler OperationCompleted;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use the OperationCompleted event to dispose parameters or a return value if you set <a class=\"xref\" href=\"system.servicemodel.operationbehaviorattribute#System_ServiceModel_OperationBehaviorAttribute_AutoDisposeParameters_\" data-linktype=\"relative-path\">AutoDisposeParameters</a> to <code>false</code>. Normally you set <a class=\"xref\" href=\"system.servicemodel.operationbehaviorattribute#System_ServiceModel_OperationBehaviorAttribute_AutoDisposeParameters_\" data-linktype=\"relative-path\">AutoDisposeParameters</a> to <code>false</code> to prevent WCF from calling <a class=\"xref\" href=\"system.idisposable#System_IDisposable_Dispose_\" data-linktype=\"relative-path\">Dispose</a> on the parameter and return value objects.  However, if some parameters need to be preserved while others need to be disposed, this event is the best place to dispose those parameters.  </p>\n<p> Also, with duplex bindings, this event can be used to send a request on the callback channel after the reply for the current operation is sent.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> If a caller is listening for the OperationCompleted event for an <a class=\"xref\" href=\"system.servicemodel.operationcontractattribute#System_ServiceModel_OperationContractAttribute_IsTerminating_\" data-linktype=\"relative-path\">IsTerminating</a> operation, it is possible to block when the response is received. The proper way to handle this is to schedule work on another thread when OperationCompleted is raised and then immediately return from that event handler.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.ServiceModel.OperationContext.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.ServiceModel.OperationContext.yml\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext..ctor\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.Channel\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.ClaimsPrincipal\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.Current\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.EndpointDispatcher\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.Extensions\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.GetCallbackChannel&lt;T&gt;\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.HasSupportingTokens\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.Host\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.IncomingMessageHeaders\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.IncomingMessageProperties\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.IncomingMessageVersion\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.InstanceContext\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.IsUserContext\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.OperationCompleted\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.add_OperationCompleted\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.remove_OperationCompleted\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.OutgoingMessageHeaders\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.OutgoingMessageProperties\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.RequestContext\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.ServiceSecurityContext\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.SessionId\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.SetTransactionComplete\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.OperationContext.SupportingTokens\">\r\n<meta name=\"APILocation\" content=\"System.ServiceModel.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"eb253c06-91d0-eccb-77c5-b6818ebc15ca\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides access to the execution context of a service method.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.ServiceModel/toc.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.ServiceModel.OperationContext\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.ServiceModel.OperationContext.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.ServiceModel.OperationContext.yml","open_to_public_contributors":true,"api_name":["System.ServiceModel.OperationContext","System.ServiceModel.OperationContext..ctor","System.ServiceModel.OperationContext.Channel","System.ServiceModel.OperationContext.ClaimsPrincipal","System.ServiceModel.OperationContext.Current","System.ServiceModel.OperationContext.EndpointDispatcher","System.ServiceModel.OperationContext.Extensions","System.ServiceModel.OperationContext.GetCallbackChannel<T>","System.ServiceModel.OperationContext.HasSupportingTokens","System.ServiceModel.OperationContext.Host","System.ServiceModel.OperationContext.IncomingMessageHeaders","System.ServiceModel.OperationContext.IncomingMessageProperties","System.ServiceModel.OperationContext.IncomingMessageVersion","System.ServiceModel.OperationContext.InstanceContext","System.ServiceModel.OperationContext.IsUserContext","System.ServiceModel.OperationContext.OperationCompleted","System.ServiceModel.OperationContext.add_OperationCompleted","System.ServiceModel.OperationContext.remove_OperationCompleted","System.ServiceModel.OperationContext.OutgoingMessageHeaders","System.ServiceModel.OperationContext.OutgoingMessageProperties","System.ServiceModel.OperationContext.RequestContext","System.ServiceModel.OperationContext.ServiceSecurityContext","System.ServiceModel.OperationContext.SessionId","System.ServiceModel.OperationContext.SetTransactionComplete","System.ServiceModel.OperationContext.SupportingTokens"],"api_location":["System.ServiceModel.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.ServiceModel.OperationContext","System::ServiceModel::OperationContext","System.ServiceModel.OperationContext.#ctor","System::ServiceModel::OperationContext::#ctor","System.ServiceModel.OperationContext.Channel","System::ServiceModel::OperationContext::Channel","System.ServiceModel.OperationContext.ClaimsPrincipal","System::ServiceModel::OperationContext::ClaimsPrincipal","System.ServiceModel.OperationContext.Current","System::ServiceModel::OperationContext::Current","System.ServiceModel.OperationContext.EndpointDispatcher","System::ServiceModel::OperationContext::EndpointDispatcher","System.ServiceModel.OperationContext.Extensions","System::ServiceModel::OperationContext::Extensions","System.ServiceModel.OperationContext.GetCallbackChannel``1","System::ServiceModel::OperationContext::GetCallbackChannel``1","System.ServiceModel.OperationContext.HasSupportingTokens","System::ServiceModel::OperationContext::HasSupportingTokens","System.ServiceModel.OperationContext.Host","System::ServiceModel::OperationContext::Host","System.ServiceModel.OperationContext.IncomingMessageHeaders","System::ServiceModel::OperationContext::IncomingMessageHeaders","System.ServiceModel.OperationContext.IncomingMessageProperties","System::ServiceModel::OperationContext::IncomingMessageProperties","System.ServiceModel.OperationContext.IncomingMessageVersion","System::ServiceModel::OperationContext::IncomingMessageVersion","System.ServiceModel.OperationContext.InstanceContext","System::ServiceModel::OperationContext::InstanceContext","System.ServiceModel.OperationContext.IsUserContext","System::ServiceModel::OperationContext::IsUserContext","System.ServiceModel.OperationContext.OperationCompleted","System::ServiceModel::OperationContext::OperationCompleted","System.ServiceModel.OperationContext.OutgoingMessageHeaders","System::ServiceModel::OperationContext::OutgoingMessageHeaders","System.ServiceModel.OperationContext.OutgoingMessageProperties","System::ServiceModel::OperationContext::OutgoingMessageProperties","System.ServiceModel.OperationContext.RequestContext","System::ServiceModel::OperationContext::RequestContext","System.ServiceModel.OperationContext.ServiceSecurityContext","System::ServiceModel::OperationContext::ServiceSecurityContext","System.ServiceModel.OperationContext.SessionId","System::ServiceModel::OperationContext::SessionId","System.ServiceModel.OperationContext.SetTransactionComplete","System::ServiceModel::OperationContext::SetTransactionComplete","System.ServiceModel.OperationContext.SupportingTokens","System::ServiceModel::OperationContext::SupportingTokens"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"eb253c06-91d0-eccb-77c5-b6818ebc15ca","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.ServiceModel/OperationContext.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"OperationContext class | Microsoft Docs","_op_ogTitle":"OperationContext class","description":"Provides access to the execution context of a service method.\n","toc_asset_id":"_splitted/System.ServiceModel/toc.json","toc_rel":"_splitted/System.ServiceModel/toc.json","source_url":"","ms.assetid":"System.ServiceModel.OperationContext","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.servicemodel.operationcontext","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.servicemodel.operationcontext","fileRelativePath":"System.ServiceModel.OperationContext.html"},"themesRelativePathToOutputRoot":"_themes/"}