{"content":"    \r\n    <h1 id=\"System_Security_Claims_ClaimsAuthorizationManager\">\r\n      <span class=\"lang-csharp\">ClaimsAuthorizationManager</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Defines the base implementation for a claims authorization manager.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class ClaimsAuthorizationManager : System.IdentityModel.Configuration.ICustomIdentityConfiguration</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">ClaimsAuthorizationManager</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>The ClaimsAuthorizationManager class provides the base implementation for a claims authorization manager. A claims authorization manager can be used in the following two scenarios:  </p>\n<ul>\n<li><p>In web-based applications and services, a claims authorization manager  can be added to the processing pipeline to provide an extensibility point from which you can authorize access to a resource according to the value of incoming claims before the application code that actually implements the requested resource is called.  </p>\n</li>\n<li><p>When you use the <a class=\"xref\" href=\"system.identitymodel.services.claimsprincipalpermission\" data-linktype=\"relative-path\">ClaimsPrincipalPermission</a> class or the <a class=\"xref\" href=\"system.identitymodel.services.claimsprincipalpermissionattribute\" data-linktype=\"relative-path\">ClaimsPrincipalPermissionAttribute</a> class to perform either imperative or declarative claims-based access checks in your code, the claims authorization manager that is configured for your application is called by the system to perform the check. Claims-based access checks can be performed in both web-based applications and desktop applications.  </p>\n<p>The default implementation provided by the ClaimsAuthorizationManager class authorizes access for each claim presented; however, you can derive from this class and override the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager#System_Security_Claims_ClaimsAuthorizationManager_CheckAccess_\" data-linktype=\"relative-path\">CheckAccess</a> method to provide your own authorization logic.  </p>\n<p>The use of a claims authorization manager is optional. You can configure your application to use a claims authorization manager either programmatically by using the <a class=\"xref\" href=\"system.identitymodel.configuration.identityconfiguration\" data-linktype=\"relative-path\">IdentityConfiguration</a> class or declaratively, by specifying the <a href=\"../Topic/%3CclaimsAuthorizationManager%3E.md\" data-linktype=\"relative-path\">&amp;lt;claimsAuthorizationManager&amp;gt;</a> element, which is a child element of the <a href=\"../Topic/%3CidentityConfiguration%3E.md\" data-linktype=\"relative-path\">&amp;lt;identityConfiguration&amp;gt;</a> element in your application configuration file. If your application is a web site or a web application hosted in Internet Information Services (IIS), you must also add the <a class=\"xref\" href=\"system.identitymodel.services.claimsauthorizationmodule\" data-linktype=\"relative-path\">ClaimsAuthorizationModule</a> in the ASP.NET HTTP Modules collection.  </p>\n</li>\n</ul>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> When you use the <a class=\"xref\" href=\"system.identitymodel.services.claimsprincipalpermission\" data-linktype=\"relative-path\">ClaimsPrincipalPermission</a> class or the <a class=\"xref\" href=\"system.identitymodel.services.claimsprincipalpermissionattribute\" data-linktype=\"relative-path\">ClaimsPrincipalPermissionAttribute</a> class, the claims authorization manager that is used to perform the access check is the one that is specified in the identity configuration under the <a class=\"xref\" href=\"system.identitymodel.services.federatedauthentication#System_IdentityModel_Services_FederatedAuthentication_FederationConfiguration_\" data-linktype=\"relative-path\">FederationConfiguration</a> property. In a configuration file, it is the <code>&lt;identityConfiguration&gt;</code> section that is referenced from the default <code>&lt;federationConfiguration&gt;</code> element. This is true even for Windows Communication Foundation (WCF) services and desktop applications.  </p>\n</div>\n<p> The ClaimsAuthorizationManager base class does not take any additional configuration; however, you can override the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager#System_Security_Claims_ClaimsAuthorizationManager_LoadCustomConfiguration_\" data-linktype=\"relative-path\">LoadCustomConfiguration</a> in derived classes to provide initialization of your claims authorization manager from child elements of the <code>&lt;claimsAuthorizationElement&gt;</code>. The typical scenario is to use these child elements to specify authorization policies which determine which claim types and values are required in order to gain access to which resource. This is not a hard requirement, though you are free to define whatever usage and syntax make sense for your implementation.</p>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_Claims_ClaimsAuthorizationManager__ctor\" data-linktype=\"self-bookmark\">ClaimsAuthorizationManager()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager\" data-linktype=\"relative-path\">ClaimsAuthorizationManager</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_Claims_ClaimsAuthorizationManager_CheckAccess_System_Security_Claims_AuthorizationContext_\" data-linktype=\"self-bookmark\">CheckAccess(AuthorizationContext)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When implemented in a derived class, checks authorization for the subject in the specified context to perform the specified action on the specified resource.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_Claims_ClaimsAuthorizationManager_LoadCustomConfiguration_System_Xml_XmlNodeList_\" data-linktype=\"self-bookmark\">LoadCustomConfiguration(XmlNodeList)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, loads custom configuration from XML.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Security_Claims_ClaimsAuthorizationManager__ctor\">\r\n    \r\n            <a id=\"System_Security_Claims_ClaimsAuthorizationManager__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ClaimsAuthorizationManager()</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager\" data-linktype=\"relative-path\">ClaimsAuthorizationManager</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public ClaimsAuthorizationManager ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Security_Claims_ClaimsAuthorizationManager_CheckAccess_System_Security_Claims_AuthorizationContext_\">\r\n    \r\n            <a id=\"System_Security_Claims_ClaimsAuthorizationManager_CheckAccess_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CheckAccess(AuthorizationContext)</div>        \r\n          </div>\r\n    \r\n            <p>When implemented in a derived class, checks authorization for the subject in the specified context to perform the specified action on the specified resource.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual bool CheckAccess (System.Security.Claims.AuthorizationContext context);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>context</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.claims.authorizationcontext\" data-linktype=\"relative-path\">AuthorizationContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The authorization context that contains the subject, resource, and action for which authorization is to be checked.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the subject is authorized to perform the specified action on the specified resource; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The base implementation always returns <code>true</code>, which authorizes access. You can override this method in a derived class to authorize access based on the requirements of your RP application. If this method returns <code>false</code>, Windows Identity Foundation (WIF) returns an unauthorized error to the caller; otherwise, execution is passed to the RP application.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The code examples that are used in the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager\" data-linktype=\"relative-path\">ClaimsAuthorizationManager</a> topics are taken from the <code>Claims Based Authorization</code> sample. This sample provides a custom claims authorization manager that can authorize subjects based on a policy that is specified in configuration. The custom claims authorization manager consists of three basic components: a class derived from <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager\" data-linktype=\"relative-path\">ClaimsAuthorizationManager</a> that implements the manager, the <code>ResourceAction</code> class that pairs a resource and an action, and a policy reader that reads and compiles policy that is specified in the configuration file. This compiled policy can then be used by the claims authorization manager to evaluate a principal in order to authorize access to resources. Not all elements are shown for the sake of brevity. For information about this sample and other samples available for WIF and about where to download them, see <a href=\"../Topic/WIF%20Code%20Sample%20Index.md\" data-linktype=\"relative-path\">WIF Code Sample Index</a>.  </p>\n<p> The following code shows the override of the CheckAccess method. This method grants or denies access based on a policy read and compiled from the configuration file.  </p>\n<pre><code class=\"lang-cs\" name=\"WifClaimsBasedAuthorization#3\">static Dictionary&lt;ResourceAction, Func&lt;ClaimsPrincipal, bool&gt;&gt; _policies = new Dictionary&lt;ResourceAction, Func&lt;ClaimsPrincipal, bool&gt;&gt;();\nPolicyReader _policyReader = new PolicyReader();\n</code></pre><pre><code class=\"lang-cs\" name=\"WifClaimsBasedAuthorization#5\">    /// &lt;summary&gt;\n    /// Checks if the principal specified in the authorization context is authorized to perform action specified in the authorization context \n    /// on the specified resoure\n    /// &lt;/summary&gt;\n    /// &lt;param name=&quot;pec&quot;&gt;Authorization context&lt;/param&gt;\n    /// &lt;returns&gt;true if authorized, false otherwise&lt;/returns&gt;\n    public override bool CheckAccess(AuthorizationContext pec)\n    {\n        //\n        // Evaluate the policy against the claims of the \n        // principal to determine access\n        //\n        bool access = false;\n        try\n        {\n            ResourceAction ra = new ResourceAction(pec.Resource.First&lt;Claim&gt;().Value, pec.Action.First&lt;Claim&gt;().Value);\n\n            access = _policies[ra](pec.Principal);\n        }\n        catch (Exception)\n        {\n            access = false;\n        }\n\n        return access;\n    }\n}\n</code></pre><p> The following code shows the <code>ResourceAction</code> class used by the custom claims manager.  </p>\n<pre><code class=\"lang-cs\" name=\"WifClaimsBasedAuthorization#1\">\nusing System;\n\nnamespace ClaimsAuthorizationLibrary\n{\n    /// &lt;summary&gt;\n    /// Class to encapsulate resource/action pair\n    /// &lt;/summary&gt;\n    public class ResourceAction\n    {\n        public string Resource;\n        public string Action;\n\n        /// &lt;summary&gt;\n        /// Checks if the current instance is equal to the given object by comparing the resource and action values\n        /// &lt;/summary&gt;\n        /// &lt;param name=&quot;obj&quot;&gt;object to compare to&lt;/param&gt;\n        /// &lt;returns&gt;True if equal, else false.&lt;/returns&gt;\n        public override bool Equals(object obj)\n        {\n            ResourceAction ra = obj as ResourceAction;\n            if (ra != null)\n            {\n                return ((string.Compare(ra.Resource, Resource, true) == 0) &amp;&amp; (string.Compare(ra.Action, Action, true) == 0));\n            }\n\n            return base.Equals(obj);\n        }\n\n        /// &lt;summary&gt;\n        /// Gets the hash code.\n        /// &lt;/summary&gt;\n        /// &lt;returns&gt;The hash code.&lt;/returns&gt;\n        public override int GetHashCode()\n        {\n            return (Resource + Action).ToLower().GetHashCode();\n        }\n\n        /// &lt;summary&gt;\n        /// Creates an instance of ResourceAction class.\n        /// &lt;/summary&gt;\n        /// &lt;param name=&quot;resource&quot;&gt;The resource name.&lt;/param&gt;\n        /// &lt;param name=&quot;action&quot;&gt;The action.&lt;/param&gt;\n        /// &lt;exception cref=&quot;ArgumentNullException&quot;&gt;when &lt;paramref name=&quot;resource&quot;/&gt; is null&lt;/exception&gt;\n        public ResourceAction(string resource, string action)\n        {\n            if (string.IsNullOrEmpty(resource))\n            {\n                throw new ArgumentNullException(&quot;resource&quot;);\n            }\n\n            Resource = resource;\n            Action = action;\n        }\n    }\n}\n</code></pre><p> The policy used by the claims authorization manager is specified by custom <code>&lt;policy&gt;</code> elements under the <a href=\"../Topic/%3CclaimsAuthorizationManager%3E.md\" data-linktype=\"relative-path\">&amp;lt;claimsAuthorizationManager&amp;gt;</a> element. This policy is read and compiled by the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager#System_Security_Claims_ClaimsAuthorizationManager_LoadCustomConfiguration_\" data-linktype=\"relative-path\">LoadCustomConfiguration</a> method. In the first policy, the principal must possess one of the specified claims in order to perform the specified action on the specified resource. In the second policy, the principal must possess both claims to be able to perform the specified action on the specified resource. In all others, the principal is automatically granted access regardless of the claims it possesses.  </p>\n<pre><code>&lt;system.identityModel&gt;  \n  &lt;identityConfiguration&gt;  \n    &lt;claimsAuthorizationManager type=&quot;ClaimsAuthorizationLibrary.MyClaimsAuthorizationManager, ClaimsAuthorizationLibrary&quot;&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Developers.aspx&quot; action=&quot;GET&quot;&gt;  \n        &lt;or&gt;  \n          &lt;claim claimType=&quot;http://schemas.microsoft.com/ws/2008/06/identity/claims/role&quot; claimValue=&quot;developer&quot; /&gt;  \n          &lt;claim claimType=&quot;http://schemas.xmlsoap.org/claims/Group&quot; claimValue=&quot;Administrator&quot; /&gt;  \n        &lt;/or&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Administrators.aspx&quot; action=&quot;GET&quot;&gt;  \n        &lt;and&gt;  \n          &lt;claim claimType=&quot;http://schemas.xmlsoap.org/claims/Group&quot; claimValue=&quot;Administrator&quot; /&gt;  \n          &lt;claim claimType=&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/country&quot; claimValue=&quot;USA&quot; /&gt;  \n        &lt;/and&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Default.aspx&quot; action=&quot;GET&quot;&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/&quot; action=&quot;GET&quot;&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Claims.aspx&quot; action=&quot;GET&quot;&gt;  \n      &lt;/policy&gt;  \n    &lt;/claimsAuthorizationManager&gt;  \n\n    ...  \n\n  &lt;/identityConfiguration&gt;  \n&lt;/system.identityModel&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_Claims_ClaimsAuthorizationManager_LoadCustomConfiguration_System_Xml_XmlNodeList_\">\r\n    \r\n            <a id=\"System_Security_Claims_ClaimsAuthorizationManager_LoadCustomConfiguration_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">LoadCustomConfiguration(XmlNodeList)</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, loads custom configuration from XML.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual void LoadCustomConfiguration (System.Xml.XmlNodeList nodelist);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>nodelist</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xmlnodelist\" data-linktype=\"relative-path\">XmlNodeList</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The custom configuration elements. Each node in the list is of type <a class=\"xref\" href=\"system.xml.xmlelement\" data-linktype=\"relative-path\">XmlElement</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The <a class=\"xref\" href=\"system.security.claims.claimsauthenticationmanager#System_Security_Claims_ClaimsAuthenticationManager_LoadCustomConfiguration_\" data-linktype=\"relative-path\">LoadCustomConfiguration</a> method is called by the configuration infrastructure. When this method is called, the <code>nodelist</code> will contain the top-level child elements of the <a href=\"../Topic/%3CclaimsAuthorizationManager%3E.md\" data-linktype=\"relative-path\">&amp;lt;claimsAuthorizationManager&amp;gt;</a> element from the configuration file. Each of these elements may, in turn, contain attributes or child elements depending on the configuration schema you define for your derived class. If no child elements appear under the <code>&lt;claimsAuthorizationManager&gt;</code> element in the configuration file, this method is not called.  </p>\n<p> The default implementation throws a <a class=\"xref\" href=\"system.notimplementedexception\" data-linktype=\"relative-path\">NotImplementedException</a>. Override this method in your derived class to enable initialization of your claims authorization manager from a configuration file. Typically, the configuration elements are used to express an authorization policy; however, you can define elements and use them in any way that makes sense based on the requirements of your application.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The code examples that are used in the <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager\" data-linktype=\"relative-path\">ClaimsAuthorizationManager</a> topics are taken from the <code>Claims Based Authorization</code> sample. This sample provides a custom claims authorization manager that can authorize subjects based on a policy that is specified in configuration. The custom claims authorization manager consists of three basic components: a class derived from <a class=\"xref\" href=\"system.security.claims.claimsauthorizationmanager\" data-linktype=\"relative-path\">ClaimsAuthorizationManager</a> that implements the manager, the <code>ResourceAction</code> class that pairs a resource and an action, and a policy reader that reads and compiles policy that is specified in the configuration file. This compiled policy can then be used by the claims authorization manager to evaluate a principal in order to authorize access to resources. Not all elements are shown for the sake of brevity. For information about this sample and other samples available for WIF and about where to download them, see <a href=\"../Topic/WIF%20Code%20Sample%20Index.md\" data-linktype=\"relative-path\">WIF Code Sample Index</a>.  </p>\n<p> The following code shows the override of the LoadCustomConfiguration method. This method uses a helper policy reader class (not shown) to read and compile authorization policies specified in the configuration file. Policies are added to a dictionary and are accessed by a <code>ResourceAction</code> key object that is created from the resource and action for which they are intended.  </p>\n<pre><code class=\"lang-cs\" name=\"WifClaimsBasedAuthorization#3\">static Dictionary&lt;ResourceAction, Func&lt;ClaimsPrincipal, bool&gt;&gt; _policies = new Dictionary&lt;ResourceAction, Func&lt;ClaimsPrincipal, bool&gt;&gt;();\nPolicyReader _policyReader = new PolicyReader();\n</code></pre><pre><code class=\"lang-cs\" name=\"WifClaimsBasedAuthorization#4\">/// &lt;summary&gt;\n/// Overloads  the base class method to load the custom policies from the config file\n/// &lt;/summary&gt;\n/// &lt;param name=&quot;nodelist&quot;&gt;XmlNodeList containing the policy information read from the config file&lt;/param&gt;\npublic override void LoadCustomConfiguration(XmlNodeList nodelist)\n{\n    Expression&lt;Func&lt;ClaimsPrincipal, bool&gt;&gt; policyExpression;\n\n    foreach (XmlNode node in nodelist)\n    {\n        //\n        // Initialize the policy cache\n        //\n        XmlDictionaryReader rdr = XmlDictionaryReader.CreateDictionaryReader(new XmlTextReader(new StringReader(node.OuterXml)));\n        rdr.MoveToContent();\n\n        string resource = rdr.GetAttribute(&quot;resource&quot;);\n        string action = rdr.GetAttribute(&quot;action&quot;);\n\n        policyExpression = _policyReader.ReadPolicy(rdr);\n\n        //\n        // Compile the policy expression into a function\n        //\n        Func&lt;ClaimsPrincipal, bool&gt; policy = policyExpression.Compile();\n\n        //\n        // Insert the policy function into the policy cache\n        //\n        _policies[new ResourceAction(resource, action)] = policy;\n    }\n}\n</code></pre><p> The following code shows the <code>ResourceAction</code> class used by the custom claims manager.  </p>\n<pre><code class=\"lang-cs\" name=\"WifClaimsBasedAuthorization#1\">\nusing System;\n\nnamespace ClaimsAuthorizationLibrary\n{\n    /// &lt;summary&gt;\n    /// Class to encapsulate resource/action pair\n    /// &lt;/summary&gt;\n    public class ResourceAction\n    {\n        public string Resource;\n        public string Action;\n\n        /// &lt;summary&gt;\n        /// Checks if the current instance is equal to the given object by comparing the resource and action values\n        /// &lt;/summary&gt;\n        /// &lt;param name=&quot;obj&quot;&gt;object to compare to&lt;/param&gt;\n        /// &lt;returns&gt;True if equal, else false.&lt;/returns&gt;\n        public override bool Equals(object obj)\n        {\n            ResourceAction ra = obj as ResourceAction;\n            if (ra != null)\n            {\n                return ((string.Compare(ra.Resource, Resource, true) == 0) &amp;&amp; (string.Compare(ra.Action, Action, true) == 0));\n            }\n\n            return base.Equals(obj);\n        }\n\n        /// &lt;summary&gt;\n        /// Gets the hash code.\n        /// &lt;/summary&gt;\n        /// &lt;returns&gt;The hash code.&lt;/returns&gt;\n        public override int GetHashCode()\n        {\n            return (Resource + Action).ToLower().GetHashCode();\n        }\n\n        /// &lt;summary&gt;\n        /// Creates an instance of ResourceAction class.\n        /// &lt;/summary&gt;\n        /// &lt;param name=&quot;resource&quot;&gt;The resource name.&lt;/param&gt;\n        /// &lt;param name=&quot;action&quot;&gt;The action.&lt;/param&gt;\n        /// &lt;exception cref=&quot;ArgumentNullException&quot;&gt;when &lt;paramref name=&quot;resource&quot;/&gt; is null&lt;/exception&gt;\n        public ResourceAction(string resource, string action)\n        {\n            if (string.IsNullOrEmpty(resource))\n            {\n                throw new ArgumentNullException(&quot;resource&quot;);\n            }\n\n            Resource = resource;\n            Action = action;\n        }\n    }\n}\n</code></pre><p> The policy used by the claims authorization manager is specified by custom <code>&lt;policy&gt;</code> elements under the <a href=\"../Topic/%3CclaimsAuthorizationManager%3E.md\" data-linktype=\"relative-path\">&amp;lt;claimsAuthorizationManager&amp;gt;</a> element. This policy is read and compiled by the LoadCustomConfiguration method. In the first policy, the principal must possess one of the specified claims in order to perform the specified action on the specified resource. In the second policy, the principal must possess both claims to be able to perform the specified action on the specified resource. In all others, the principal is automatically granted access regardless of the claims it possesses.  </p>\n<pre><code>&lt;system.identityModel&gt;  \n  &lt;identityConfiguration&gt;  \n    &lt;claimsAuthorizationManager type=&quot;ClaimsAuthorizationLibrary.MyClaimsAuthorizationManager, ClaimsAuthorizationLibrary&quot;&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Developers.aspx&quot; action=&quot;GET&quot;&gt;  \n        &lt;or&gt;  \n          &lt;claim claimType=&quot;http://schemas.microsoft.com/ws/2008/06/identity/claims/role&quot; claimValue=&quot;developer&quot; /&gt;  \n          &lt;claim claimType=&quot;http://schemas.xmlsoap.org/claims/Group&quot; claimValue=&quot;Administrator&quot; /&gt;  \n        &lt;/or&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Administrators.aspx&quot; action=&quot;GET&quot;&gt;  \n        &lt;and&gt;  \n          &lt;claim claimType=&quot;http://schemas.xmlsoap.org/claims/Group&quot; claimValue=&quot;Administrator&quot; /&gt;  \n          &lt;claim claimType=&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/country&quot; claimValue=&quot;USA&quot; /&gt;  \n        &lt;/and&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Default.aspx&quot; action=&quot;GET&quot;&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/&quot; action=&quot;GET&quot;&gt;  \n      &lt;/policy&gt;  \n      &lt;policy resource=&quot;http://localhost:28491/Claims.aspx&quot; action=&quot;GET&quot;&gt;  \n      &lt;/policy&gt;  \n    &lt;/claimsAuthorizationManager&gt;  \n\n    ...  \n\n  &lt;/identityConfiguration&gt;  \n&lt;/system.identityModel&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/417c04fd1daf0cb211ec4909020356fc1fe69260/fulldocset/System.Security.Claims.ClaimsAuthorizationManager.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Security.Claims.ClaimsAuthorizationManager.yml\">\r\n<meta name=\"APIName\" content=\"System.Security.Claims.ClaimsAuthorizationManager\">\r\n<meta name=\"APIName\" content=\"System.Security.Claims.ClaimsAuthorizationManager..ctor\">\r\n<meta name=\"APIName\" content=\"System.Security.Claims.ClaimsAuthorizationManager.CheckAccess\">\r\n<meta name=\"APIName\" content=\"System.Security.Claims.ClaimsAuthorizationManager.LoadCustomConfiguration\">\r\n<meta name=\"APILocation\" content=\"System.IdentityModel.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-02-28 06:06 AM\">\r\n<meta name=\"document_id\" content=\"bcc9c2fd-2dd8-a6c8-a4d6-7eb5e6cdea59\">\r\n<meta name=\"original_ecmaxml_local_path\" content=\"W:\\vejk\\s\\fulldocset\\xml\\System.Security.Claims\\ClaimsAuthorizationManager.xml\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Defines the base implementation for a claims authorization manager.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Security.Claims/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Security.Claims.ClaimsAuthorizationManager\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/417c04fd1daf0cb211ec4909020356fc1fe69260/fulldocset/System.Security.Claims.ClaimsAuthorizationManager.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Security.Claims.ClaimsAuthorizationManager.yml","open_to_public_contributors":true,"api_name":["System.Security.Claims.ClaimsAuthorizationManager","System.Security.Claims.ClaimsAuthorizationManager..ctor","System.Security.Claims.ClaimsAuthorizationManager.CheckAccess","System.Security.Claims.ClaimsAuthorizationManager.LoadCustomConfiguration"],"api_location":["System.IdentityModel.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Security.Claims.ClaimsAuthorizationManager","System::Security::Claims::ClaimsAuthorizationManager","System.Security.Claims.ClaimsAuthorizationManager.#ctor","System::Security::Claims::ClaimsAuthorizationManager::#ctor","System.Security.Claims.ClaimsAuthorizationManager.CheckAccess","System::Security::Claims::ClaimsAuthorizationManager::CheckAccess","System.Security.Claims.ClaimsAuthorizationManager.LoadCustomConfiguration","System::Security::Claims::ClaimsAuthorizationManager::LoadCustomConfiguration"],"dev_langs":["csharp"],"updated_at":"2017-02-28 06:06 AM","document_id":"bcc9c2fd-2dd8-a6c8-a4d6-7eb5e6cdea59","original_ecmaxml_local_path":"W:\\vejk\\s\\fulldocset\\xml\\System.Security.Claims\\ClaimsAuthorizationManager.xml","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Security.Claims/ClaimsAuthorizationManager.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ClaimsAuthorizationManager class | Microsoft Docs","_op_ogTitle":"ClaimsAuthorizationManager class","description":"Defines the base implementation for a claims authorization manager.\n","toc_asset_id":"_splitted/System.Security.Claims/toc.json","toc_rel":"_splitted/System.Security.Claims/toc.json","source_url":"","ms.assetid":"System.Security.Claims.ClaimsAuthorizationManager","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.security.claims.claimsauthorizationmanager","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.security.claims.claimsauthorizationmanager","fileRelativePath":"System.Security.Claims.ClaimsAuthorizationManager.html"},"themesRelativePathToOutputRoot":"_themes/"}