{"content":"    \r\n    <h1 id=\"System_Windows_Forms_ApplicationContext\">\r\n      <span class=\"lang-csharp\">ApplicationContext</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Specifies the contextual information about an application thread.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class ApplicationContext : IDisposable</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">ApplicationContext</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>You can use the ApplicationContext class to redefine the circumstances that cause a message loop to exit. By default, the ApplicationContext listens to the <a class=\"xref\" href=\"system.windows.forms.form#System_Windows_Forms_Form_Closed\" data-linktype=\"relative-path\">Closed</a> event on the application&#39;s main <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a>, then exits the thread&#39;s message loop.</p>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext__ctor\" data-linktype=\"self-bookmark\">ApplicationContext()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> class with no context.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext__ctor_System_Windows_Forms_Form_\" data-linktype=\"self-bookmark\">ApplicationContext(Form)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> class with the specified <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_MainForm\" data-linktype=\"self-bookmark\">MainForm</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets the <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a> to use as context.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_Tag\" data-linktype=\"self-bookmark\">Tag</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets an object that contains data about the control.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_Dispose\" data-linktype=\"self-bookmark\">Dispose()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Releases all resources used by the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_Dispose_System_Boolean_\" data-linktype=\"self-bookmark\">Dispose(Boolean)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Releases the unmanaged resources used by the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> and optionally releases the managed resources.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_ExitThread\" data-linktype=\"self-bookmark\">ExitThread()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Terminates the message loop of the thread.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_ExitThreadCore\" data-linktype=\"self-bookmark\">ExitThreadCore()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Terminates the message loop of the thread.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_Finalize\" data-linktype=\"self-bookmark\">Finalize()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Attempts to free resources and perform other cleanup operations before the application context is reclaimed by garbage collection.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_OnMainFormClosed_System_Object_System_EventArgs_\" data-linktype=\"self-bookmark\">OnMainFormClosed(Object,EventArgs)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Calls <span class=\"xref\">stem.Windows.Forms.ApplicationContext.ExitThreadCore*</span>, which raises the <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ThreadExit\" data-linktype=\"relative-path\">ThreadExit</a> event.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Events\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_ApplicationContext_ThreadExit\" data-linktype=\"self-bookmark\">ThreadExit</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Occurs when the message loop of the thread should be terminated, by calling <span class=\"xref\">stem.Windows.Forms.ApplicationContext.ExitThread*</span>.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext__ctor\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ApplicationContext()</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> class with no context.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public ApplicationContext ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext__ctor_System_Windows_Forms_Form_\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ApplicationContext(Form)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> class with the specified <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public ApplicationContext (System.Windows.Forms.Form mainForm);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>mainForm</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The main <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a> of the application to use for context.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>If <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_OnMainFormClosed_\" data-linktype=\"relative-path\">OnMainFormClosed</a> is not overridden, the message loop of the thread terminates when <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_MainForm_\" data-linktype=\"relative-path\">MainForm</a> is closed.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_MainForm\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_MainForm_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">MainForm</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets the <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a> to use as context.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Windows.Forms.Form MainForm { get; set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a> to use as context.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This property determines the main <a class=\"xref\" href=\"system.windows.forms.form\" data-linktype=\"relative-path\">Form</a> for this context. This property can change at any time. If <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_OnMainFormClosed_\" data-linktype=\"relative-path\">OnMainFormClosed</a> is not overridden, the message loop of the thread terminates when the <code>mainForm</code> parameter closes.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_Tag\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_Tag_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Tag</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets an object that contains data about the control.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public object Tag { get; set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a> that contains data about the control. The default is <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Any type derived from the <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a> class can be assigned to this property. If the Tag property is set through the Windows Forms designer, only text can be assigned.  </p>\n<p> A common use for the Tag property is to store data that is closely associated with the control. For example, if you have a control that displays information about a customer, you might store a <a class=\"xref\" href=\"system.data.dataset\" data-linktype=\"relative-path\">DataSet</a> that contains the customer&#39;s order history in that control&#39;s Tag property so the data can be accessed quickly.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_Dispose\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_Dispose_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Dispose()</div>        \r\n          </div>\r\n    \r\n            <p>Releases all resources used by the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void Dispose ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Call Dispose when you are finished using the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a>. The Dispose method leaves the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> in an unusable state. After calling Dispose, you must release all references to the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> so the garbage collector can reclaim the memory that the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> was occupying. For more information, see <a href=\"../Topic/Cleaning%20Up%20Unmanaged%20Resources.md\" data-linktype=\"relative-path\">Cleaning Up Unmanaged Resources</a> and <a href=\"../Topic/Implementing%20a%20Dispose%20Method.md\" data-linktype=\"relative-path\">Implementing a Dispose Method</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Always call Dispose before you release your last reference to the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a>. Otherwise, the resources it is using will not be freed until the garbage collector calls the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> object&#39;s <code>Finalize</code> method.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_Dispose_System_Boolean_\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_Dispose_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Dispose(Boolean)</div>        \r\n          </div>\r\n    \r\n            <p>Releases the unmanaged resources used by the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> and optionally releases the managed resources.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual void Dispose (bool disposing);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>disposing</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p><code>true</code> to release both managed and unmanaged resources; <code>false</code> to release only unmanaged resources.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method is called by the public <code>Dispose()</code> method and the <a class=\"xref\" href=\"system.object#System_Object_Finalize_\" data-linktype=\"relative-path\">Finalize</a> method. <code>Dispose()</code> invokes the protected Dispose method with the <code>disposing</code> parameter set to <code>true</code>. <a class=\"xref\" href=\"system.object#System_Object_Finalize_\" data-linktype=\"relative-path\">Finalize</a> invokes <code>Dispose</code> with <code>disposing</code> set to <code>false</code>.  </p>\n<p> When the <code>disposing</code> parameter is true, this method releases all resources held by any managed objects that this <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> references. This method invokes the <code>Dispose()</code> method of each referenced object.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_ExitThread\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_ExitThread_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ExitThread()</div>        \r\n          </div>\r\n    \r\n            <p>Terminates the message loop of the thread.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void ExitThread ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method calls <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ExitThreadCore_\" data-linktype=\"relative-path\">ExitThreadCore</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> ExitThread and <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ExitThreadCore_\" data-linktype=\"relative-path\">ExitThreadCore</a> do not actually cause the thread to terminate. These methods raise the <a class=\"xref\" href=\"system.windows.forms.application#System_Windows_Forms_Application_ThreadExit\" data-linktype=\"relative-path\">ThreadExit</a> event to which the <a class=\"xref\" href=\"system.windows.forms.application\" data-linktype=\"relative-path\">Application</a> object listens. The <a class=\"xref\" href=\"system.windows.forms.application\" data-linktype=\"relative-path\">Application</a> object then terminates the thread.</p>\n</div>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example is an excerpt from the example in the <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> class overview. This example keeps track of open forms and exits the current thread when all forms are closed. The <code>OnFormClosed</code> method is an event handler for the <a class=\"xref\" href=\"system.windows.forms.form#System_Windows_Forms_Form_Closed\" data-linktype=\"relative-path\">Closed</a> event. When the number of open forms is equal to 0, then current thread is exited by calling the ExitThread method. The number of forms is tracked by incrementing the <code>formCount</code> variable when a form is shown, and decrementing it when a form is closed.  </p>\n<p> Some code is not shown for the purpose of brevity. See <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> for the whole code listing.  </p>\n<pre><code class=\"lang-vb\" name=\"Application#3\">    Private Sub OnFormClosed(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; When a form is closed, decrement the count of open forms.\n\n        &#39; When the count gets to 0, exit the app by calling\n        &#39; ExitThread().\n        formCount = formCount - 1\n        If (formCount = 0) Then\n            ExitThread()\n        End If\n    End Sub\n</code></pre><pre><code class=\"lang-cpp\" name=\"Application#3\">   void OnFormClosed( Object^ /*sender*/, EventArgs^ /*e*/ )\n   {\n      \n      // When a form is closed, decrement the count of open forms.\n      // When the count gets to 0, exit the app by calling\n      // ExitThread().\n      formCount--;\n      if ( formCount == 0 )\n      {\n         ExitThread();\n      }\n   }\n\n</code></pre><pre><code class=\"lang-cs\" name=\"Application#3\">        private void OnFormClosed(object sender, EventArgs e) {\n            // When a form is closed, decrement the count of open forms.\n\n            // When the count gets to 0, exit the app by calling\n            // ExitThread().\n            formCount--;\n            if (formCount == 0) {\n                ExitThread();\n            }\n        }\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_ExitThreadCore\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_ExitThreadCore_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ExitThreadCore()</div>        \r\n          </div>\r\n    \r\n            <p>Terminates the message loop of the thread.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual void ExitThreadCore ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method is called from <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ExitThread_\" data-linktype=\"relative-path\">ExitThread</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ExitThread_\" data-linktype=\"relative-path\">ExitThread</a> and ExitThreadCore do not actually cause the thread to terminate. These methods raise the <a class=\"xref\" href=\"system.windows.forms.application#System_Windows_Forms_Application_ThreadExit\" data-linktype=\"relative-path\">ThreadExit</a> event to which the <a class=\"xref\" href=\"system.windows.forms.application\" data-linktype=\"relative-path\">Application</a> object listens. The <a class=\"xref\" href=\"system.windows.forms.application\" data-linktype=\"relative-path\">Application</a> object then terminates the thread.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_Finalize\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_Finalize_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Finalize()</div>        \r\n          </div>\r\n    \r\n            <p>Attempts to free resources and perform other cleanup operations before the application context is reclaimed by garbage collection.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">~ApplicationContext ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method overrides <a class=\"xref\" href=\"system.object#System_Object_Finalize_\" data-linktype=\"relative-path\">Finalize</a> and cleans up resources by calling <code>Dispose(false)</code>. Override <code>Dispose(Boolean)</code> to customize the cleanup.  </p>\n<p> Application code should not call this method; an object&#39;s <code>Finalize</code> method is automatically invoked during garbage collection, unless finalization by the garbage collector has been disabled by a call to the <a class=\"xref\" href=\"system.gc#System_GC_SuppressFinalize_\" data-linktype=\"relative-path\">SuppressFinalize</a> method.  </p>\n<p> For more information, see <a href=\"http://msdn.microsoft.com/en-us/fd376774-1643-499b-869e-9546a3aeea70\" data-linktype=\"external\">Finalize Methods and Destructors</a>, <a href=\"../Topic/Cleaning%20Up%20Unmanaged%20Resources.md\" data-linktype=\"relative-path\">Cleaning Up Unmanaged Resources</a>, and <a href=\"http://msdn.microsoft.com/en-us/8026cb68-fe93-43fc-96c1-c09ad7d64cd3\" data-linktype=\"external\">Overriding the Finalize Method</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_OnMainFormClosed_System_Object_System_EventArgs_\">\r\n    \r\n            <a id=\"System_Windows_Forms_ApplicationContext_OnMainFormClosed_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OnMainFormClosed(Object,EventArgs)</div>        \r\n          </div>\r\n    \r\n            <p>Calls <span class=\"xref\">stem.Windows.Forms.ApplicationContext.ExitThreadCore*</span>, which raises the <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ThreadExit\" data-linktype=\"relative-path\">ThreadExit</a> event.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual void OnMainFormClosed (object sender, EventArgs e);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>sender</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The object that raised the event.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>e</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.eventargs\" data-linktype=\"relative-path\">EventArgs</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.eventargs\" data-linktype=\"relative-path\">EventArgs</a> that contains the event data.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The default implementation of this method calls <a class=\"xref\" href=\"system.windows.forms.applicationcontext#System_Windows_Forms_ApplicationContext_ExitThreadCore_\" data-linktype=\"relative-path\">ExitThreadCore</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"events\">\r\n        <h2>Events\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_ApplicationContext_ThreadExit\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ThreadExit</div>        \r\n          </div>\r\n    \r\n            <p>Occurs when the message loop of the thread should be terminated, by calling <span class=\"xref\">stem.Windows.Forms.ApplicationContext.ExitThread*</span>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public event EventHandler ThreadExit;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates the use of this member. In the example, an event handler reports on the occurrence of the ThreadExit event. This report helps you to learn when the event occurs and can assist you in debugging. To report on multiple events or on events that occur frequently, consider replacing <a class=\"xref\" href=\"system.windows.forms.messagebox#System_Windows_Forms_MessageBox_Show_\" data-linktype=\"relative-path\">Show</a> with <a class=\"xref\" href=\"system.console#System_Console_WriteLine_\" data-linktype=\"relative-path\">WriteLine</a> or appending the message to a multiline <a class=\"xref\" href=\"system.windows.forms.textbox\" data-linktype=\"relative-path\">TextBox</a>.  </p>\n<p> To run the example code, paste it into a project that contains an instance of type <a class=\"xref\" href=\"system.windows.forms.applicationcontext\" data-linktype=\"relative-path\">ApplicationContext</a> named <code>ApplicationContext1</code>. Then ensure that the event handler is associated with the ThreadExit event.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Windows.Forms.EventExamples#75\">private void ApplicationContext1_ThreadExit(Object sender, EventArgs e) {\n\n   MessageBox.Show(&quot;You are in the ApplicationContext.ThreadExit event.&quot;);\n\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Windows.Forms.EventExamples#75\">Private Sub ApplicationContext1_ThreadExit(sender as Object, e as EventArgs) _ \n     Handles ApplicationContext1.ThreadExit\n\n   MessageBox.Show(&quot;You are in the ApplicationContext.ThreadExit event.&quot;)\n\nEnd Sub\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Windows.Forms.ApplicationContext.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Windows.Forms.ApplicationContext.yml\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext..ctor\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.Dispose\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.ExitThread\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.ExitThreadCore\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.Finalize\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.MainForm\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.OnMainFormClosed\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.Tag\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.ThreadExit\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.add_ThreadExit\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.ApplicationContext.remove_ThreadExit\">\r\n<meta name=\"APILocation\" content=\"System.Windows.Forms.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"9872a4fd-9e86-88b0-b7a0-5678a3ee2f47\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Specifies the contextual information about an application thread.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Windows.Forms/toc.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Windows.Forms.ApplicationContext\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Windows.Forms.ApplicationContext.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Windows.Forms.ApplicationContext.yml","open_to_public_contributors":true,"api_name":["System.Windows.Forms.ApplicationContext","System.Windows.Forms.ApplicationContext..ctor","System.Windows.Forms.ApplicationContext.Dispose","System.Windows.Forms.ApplicationContext.ExitThread","System.Windows.Forms.ApplicationContext.ExitThreadCore","System.Windows.Forms.ApplicationContext.Finalize","System.Windows.Forms.ApplicationContext.MainForm","System.Windows.Forms.ApplicationContext.OnMainFormClosed","System.Windows.Forms.ApplicationContext.Tag","System.Windows.Forms.ApplicationContext.ThreadExit","System.Windows.Forms.ApplicationContext.add_ThreadExit","System.Windows.Forms.ApplicationContext.remove_ThreadExit"],"api_location":["System.Windows.Forms.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Windows.Forms.ApplicationContext","System::Windows::Forms::ApplicationContext","System.Windows.Forms.ApplicationContext.#ctor","System::Windows::Forms::ApplicationContext::#ctor","System.Windows.Forms.ApplicationContext.Dispose","System::Windows::Forms::ApplicationContext::Dispose","System.Windows.Forms.ApplicationContext.ExitThread","System::Windows::Forms::ApplicationContext::ExitThread","System.Windows.Forms.ApplicationContext.ExitThreadCore","System::Windows::Forms::ApplicationContext::ExitThreadCore","System.Windows.Forms.ApplicationContext.Finalize","System::Windows::Forms::ApplicationContext::Finalize","System.Windows.Forms.ApplicationContext.MainForm","System::Windows::Forms::ApplicationContext::MainForm","System.Windows.Forms.ApplicationContext.OnMainFormClosed","System::Windows::Forms::ApplicationContext::OnMainFormClosed","System.Windows.Forms.ApplicationContext.Tag","System::Windows::Forms::ApplicationContext::Tag","System.Windows.Forms.ApplicationContext.ThreadExit","System::Windows::Forms::ApplicationContext::ThreadExit"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"9872a4fd-9e86-88b0-b7a0-5678a3ee2f47","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Windows.Forms/ApplicationContext.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ApplicationContext class | Microsoft Docs","_op_ogTitle":"ApplicationContext class","description":"Specifies the contextual information about an application thread.\n","toc_asset_id":"_splitted/System.Windows.Forms/toc.json","toc_rel":"_splitted/System.Windows.Forms/toc.json","source_url":"","ms.assetid":"System.Windows.Forms.ApplicationContext","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.windows.forms.applicationcontext","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.windows.forms.applicationcontext","fileRelativePath":"System.Windows.Forms.ApplicationContext.html"},"themesRelativePathToOutputRoot":"_themes/"}