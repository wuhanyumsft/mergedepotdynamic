{"content":"    \r\n    <h1 id=\"System_Web_Security_SqlRoleProvider\">\r\n      <span class=\"lang-csharp\">SqlRoleProvider</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Manages storage of role membership information for an ASP.NET application in a SQL Server database.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class SqlRoleProvider : System.Web.Security.RoleProvider</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a>\r\n          </div>\r\n        </li>\r\n        <li class=\"l1\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.configuration.provider.providerbase\" data-linktype=\"relative-path\">ProviderBase</a>\r\n          </div>\r\n        </li>\r\n        <li class=\"l2\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.web.security.roleprovider\" data-linktype=\"relative-path\">System.Web.Security.RoleProvider</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l3\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">SqlRoleProvider</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.configuration.provider.providerbase#System_Configuration_Provider_ProviderBase_Description\" data-linktype=\"relative-path\">Description</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.configuration.provider.providerbase#System_Configuration_Provider_ProviderBase_Name\" data-linktype=\"relative-path\">Name</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>This class is used by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> and <a class=\"xref\" href=\"system.web.security.roleprincipal\" data-linktype=\"relative-path\">RolePrincipal</a> classes to provide role-management services for an ASP.NET application using a SQL Server database. You can use role management to specify different levels of authorization for your application.  </p>\n<p> To use the SqlRoleProvider class, you must first create the SQL Server database used by the SqlRoleProvider. To create the database used by the SqlRoleProvider class, run the <code>aspnet_regsql.exe</code> executable found in the C:\\WINDOWS\\Microsoft.NET\\Framework\\ <code>versionNumber</code> folder and specify the <code>-Ar</code> option (for example, <code>aspnet_regsql.exe -Ar</code>). The database created is called Aspnetdb. Alternatively, run aspnet_regsql.exe to pull up the GUI configuration mode and choose to configure all ASP.NET features.  </p>\n<p> If the role provider is configured with a connection string that uses integrated security, the process account of the ASP.NET application must have rights to connect to the SQL Server database.  </p>\n<p> The Machine.config file is configured with a SqlRoleProvider instance named AspNetSqlProvider that connects to the SQL Server on the local machine. You can use this instance of the provider, or specify your own in the Web.config file for your ASP.NET application. To use the AspNetSqlProvider instance, specify AspNetSqlProvider as the <code>defaultProvider</code> in your  configuration.  </p>\n<p> You can configure the SqlRoleProvider to use the same database and user information as the <a class=\"xref\" href=\"system.web.security.sqlmembershipprovider\" data-linktype=\"relative-path\">SqlMembershipProvider</a> in order to use a single database for authentication and authorization information. To use the same database for membership and role information, run the aspnet_regsql.exe executable and install the membership feature. Then, specify the same connection string in your configuration for both your SqlRoleProvider and <a class=\"xref\" href=\"system.web.security.sqlmembershipprovider\" data-linktype=\"relative-path\">SqlMembershipProvider</a> instances. Also ensure that both provider instances are configured with the same <a class=\"xref\" href=\"system.web.security.sqlroleprovider#System_Web_Security_SqlRoleProvider_ApplicationName_\" data-linktype=\"relative-path\">ApplicationName</a>.</p>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider__ctor\" data-linktype=\"self-bookmark\">SqlRoleProvider()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates an instance of the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_ApplicationName\" data-linktype=\"self-bookmark\">ApplicationName</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets or sets the name of the application for which to store and retrieve role information.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_AddUsersToRoles_System_String___System_String___\" data-linktype=\"self-bookmark\">AddUsersToRoles(String[],String[])</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Adds the specified user names to each of the specified roles.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_CreateRole_System_String_\" data-linktype=\"self-bookmark\">CreateRole(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Adds a new role to the role database.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_DeleteRole_System_String_System_Boolean_\" data-linktype=\"self-bookmark\">DeleteRole(String,Boolean)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Removes a role from the role database.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_FindUsersInRole_System_String_System_String_\" data-linktype=\"self-bookmark\">FindUsersInRole(String,String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets an array of user names in a role where the user name contains the specified user name to match.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_GetAllRoles\" data-linktype=\"self-bookmark\">GetAllRoles()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a list of all the roles for the application.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_GetRolesForUser_System_String_\" data-linktype=\"self-bookmark\">GetRolesForUser(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a list of the roles that a user is in.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_GetUsersInRole_System_String_\" data-linktype=\"self-bookmark\">GetUsersInRole(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a list of users in the specified role.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_Initialize_System_String_System_Collections_Specialized_NameValueCollection_\" data-linktype=\"self-bookmark\">Initialize(String,NameValueCollection)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes the SQL Server role provider with the property values specified in the ASP.NET application&#39;s configuration file. This method is not intended to be used directly from your code.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_IsUserInRole_System_String_System_String_\" data-linktype=\"self-bookmark\">IsUserInRole(String,String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a value indicating whether the specified user is in the specified role.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_RemoveUsersFromRoles_System_String___System_String___\" data-linktype=\"self-bookmark\">RemoveUsersFromRoles(String[],String[])</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Removes the specified user names from the specified roles.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Web_Security_SqlRoleProvider_RoleExists_System_String_\" data-linktype=\"self-bookmark\">RoleExists(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a value indicating whether the specified role name already exists in the role database.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider__ctor\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SqlRoleProvider()</div>        \r\n          </div>\r\n    \r\n            <p>Creates an instance of the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public SqlRoleProvider ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The SqlRoleProvider constructor is called by ASP.NET to create an instance of the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> class as specified in the configuration for the application. This constructor is not intended to be used from your code.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_ApplicationName\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_ApplicationName_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ApplicationName</div>        \r\n          </div>\r\n    \r\n            <p>Gets or sets the name of the application for which to store and retrieve role information.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override string ApplicationName { get; set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </div>\r\n                  <p>The name of the application for which to store and retrieve role information. The default is the <span class=\"xref\">stem.Web.HttpRequest.ApplicationPath*</span> property value for the current <span class=\"xref\">stem.Web.HttpContext.Request*</span>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.web.httpexception\" data-linktype=\"relative-path\">HttpException</a></div>\r\n                  </div>\r\n                  <p>An attempt was made to set the ApplicationName property by a caller that does not have <a class=\"xref\" href=\"system.web.aspnethostingpermissionlevel\" data-linktype=\"relative-path\">AspNetHostingPermissionLevel</a> ASP.NET hosting permission.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>An attempt was made to set the ApplicationName to a string that is longer than 256 characters.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The ApplicationName is used by the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> to associate users and roles with different applications. This enables multiple applications to use the same database to store user and role information without running into conflicts between duplicate user names or role names. Multiple ASP.NET applications can use the same database by specifying the same value in the ApplicationName property. The ApplicationName property can be set programmatically, or it can be set declaratively in the configuration file for the Web application using the <code>applicationName</code> attribute.  </p>\n<p> If a value is not specified for the <code>applicationName</code> attribute in the configuration file for the Web application, then the <a class=\"xref\" href=\"system.web.httprequest#System_Web_HttpRequest_ApplicationPath_\" data-linktype=\"relative-path\">ApplicationPath</a> property value for the current <a class=\"xref\" href=\"system.web.httpcontext#System_Web_HttpContext_Request_\" data-linktype=\"relative-path\">Request</a> object is used.  </p>\n<div class=\"CAUTION\"><h5>Caution</h5><p> Because a single default role provider instance is used for all of the requests served by an <a class=\"xref\" href=\"system.web.httpapplication\" data-linktype=\"relative-path\">HttpApplication</a> object, you can have multiple requests executing concurrently and attempting to set the ApplicationName property value. The ApplicationName property is not thread safe for multiple writes, and changing the ApplicationName property value can result in unexpected behavior for multiple users of an application. It is recommended that you avoid writing code that allows users to set the ApplicationName property unless you must. An example of an application where setting the ApplicationName property may be required is an administrative application that manages role data for multiple applications. Such an application should be a single-user application and not a Web application.</p>\n</div>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows the  element in the <code>system.web</code> section of the Web.config file for an ASP.NET application. It specifies the application&#39;s <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> instance and sets the ApplicationName property to <code>MyApplication</code>.  </p>\n<pre><code>&lt;roleManager defaultProvider=&quot;SqlProvider&quot;   \n  enabled=&quot;true&quot;  \n  cacheRolesInCookie=&quot;true&quot;  \n  cookieName=&quot;.ASPROLES&quot;  \n  cookieTimeout=&quot;30&quot;  \n  cookiePath=&quot;/&quot;  \n  cookieRequireSSL=&quot;false&quot;  \n  cookieSlidingExpiration=&quot;true&quot;  \n  cookieProtection=&quot;All&quot; &gt;  \n  &lt;providers&gt;  \n    &lt;add  \n      name=&quot;SqlProvider&quot;  \n      type=&quot;System.Web.Security.SqlRoleProvider&quot;  \n      connectionStringName=&quot;SqlServices&quot;  \n      applicationName=&quot;MyApplication&quot; /&gt;  \n  &lt;/providers&gt;  \n&lt;/roleManager&gt;  \n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_AddUsersToRoles_System_String___System_String___\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_AddUsersToRoles_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">AddUsersToRoles(String[],String[])</div>        \r\n          </div>\r\n    \r\n            <p>Adds the specified user names to each of the specified roles.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override void AddUsersToRoles (string[] usernames, string[] roleNames);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>usernames</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A string array of user names to be added to the specified roles.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleNames</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A string array of role names to add the specified user names to.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>One of the roles in <code>roleNames</code> is <code>null</code>.  </p>\n<p> -or-  </p>\n<p> One of the users in <code>usernames</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p>One of the roles in <code>roleNames</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> One of the users in <code>usernames</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> One of the roles in <code>roleNames</code> is longer than 256 characters.  </p>\n<p> -or-  </p>\n<p> One of the users in <code>usernames</code> is longer than 256 characters.  </p>\n<p> -or-  </p>\n<p> <code>roleNames</code> contains a duplicate element.  </p>\n<p> -or-  </p>\n<p> <code>usernames</code> contains a duplicate element.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>One or more of the specified role names was not found.  </p>\n<p> -or-  </p>\n<p> One or more of the specified user names was not found.  </p>\n<p> -or-  </p>\n<p> One or more of the specified user names is already associated with one or more of the specified role names.  </p>\n<p> -or-  </p>\n<p> An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The AddUsersToRoles method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to associate one or more users with one or more roles in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config). This method is called by the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_AddUserToRole_\" data-linktype=\"relative-path\">AddUserToRole</a>, <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_AddUserToRoles_\" data-linktype=\"relative-path\">AddUserToRoles</a>, <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_AddUsersToRole_\" data-linktype=\"relative-path\">AddUsersToRole</a>, and <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_AddUsersToRoles_\" data-linktype=\"relative-path\">AddUsersToRoles</a> methods of the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class.  </p>\n<p> The database updates that are performed during the call to the AddUsersToRoles method are made within a transaction. If an error is encountered, such as a user name that is already in a specified role, the transaction is rolled back and no updates are performed.  </p>\n<p> If the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> is being used with the <a class=\"xref\" href=\"system.web.security.sqlmembershipprovider\" data-linktype=\"relative-path\">SqlMembershipProvider</a>, and one of the specified user names does not exist in the database, the user name will be automatically added to the database.  </p>\n<p> User names and role names cannot contain commas.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example adds one or more users to a role or removes a user from a role. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#3\">\n&lt;%@ Page Language=&quot;C#&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.UI&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  string[] rolesArray;\n  MembershipUserCollection users;\n  string[] usersInRole;\n\n  public void Page_Load()\n  {\n    Msg.Text = &quot;&quot;;\n\n    if (!IsPostBack)\n    {\n      // Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles();\n      RolesListBox.DataSource = rolesArray;\n      RolesListBox.DataBind();\n\n      // Bind users to ListBox.\n\n      users = Membership.GetAllUsers();\n      UsersListBox.DataSource = users;\n      UsersListBox.DataBind();\n    }\n\n    if (RolesListBox.SelectedItem != null)\n    {\n      // Show users in role. Bind user list to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n      UsersInRoleGrid.DataSource = usersInRole;\n      UsersInRoleGrid.DataBind();\n    }\n  }\n\n\n  public void AddUsers_OnClick(object sender, EventArgs args)\n  {\n    // Verify that a role is selected.\n\n    if (RolesListBox.SelectedItem == null)\n    {\n      Msg.Text = &quot;Please select a role.&quot;;\n      return;\n    }\n\n\n    // Verify that at least one user is selected.\n\n    if (UsersListBox.SelectedItem == null)\n    {\n      Msg.Text = &quot;Please select one or more users.&quot;;\n      return;\n    }\n\n\n    // Create list of users to be added to the selected role.\n\n    string[] newusers = new string[UsersListBox.GetSelectedIndices().Length];\n\n    for (int i = 0; i &lt; newusers.Length; i++)\n    {\n      newusers[i] = UsersListBox.Items[UsersListBox.GetSelectedIndices()[i]].Value;\n    }\n\n\n    // Add the users to the selected role.\n\n    try\n    {\n      Roles.AddUsersToRole(newusers, RolesListBox.SelectedItem.Value);\n\n      // Re-bind users in role to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n      UsersInRoleGrid.DataSource = usersInRole;\n      UsersInRoleGrid.DataBind();\n    }\n    catch (Exception e)\n    {\n      Msg.Text = e.Message;\n    }\n  }\n\n\n  public void UsersInRoleGrid_RemoveFromRole(object sender, GridViewCommandEventArgs args)\n  {\n    // Get the selected user name to remove.\n\n    int index = Convert.ToInt32(args.CommandArgument);\n\n    string username = ((DataBoundLiteralControl)UsersInRoleGrid.Rows[index].Cells[0].Controls[0]).Text;\n\n\n    // Remove the user from the selected role.\n\n    try\n    {\n      Roles.RemoveUserFromRole(username, RolesListBox.SelectedItem.Value);\n    }\n    catch (Exception e)\n    {\n      Msg.Text = &quot;An exception of type &quot; + e.GetType().ToString() +\n                 &quot; was encountered removing the user from the role.&quot;;\n    }\n\n\n    // Re-bind users in role to GridView.\n\n    usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n    UsersInRoleGrid.DataSource = usersInRole;\n    UsersInRoleGrid.DataBind();\n  }\n\n\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Role Membership&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Role Membership&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table cellpadding=&quot;3&quot; border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Roles:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; Rows=&quot;8&quot; SelectionMode=&quot;Multiple&quot;\n            runat=&quot;server&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Add User(s) to Role&quot; ID=&quot;AddUsersButton&quot; runat=&quot;server&quot; OnClick=&quot;AddUsers_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users In Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; ID=&quot;UsersInRoleGrid&quot; AutoGenerateColumns=&quot;false&quot;\n            GridLines=&quot;None&quot; CellSpacing=&quot;0&quot; OnRowCommand=&quot;UsersInRoleGrid_RemoveFromRole&quot;&gt;\n            &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n            &lt;Columns&gt;\n              &lt;asp:TemplateField HeaderText=&quot;User Name&quot; &gt;\n                &lt;ItemTemplate&gt;\n                  &lt;%# Container.DataItem.ToString() %&gt;\n                &lt;/ItemTemplate&gt;\n              &lt;/asp:TemplateField&gt;\n              &lt;asp:ButtonField Text=&quot;Remove From Role&quot; ButtonType=&quot;Link&quot; /&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#3\">\n&lt;%@ Page Language=&quot;VB&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.UI&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  Dim rolesArray() As String\n  Dim users As MembershipUserCollection\n  Dim usersInRole() As String\n\n  Public Sub Page_Load()\n\n    Msg.Text = &quot;&quot;\n\n    If Not IsPostBack Then\n      &#39; Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles()\n      RolesListBox.DataSource = rolesArray\n      RolesListBox.DataBind()\n\n      &#39; Bind users to ListBox.\n\n      users = Membership.GetAllUsers()\n      UsersListBox.DataSource = users\n      UsersListBox.DataBind()\n    End If\n\n    If Not RolesListBox.SelectedItem Is Nothing Then\n      &#39; Show users in role. Bind user list to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n      UsersInRoleGrid.DataSource = usersInRole\n      UsersInRoleGrid.DataBind()\n    End If\n\n  End Sub\n\n\n  Public Sub AddUsers_OnClick(ByVal sender As Object, ByVal args As EventArgs)\n\n    &#39; Verify that a role is selected.\n\n    If RolesListBox.SelectedItem Is Nothing Then\n      Msg.Text = &quot;Please select a role.&quot;\n      Return\n    End If\n\n\n    &#39; Verify that at least one user is selected.\n\n    If UsersListBox.SelectedItem Is Nothing Then\n      Msg.Text = &quot;Please select one or more users.&quot;\n      Return\n    End If\n\n\n    &#39; Create list of users to be added to the selected role.\n\n    Dim newusers(UsersListBox.GetSelectedIndices().Length - 1) As String\n\n    For i As Integer = 0 To newusers.Length - 1\n      newusers(i) = UsersListBox.Items(UsersListBox.GetSelectedIndices(i)).Value\n    Next\n\n\n    &#39; Add the users to the selected role.\n\n    Try\n      Roles.AddUsersToRole(newusers, RolesListBox.SelectedItem.Value)\n\n      &#39; Re-bind users in role to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n      UsersInRoleGrid.DataSource = usersInRole\n      UsersInRoleGrid.DataBind()\n    Catch e As Exception\n      Msg.Text = e.Message\n    End Try\n\n  End Sub\n\n\n  Public Sub UsersInRoleGrid_RemoveFromRole(ByVal sender As Object, ByVal args As GridViewCommandEventArgs)\n\n    &#39; Get the selected user name to remove.\n\n    Dim index As Integer = Convert.ToInt32(args.CommandArgument)\n\n    Dim username As String = (CType(UsersInRoleGrid.Rows(index).Cells(0).Controls(0), DataBoundLiteralControl)).Text\n\n\n    &#39; Remove the user from the selected role.\n\n    Try\n      Roles.RemoveUserFromRole(username, RolesListBox.SelectedItem.Value)\n    Catch e As Exception\n      Msg.Text = &quot;An exception of type &quot; &amp; e.GetType().ToString() &amp; _\n                 &quot; was encountered removing the user from the role.&quot;\n    End Try\n\n    &#39; Re-bind users in role to GridView.\n\n    usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n    UsersInRoleGrid.DataSource = usersInRole\n    UsersInRoleGrid.DataBind()\n\n  End Sub\n\n\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Role Membership&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Role Membership&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table cellpadding=&quot;3&quot; border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Roles:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; Rows=&quot;8&quot; SelectionMode=&quot;Multiple&quot;\n            runat=&quot;server&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Add User(s) to Role&quot; ID=&quot;AddUsersButton&quot; runat=&quot;server&quot; OnClick=&quot;AddUsers_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users In Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; ID=&quot;UsersInRoleGrid&quot; AutoGenerateColumns=&quot;false&quot;\n            GridLines=&quot;None&quot; CellSpacing=&quot;0&quot; OnRowCommand=&quot;UsersInRoleGrid_RemoveFromRole&quot;&gt;\n            &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n            &lt;Columns&gt;\n              &lt;asp:TemplateField HeaderText=&quot;User Name&quot; &gt;\n                &lt;ItemTemplate&gt;\n                  &lt;%# Container.DataItem.ToString() %&gt;\n                &lt;/ItemTemplate&gt;\n              &lt;/asp:TemplateField&gt;\n              &lt;asp:ButtonField Text=&quot;Remove From Role&quot; ButtonType=&quot;Link&quot; /&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_CreateRole_System_String_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_CreateRole_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CreateRole(String)</div>        \r\n          </div>\r\n    \r\n            <p>Adds a new role to the role database.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override void CreateRole (string roleName);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleName</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The name of the role to create.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>roleName</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> already exists in the database.  </p>\n<p> -or-  </p>\n<p> An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The CreateRole method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to create a role in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config).  </p>\n<p> The maximum length for the role name is 256 characters. Role names are not case-sensitive. Commas are not allowed in role names.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example creates a new role in the database. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> This example contains a text box that accepts user input, which is a potential security threat. By default, ASP.NET Web pages validate that user input does not include script or HTML elements. For more information, see <a href=\"../Topic/Script%20Exploits%20Overview.md\" data-linktype=\"relative-path\">Script Exploits Overview</a>.  </p>\n</div>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#1\">&lt;%@ Page Language=&quot;C#&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nstring[] rolesArray;\n\npublic void Page_Load(object sender, EventArgs args)\n{\n  if (!IsPostBack)\n  {\n    // Bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles();\n    RolesGrid.DataSource = rolesArray;\n    RolesGrid.DataBind();\n  }\n}\n\npublic void CreateRole_OnClick(object sender, EventArgs args)\n{\n  string createRole = RoleTextBox.Text;\n\n  try\n  {\n    if (Roles.RoleExists(createRole))\n    {\n      Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; already exists. Please specify a different role name.&quot;;\n      return;\n    }\n\n    Roles.CreateRole(createRole);\n\n    Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; created.&quot;;\n\n    // Re-bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles();\n    RolesGrid.DataSource = rolesArray;\n    RolesGrid.DataBind();\n  }\n  catch (Exception e)\n  {\n    Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; &lt;u&gt;not&lt;/u&gt; created.&quot;;\n    Response.Write(e.ToString());\n  }\n\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Create Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n  &lt;h3&gt;Create a Role&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  Role name: \n\n  &lt;asp:TextBox id=&quot;RoleTextBox&quot; runat=&quot;server&quot; /&gt;\n\n  &lt;asp:Button Text=&quot;Create Role&quot; id=&quot;CreateRoleButton&quot;\n              runat=&quot;server&quot; OnClick=&quot;CreateRole_OnClick&quot; /&gt;\n\n  &lt;br /&gt;\n\n  &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;2&quot; id=&quot;RolesGrid&quot; \n                Gridlines=&quot;Both&quot; CellSpacing=&quot;2&quot; AutoGenerateColumns=&quot;false&quot; &gt;\n    &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n    &lt;Columns&gt;\n      &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n        &lt;ItemTemplate&gt;\n          &lt;%# Container.DataItem.ToString() %&gt;\n        &lt;/ItemTemplate&gt;\n      &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n   &lt;/asp:GridView&gt;\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#1\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nDim rolesArray() As String\n\nPublic Sub Page_Load(sender As Object, args As EventArgs)\n\n  If Not IsPostBack Then\n    &#39; Bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles()\n    RolesGrid.DataSource = rolesArray\n    RolesGrid.DataBind()\n  End If\n\nEnd Sub\n\nPublic Sub CreateRole_OnClick(sender As Object, args As EventArgs)\n\n  Dim createRole As String = RoleTextBox.Text\n\n  Try\n    If Roles.RoleExists(createRole) Then\n      Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; already exists. Please specify a different role name.&quot;\n      Return\n    End If\n\n    Roles.CreateRole(createRole)\n\n    Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; created.&quot;\n\n    &#39; Re-bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles()\n    RolesGrid.DataSource = rolesArray\n    RolesGrid.DataBind()\n  Catch\n    Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; &lt;u&gt;not&lt;/u&gt; created.&quot;\n  End Try\n\nEnd Sub\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Create Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n  &lt;h3&gt;Create a Role&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  Role name: \n\n  &lt;asp:TextBox id=&quot;RoleTextBox&quot; runat=&quot;server&quot; /&gt;\n\n  &lt;asp:Button Text=&quot;Create Role&quot; id=&quot;CreateRoleButton&quot;\n              runat=&quot;server&quot; OnClick=&quot;CreateRole_OnClick&quot; /&gt;\n\n  &lt;br /&gt;\n\n  &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;2&quot; id=&quot;RolesGrid&quot; \n                Gridlines=&quot;Both&quot; CellSpacing=&quot;2&quot; AutoGenerateColumns=&quot;false&quot; &gt;\n    &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n    &lt;Columns&gt;\n      &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n        &lt;ItemTemplate&gt;\n          &lt;%# Container.DataItem.ToString() %&gt;\n        &lt;/ItemTemplate&gt;\n      &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n   &lt;/asp:GridView&gt;\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_DeleteRole_System_String_System_Boolean_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_DeleteRole_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">DeleteRole(String,Boolean)</div>        \r\n          </div>\r\n    \r\n            <p>Removes a role from the role database.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override bool DeleteRole (string roleName, bool throwOnPopulatedRole);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleName</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The name of the role to delete.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>throwOnPopulatedRole</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>If <code>true</code>, throws an exception if <code>roleName</code> has one or more members.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the role was successfully deleted; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is <code>null</code> (<code>Nothing</code> in Visual Basic).</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>roleName</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> has one or more members and <code>throwOnPopulatedRole</code> is <code>true</code>.  </p>\n<p> -or-  </p>\n<p> An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The DeleteRole method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to delete a role from the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config). When a role is deleted, the list of users associated with that role is also deleted from the database. The user information in the database is not affected.  </p>\n<p> If <code>throwOnPopulatedRole</code> is <code>true</code>, then an exception will be thrown and the role will not be deleted if the role identified by the <code>roleName</code> parameter has one or more members. If <code>throwOnPopulatedRole</code> is <code>false</code>, then the role will be deleted whether it is empty or not.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example deletes a role from the database. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#2\">\n&lt;%@ Page Language=&quot;C#&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  string[] rolesArray;\n\n  public void Page_Load(object sender, EventArgs args)\n  {\n    if (!IsPostBack)\n    {\n      // Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles();\n      RolesListBox.DataSource = rolesArray;\n      RolesListBox.DataBind();\n    }\n  }\n\n\n  public void DeleteRole_OnClick(object sender, EventArgs args)\n  {\n    string delRole = &quot;&quot;;\n\n    try\n    {\n      delRole = RolesListBox.SelectedItem.Value;\n\n      Roles.DeleteRole(delRole);\n\n      Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(delRole) + &quot;&#39; deleted.&quot;;\n\n\n      // Re-bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles();\n      RolesListBox.DataSource = rolesArray;\n      RolesListBox.DataBind();\n    }\n    catch\n    {\n      Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(delRole) + &quot;&#39; &lt;u&gt;not&lt;/u&gt; deleted.&quot;;\n    }\n\n  }\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Delete Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Delete Role&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Delete Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Delete Role&quot; ID=&quot;DeleteRoleButton&quot; runat=&quot;server&quot; OnClick=&quot;DeleteRole_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#2\">\n&lt;%@ Page Language=&quot;VB&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  Dim rolesArray() As String\n\n  Public Sub Page_Load(ByVal sender As Object, ByVal args As EventArgs)\n\n    If Not IsPostBack Then\n      &#39; Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles()\n      RolesListBox.DataSource = rolesArray\n      RolesListBox.DataBind()\n    End If\n\n  End Sub\n\n\n  Public Sub DeleteRole_OnClick(ByVal sender As Object, ByVal args As EventArgs)\n\n    Dim delRole As String\n\n    Try\n      delRole = RolesListBox.SelectedItem.Value\n\n      Roles.DeleteRole(delRole)\n\n      Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(delRole) &amp; &quot;&#39; deleted.&quot;\n\n      &#39; Re-bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles()\n      RolesListBox.DataSource = rolesArray\n      RolesListBox.DataBind()\n    Catch\n      Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(delRole) &amp; &quot;&#39; &lt;u&gt;not&lt;/u&gt; deleted.&quot;\n    End Try\n\n  End Sub\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Delete Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Delete Role&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Delete Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Delete Role&quot; ID=&quot;DeleteRoleButton&quot; runat=&quot;server&quot; OnClick=&quot;DeleteRole_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_FindUsersInRole_System_String_System_String_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_FindUsersInRole_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">FindUsersInRole(String,String)</div>        \r\n          </div>\r\n    \r\n            <p>Gets an array of user names in a role where the user name contains the specified user name to match.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override string[] FindUsersInRole (string roleName, string usernameToMatch);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleName</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The role to search in.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>usernameToMatch</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The user name to search for.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </div>\r\n                  <p>A string array containing the names of all the users where the user name matches <code>usernameToMatch</code> and the user is a member of the specified role.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is <code>null</code> (<code>Nothing</code> in Visual Basic).  </p>\n<p> -or-  </p>\n<p> <code>usernameToMatch</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>usernameToMatch</code> is an empty string.  </p>\n<p> -or-  </p>\n<p> <code>roleName</code> is longer than 256 characters.  </p>\n<p> -or-  </p>\n<p> <code>usernameToMatch</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> was not found in the database.  </p>\n<p> -or-  </p>\n<p> An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The FindUsersInRole method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class and returns a list of users in a role where the user name contains a match of the supplied <code>usernameToMatch</code> for the configured <code>applicationName</code>. The <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> searches for a user name that matches the <code>usernameToMatch</code> parameter value using the LIKE keyword and supports SQL Server wildcard characters. For example, if the <code>usernameToMatch</code> parameter is set to &quot;user1&quot;, then membership information for the user with the user name of &quot;user1&quot; is returned, if it exists. If the <code>usernameToMatch</code> parameter is set to &quot;user%&quot;, then membership information for users with the user name of &quot;user1&quot;, &quot;user2&quot;, &quot;user_admin&quot;, and so on are returned.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_FindUsersInRole_\" data-linktype=\"relative-path\">FindUsersInRole</a> method to display role membership based on user input. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a>.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> This example contains a text box that accepts user input, which is a potential security threat. By default, ASP.NET Web pages validate that user input does not include script or HTML elements. For more information, see <a href=\"../Topic/Script%20Exploits%20Overview.md\" data-linktype=\"relative-path\">Script Exploits Overview</a>.  </p>\n</div>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.Roles#11\">&lt;%@ Page Language=&quot;C#&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nstring[] users;\n\npublic void Page_Load()\n{\n  if (!IsPostBack)\n  {\n    RolesListBox.DataSource = Roles.GetAllRoles();\n    RolesListBox.DataBind();\n  }\n}\n\npublic void GoButton_OnClick(object sender, EventArgs args)\n{\n  Msg.Text = &quot;&quot;;\n  users = null;\n\n  if (RolesListBox.SelectedItem == null)\n  {\n    Msg.Text = &quot;Please select a role.&quot;;\n    return;\n  }\n\n  users = Roles.FindUsersInRole(RolesListBox.SelectedItem.Text, UsernameTextBox.Text);\n\n  if (users.Length &lt; 1)\n  {\n    Msg.Text = &quot;No matching users found in selected role.&quot;;\n  }\n\n  UserGrid.DataSource = users;\n  UserGrid.DataBind();\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Find Users&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n  &lt;h3&gt;User List&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; runat=&quot;Server&quot; ForeColor=&quot;red&quot; /&gt;\n\n  &lt;table border=&quot;0&quot; cellpadding=&quot;3&quot; cellspacing=&quot;3&quot;&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;Role:&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:ListBox id=&quot;RolesListBox&quot; runat=&quot;Server&quot; /&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;Username to Search for:&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:TextBox id=&quot;UsernameTextBox&quot; runat=&quot;server&quot; /&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n  &lt;asp:Button id=&quot;GoButton&quot; Text=&quot; Go &quot; OnClick=&quot;GoButton_OnClick&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  &lt;asp:DataGrid id=&quot;UserGrid&quot; runat=&quot;server&quot;\n                CellPadding=&quot;2&quot; CellSpacing=&quot;1&quot;\n                Gridlines=&quot;Both&quot;&gt;\n    &lt;HeaderStyle BackColor=&quot;darkblue&quot; ForeColor=&quot;white&quot; /&gt;\n  &lt;/asp:DataGrid&gt;\n\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.Roles#11\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nDim users() As String\n\nPublic Sub Page_Load()\n  If Not IsPostBack Then\n    RolesListBox.DataSource = Roles.GetAllRoles()\n    RolesListBox.DataBind()\n  End If\nEnd SUb\n\nPublic Sub GoButton_OnClick(sender As Object, args As EventArgs)\n  Msg.Text = &quot;&quot;\n  users = Nothing\n\n  If RolesListBox.SelectedItem Is Nothing Then\n    Msg.Text = &quot;Please select a role.&quot;\n    Return\n  End If\n\n  users = Roles.FindUsersInRole(RolesListBox.SelectedItem.Text, UsernameTextBox.Text)\n\n  If users.Length &lt; 1 Then\n    Msg.Text = &quot;No matching users found in selected role.&quot;\n  End If\n\n  UserGrid.DataSource = users\n  UserGrid.DataBind()\nEnd Sub\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Find Users&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n  &lt;h3&gt;User List&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; runat=&quot;Server&quot; ForeColor=&quot;red&quot; /&gt;\n\n  &lt;table border=&quot;0&quot; cellpadding=&quot;3&quot; cellspacing=&quot;3&quot;&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;Role:&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:ListBox id=&quot;RolesListBox&quot; runat=&quot;Server&quot; /&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;Username to Search for:&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:TextBox id=&quot;UsernameTextBox&quot; runat=&quot;server&quot; /&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n  &lt;asp:Button id=&quot;GoButton&quot; Text=&quot; Go &quot; OnClick=&quot;GoButton_OnClick&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  &lt;asp:DataGrid id=&quot;UserGrid&quot; runat=&quot;server&quot;\n                CellPadding=&quot;2&quot; CellSpacing=&quot;1&quot;\n                Gridlines=&quot;Both&quot;&gt;\n    &lt;HeaderStyle BackColor=&quot;darkblue&quot; ForeColor=&quot;white&quot; /&gt;\n  &lt;/asp:DataGrid&gt;\n\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_GetAllRoles\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_GetAllRoles_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetAllRoles()</div>        \r\n          </div>\r\n    \r\n            <p>Gets a list of all the roles for the application.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override string[] GetAllRoles ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </div>\r\n                  <p>A string array containing the names of all the roles stored in the database for a particular application.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The GetAllRoles method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to retrieve a list of all the roles in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config).</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_GetAllRoles_\" data-linktype=\"relative-path\">GetAllRoles</a> method to get the list of roles for an application and bind the results to a <a class=\"xref\" href=\"system.web.ui.webcontrols.gridview\" data-linktype=\"relative-path\">System.Web.UI.WebControls.GridView</a> control. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> This example contains a text box that accepts user input, which is a potential security threat. By default, ASP.NET Web pages validate that user input does not include script or HTML elements. For more information, see <a href=\"../Topic/Script%20Exploits%20Overview.md\" data-linktype=\"relative-path\">Script Exploits Overview</a>.  </p>\n</div>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#1\">&lt;%@ Page Language=&quot;C#&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nstring[] rolesArray;\n\npublic void Page_Load(object sender, EventArgs args)\n{\n  if (!IsPostBack)\n  {\n    // Bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles();\n    RolesGrid.DataSource = rolesArray;\n    RolesGrid.DataBind();\n  }\n}\n\npublic void CreateRole_OnClick(object sender, EventArgs args)\n{\n  string createRole = RoleTextBox.Text;\n\n  try\n  {\n    if (Roles.RoleExists(createRole))\n    {\n      Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; already exists. Please specify a different role name.&quot;;\n      return;\n    }\n\n    Roles.CreateRole(createRole);\n\n    Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; created.&quot;;\n\n    // Re-bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles();\n    RolesGrid.DataSource = rolesArray;\n    RolesGrid.DataBind();\n  }\n  catch (Exception e)\n  {\n    Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; &lt;u&gt;not&lt;/u&gt; created.&quot;;\n    Response.Write(e.ToString());\n  }\n\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Create Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n  &lt;h3&gt;Create a Role&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  Role name: \n\n  &lt;asp:TextBox id=&quot;RoleTextBox&quot; runat=&quot;server&quot; /&gt;\n\n  &lt;asp:Button Text=&quot;Create Role&quot; id=&quot;CreateRoleButton&quot;\n              runat=&quot;server&quot; OnClick=&quot;CreateRole_OnClick&quot; /&gt;\n\n  &lt;br /&gt;\n\n  &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;2&quot; id=&quot;RolesGrid&quot; \n                Gridlines=&quot;Both&quot; CellSpacing=&quot;2&quot; AutoGenerateColumns=&quot;false&quot; &gt;\n    &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n    &lt;Columns&gt;\n      &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n        &lt;ItemTemplate&gt;\n          &lt;%# Container.DataItem.ToString() %&gt;\n        &lt;/ItemTemplate&gt;\n      &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n   &lt;/asp:GridView&gt;\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#1\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nDim rolesArray() As String\n\nPublic Sub Page_Load(sender As Object, args As EventArgs)\n\n  If Not IsPostBack Then\n    &#39; Bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles()\n    RolesGrid.DataSource = rolesArray\n    RolesGrid.DataBind()\n  End If\n\nEnd Sub\n\nPublic Sub CreateRole_OnClick(sender As Object, args As EventArgs)\n\n  Dim createRole As String = RoleTextBox.Text\n\n  Try\n    If Roles.RoleExists(createRole) Then\n      Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; already exists. Please specify a different role name.&quot;\n      Return\n    End If\n\n    Roles.CreateRole(createRole)\n\n    Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; created.&quot;\n\n    &#39; Re-bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles()\n    RolesGrid.DataSource = rolesArray\n    RolesGrid.DataBind()\n  Catch\n    Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; &lt;u&gt;not&lt;/u&gt; created.&quot;\n  End Try\n\nEnd Sub\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Create Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n  &lt;h3&gt;Create a Role&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  Role name: \n\n  &lt;asp:TextBox id=&quot;RoleTextBox&quot; runat=&quot;server&quot; /&gt;\n\n  &lt;asp:Button Text=&quot;Create Role&quot; id=&quot;CreateRoleButton&quot;\n              runat=&quot;server&quot; OnClick=&quot;CreateRole_OnClick&quot; /&gt;\n\n  &lt;br /&gt;\n\n  &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;2&quot; id=&quot;RolesGrid&quot; \n                Gridlines=&quot;Both&quot; CellSpacing=&quot;2&quot; AutoGenerateColumns=&quot;false&quot; &gt;\n    &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n    &lt;Columns&gt;\n      &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n        &lt;ItemTemplate&gt;\n          &lt;%# Container.DataItem.ToString() %&gt;\n        &lt;/ItemTemplate&gt;\n      &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n   &lt;/asp:GridView&gt;\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_GetRolesForUser_System_String_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_GetRolesForUser_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetRolesForUser(String)</div>        \r\n          </div>\r\n    \r\n            <p>Gets a list of the roles that a user is in.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override string[] GetRolesForUser (string username);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>username</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The user to return a list of roles for.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </div>\r\n                  <p>A string array containing the names of all the roles that the specified user is in.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>username</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>username</code> contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>username</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The GetRolesForUser method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to retrieve a list of a specified user&#39;s roles from the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config).</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_GetRolesForUser_\" data-linktype=\"relative-path\">GetRolesForUser</a> method to retrieve a list of roles for a specified user and binds them to a <a class=\"xref\" href=\"system.web.ui.webcontrols.gridview\" data-linktype=\"relative-path\">System.Web.UI.WebControls.GridView</a> control. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#4\">&lt;%@ Page Language=&quot;C#&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nstring[] rolesArray;\nMembershipUserCollection users;\n\npublic void Page_Load()\n{\n  Msg.Text = &quot;&quot;;\n\n  try\n  {\n    if (!Roles.IsUserInRole(User.Identity.Name, &quot;Administrators&quot;))\n    {\n      Msg.Text = &quot;You are not authorized to view user roles.&quot;;\n      UsersListBox.Visible = false;\n      return;\n    }\n  }\n  catch (HttpException e)\n  {\n    Msg.Text = &quot;There is no current logged on user. Role membership cannot be verified.&quot;;\n    return;\n  }\n\n\n  if (!IsPostBack)\n  {\n    // Bind users to ListBox.\n\n    users = Membership.GetAllUsers();\n    UsersListBox.DataSource = users;\n    UsersListBox.DataBind();\n  }\n\n\n  // If a user is selected, show the roles for the selected user.\n\n  if (UsersListBox.SelectedItem != null)\n  {\n    // Bind roles to GridView.\n\n    rolesArray = Roles.GetRolesForUser(UsersListBox.SelectedItem.Value);\n    UserRolesGrid.DataSource = rolesArray;\n    UserRolesGrid.DataBind();\n\n    UserRolesGrid.Columns[0].HeaderText = &quot;Roles for &quot; + UsersListBox.SelectedItem.Value;\n  }\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: View User Roles&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n\n  &lt;h3&gt;View User Roles&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  &lt;table border=&quot;0&quot; cellspacing=&quot;4&quot;&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:ListBox id=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; \n                                    Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; runat=&quot;server&quot; /&gt;&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; id=&quot;UserRolesGrid&quot; \n                                     AutoGenerateColumns=&quot;false&quot; Gridlines=&quot;None&quot; \n                                     CellSpacing=&quot;0&quot; &gt;\n                         &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n                         &lt;Columns&gt;\n                           &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n                             &lt;ItemTemplate&gt;\n                               &lt;%# Container.DataItem.ToString() %&gt;\n                             &lt;/ItemTemplate&gt;\n                           &lt;/asp:TemplateField&gt;\n                         &lt;/Columns&gt;\n                       &lt;/asp:GridView&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#4\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nDim rolesArray() As String\nDim users As MembershipUserCollection\n\nPublic Sub Page_Load()\n\n  Msg.Text = &quot;&quot;\n\n  Try\n    If Not Roles.IsUserInRole(User.Identity.Name, &quot;Administrators&quot;) Then\n      Msg.Text = &quot;You are not authorized to view user roles.&quot;\n      UsersListBox.Visible = False\n      Return\n    End If\n  Catch e As HttpException\n    Msg.Text = &quot;There is no current logged on user. Role membership cannot be verified.&quot;\n    Return\n  End Try\n\n\n  If Not IsPostBack Then\n    &#39; Bind users to ListBox.\n\n    users = Membership.GetAllUsers()\n    UsersListBox.DataSource = users\n    UsersListBox.DataBind()\n  End If\n\n\n  &#39; If a user is selected, show the roles for the selected user.\n\n  If Not UsersListBox.SelectedItem Is Nothing Then\n    &#39; Bind roles to GridView.\n\n    rolesArray = Roles.GetRolesForUser(UsersListBox.SelectedItem.Value)\n    UserRolesGrid.DataSource = rolesArray\n    UserRolesGrid.DataBind()\n\n    UserRolesGrid.Columns(0).HeaderText = &quot;Roles for &quot; &amp; UsersListBox.SelectedItem.Value\n  End If\n\nEnd Sub\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: View User Roles&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n\n  &lt;h3&gt;View User Roles&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  &lt;table border=&quot;0&quot; cellspacing=&quot;4&quot;&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:ListBox id=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; \n                                    Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; runat=&quot;server&quot; /&gt;&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; id=&quot;UserRolesGrid&quot; \n                                     AutoGenerateColumns=&quot;false&quot; Gridlines=&quot;None&quot; \n                                     CellSpacing=&quot;0&quot; &gt;\n                         &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n                         &lt;Columns&gt;\n                           &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n                             &lt;ItemTemplate&gt;\n                               &lt;%# Container.DataItem.ToString() %&gt;\n                             &lt;/ItemTemplate&gt;\n                           &lt;/asp:TemplateField&gt;\n                         &lt;/Columns&gt;\n                       &lt;/asp:GridView&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_GetUsersInRole_System_String_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_GetUsersInRole_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetUsersInRole(String)</div>        \r\n          </div>\r\n    \r\n            <p>Gets a list of users in the specified role.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override string[] GetUsersInRole (string roleName);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleName</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The name of the role to get the list of users for.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </div>\r\n                  <p>A string array containing the names of all the users who are members of the specified role.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>roleName</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p><code>rolename</code> was not found in the database.  </p>\n<p> -or-  </p>\n<p> An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The GetUsersInRole method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to retrieve the list of users associated with the specified role in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config).</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_GetUsersInRole_\" data-linktype=\"relative-path\">GetUsersInRole</a> method to get a list of the users in a particular role and bind the results to a <a class=\"xref\" href=\"system.web.ui.webcontrols.gridview\" data-linktype=\"relative-path\">System.Web.UI.WebControls.GridView</a> control. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#3\">\n&lt;%@ Page Language=&quot;C#&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.UI&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  string[] rolesArray;\n  MembershipUserCollection users;\n  string[] usersInRole;\n\n  public void Page_Load()\n  {\n    Msg.Text = &quot;&quot;;\n\n    if (!IsPostBack)\n    {\n      // Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles();\n      RolesListBox.DataSource = rolesArray;\n      RolesListBox.DataBind();\n\n      // Bind users to ListBox.\n\n      users = Membership.GetAllUsers();\n      UsersListBox.DataSource = users;\n      UsersListBox.DataBind();\n    }\n\n    if (RolesListBox.SelectedItem != null)\n    {\n      // Show users in role. Bind user list to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n      UsersInRoleGrid.DataSource = usersInRole;\n      UsersInRoleGrid.DataBind();\n    }\n  }\n\n\n  public void AddUsers_OnClick(object sender, EventArgs args)\n  {\n    // Verify that a role is selected.\n\n    if (RolesListBox.SelectedItem == null)\n    {\n      Msg.Text = &quot;Please select a role.&quot;;\n      return;\n    }\n\n\n    // Verify that at least one user is selected.\n\n    if (UsersListBox.SelectedItem == null)\n    {\n      Msg.Text = &quot;Please select one or more users.&quot;;\n      return;\n    }\n\n\n    // Create list of users to be added to the selected role.\n\n    string[] newusers = new string[UsersListBox.GetSelectedIndices().Length];\n\n    for (int i = 0; i &lt; newusers.Length; i++)\n    {\n      newusers[i] = UsersListBox.Items[UsersListBox.GetSelectedIndices()[i]].Value;\n    }\n\n\n    // Add the users to the selected role.\n\n    try\n    {\n      Roles.AddUsersToRole(newusers, RolesListBox.SelectedItem.Value);\n\n      // Re-bind users in role to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n      UsersInRoleGrid.DataSource = usersInRole;\n      UsersInRoleGrid.DataBind();\n    }\n    catch (Exception e)\n    {\n      Msg.Text = e.Message;\n    }\n  }\n\n\n  public void UsersInRoleGrid_RemoveFromRole(object sender, GridViewCommandEventArgs args)\n  {\n    // Get the selected user name to remove.\n\n    int index = Convert.ToInt32(args.CommandArgument);\n\n    string username = ((DataBoundLiteralControl)UsersInRoleGrid.Rows[index].Cells[0].Controls[0]).Text;\n\n\n    // Remove the user from the selected role.\n\n    try\n    {\n      Roles.RemoveUserFromRole(username, RolesListBox.SelectedItem.Value);\n    }\n    catch (Exception e)\n    {\n      Msg.Text = &quot;An exception of type &quot; + e.GetType().ToString() +\n                 &quot; was encountered removing the user from the role.&quot;;\n    }\n\n\n    // Re-bind users in role to GridView.\n\n    usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n    UsersInRoleGrid.DataSource = usersInRole;\n    UsersInRoleGrid.DataBind();\n  }\n\n\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Role Membership&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Role Membership&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table cellpadding=&quot;3&quot; border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Roles:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; Rows=&quot;8&quot; SelectionMode=&quot;Multiple&quot;\n            runat=&quot;server&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Add User(s) to Role&quot; ID=&quot;AddUsersButton&quot; runat=&quot;server&quot; OnClick=&quot;AddUsers_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users In Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; ID=&quot;UsersInRoleGrid&quot; AutoGenerateColumns=&quot;false&quot;\n            GridLines=&quot;None&quot; CellSpacing=&quot;0&quot; OnRowCommand=&quot;UsersInRoleGrid_RemoveFromRole&quot;&gt;\n            &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n            &lt;Columns&gt;\n              &lt;asp:TemplateField HeaderText=&quot;User Name&quot; &gt;\n                &lt;ItemTemplate&gt;\n                  &lt;%# Container.DataItem.ToString() %&gt;\n                &lt;/ItemTemplate&gt;\n              &lt;/asp:TemplateField&gt;\n              &lt;asp:ButtonField Text=&quot;Remove From Role&quot; ButtonType=&quot;Link&quot; /&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#3\">\n&lt;%@ Page Language=&quot;VB&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.UI&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  Dim rolesArray() As String\n  Dim users As MembershipUserCollection\n  Dim usersInRole() As String\n\n  Public Sub Page_Load()\n\n    Msg.Text = &quot;&quot;\n\n    If Not IsPostBack Then\n      &#39; Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles()\n      RolesListBox.DataSource = rolesArray\n      RolesListBox.DataBind()\n\n      &#39; Bind users to ListBox.\n\n      users = Membership.GetAllUsers()\n      UsersListBox.DataSource = users\n      UsersListBox.DataBind()\n    End If\n\n    If Not RolesListBox.SelectedItem Is Nothing Then\n      &#39; Show users in role. Bind user list to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n      UsersInRoleGrid.DataSource = usersInRole\n      UsersInRoleGrid.DataBind()\n    End If\n\n  End Sub\n\n\n  Public Sub AddUsers_OnClick(ByVal sender As Object, ByVal args As EventArgs)\n\n    &#39; Verify that a role is selected.\n\n    If RolesListBox.SelectedItem Is Nothing Then\n      Msg.Text = &quot;Please select a role.&quot;\n      Return\n    End If\n\n\n    &#39; Verify that at least one user is selected.\n\n    If UsersListBox.SelectedItem Is Nothing Then\n      Msg.Text = &quot;Please select one or more users.&quot;\n      Return\n    End If\n\n\n    &#39; Create list of users to be added to the selected role.\n\n    Dim newusers(UsersListBox.GetSelectedIndices().Length - 1) As String\n\n    For i As Integer = 0 To newusers.Length - 1\n      newusers(i) = UsersListBox.Items(UsersListBox.GetSelectedIndices(i)).Value\n    Next\n\n\n    &#39; Add the users to the selected role.\n\n    Try\n      Roles.AddUsersToRole(newusers, RolesListBox.SelectedItem.Value)\n\n      &#39; Re-bind users in role to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n      UsersInRoleGrid.DataSource = usersInRole\n      UsersInRoleGrid.DataBind()\n    Catch e As Exception\n      Msg.Text = e.Message\n    End Try\n\n  End Sub\n\n\n  Public Sub UsersInRoleGrid_RemoveFromRole(ByVal sender As Object, ByVal args As GridViewCommandEventArgs)\n\n    &#39; Get the selected user name to remove.\n\n    Dim index As Integer = Convert.ToInt32(args.CommandArgument)\n\n    Dim username As String = (CType(UsersInRoleGrid.Rows(index).Cells(0).Controls(0), DataBoundLiteralControl)).Text\n\n\n    &#39; Remove the user from the selected role.\n\n    Try\n      Roles.RemoveUserFromRole(username, RolesListBox.SelectedItem.Value)\n    Catch e As Exception\n      Msg.Text = &quot;An exception of type &quot; &amp; e.GetType().ToString() &amp; _\n                 &quot; was encountered removing the user from the role.&quot;\n    End Try\n\n    &#39; Re-bind users in role to GridView.\n\n    usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n    UsersInRoleGrid.DataSource = usersInRole\n    UsersInRoleGrid.DataBind()\n\n  End Sub\n\n\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Role Membership&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Role Membership&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table cellpadding=&quot;3&quot; border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Roles:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; Rows=&quot;8&quot; SelectionMode=&quot;Multiple&quot;\n            runat=&quot;server&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Add User(s) to Role&quot; ID=&quot;AddUsersButton&quot; runat=&quot;server&quot; OnClick=&quot;AddUsers_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users In Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; ID=&quot;UsersInRoleGrid&quot; AutoGenerateColumns=&quot;false&quot;\n            GridLines=&quot;None&quot; CellSpacing=&quot;0&quot; OnRowCommand=&quot;UsersInRoleGrid_RemoveFromRole&quot;&gt;\n            &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n            &lt;Columns&gt;\n              &lt;asp:TemplateField HeaderText=&quot;User Name&quot; &gt;\n                &lt;ItemTemplate&gt;\n                  &lt;%# Container.DataItem.ToString() %&gt;\n                &lt;/ItemTemplate&gt;\n              &lt;/asp:TemplateField&gt;\n              &lt;asp:ButtonField Text=&quot;Remove From Role&quot; ButtonType=&quot;Link&quot; /&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_Initialize_System_String_System_Collections_Specialized_NameValueCollection_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_Initialize_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Initialize(String,NameValueCollection)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes the SQL Server role provider with the property values specified in the ASP.NET application&#39;s configuration file. This method is not intended to be used directly from your code.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>name</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The name of the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> instance to initialize.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>config</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.specialized.namevaluecollection\" data-linktype=\"relative-path\">NameValueCollection</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A <a class=\"xref\" href=\"system.collections.specialized.namevaluecollection\" data-linktype=\"relative-path\">NameValueCollection</a> that contains the names and values of configuration options for the role provider.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.web.httpexception\" data-linktype=\"relative-path\">HttpException</a></div>\r\n                  </div>\r\n                  <p>The ASP.NET application is not running at <a class=\"xref\" href=\"system.web.aspnethostingpermissionlevel\" data-linktype=\"relative-path\">AspNetHostingPermissionLevel</a> trust or higher.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>config</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionStringName</code> attribute is empty or does not exist in the application configuration file for this <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> instance.  </p>\n<p> -or-  </p>\n<p> The <code>applicationName</code> attribute exceeds 256 characters.  </p>\n<p> -or-  </p>\n<p> The application configuration file for this <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> instance contains an unrecognized attribute.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method initializes the <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a> with the property values specified in the ASP.NET application configuration file (Web.config) and is not intended to be used directly from your code.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_IsUserInRole_System_String_System_String_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_IsUserInRole_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IsUserInRole(String,String)</div>        \r\n          </div>\r\n    \r\n            <p>Gets a value indicating whether the specified user is in the specified role.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override bool IsUserInRole (string username, string roleName);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>username</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The user name to search for.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleName</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The role to search in.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the specified user name is in the specified role; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is <code>null</code>.  </p>\n<p> -or-  </p>\n<p> <code>username</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>username</code> is contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>roleName</code> is longer than 256 characters.  </p>\n<p> -or-  </p>\n<p> <code>username</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The IsUserInRole method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class and the <a class=\"xref\" href=\"system.security.principal.iprincipal#System_Security_Principal_IPrincipal_IsInRole_\" data-linktype=\"relative-path\">IsInRole</a> method of the <a class=\"xref\" href=\"system.web.ui.page#System_Web_UI_Page_User_\" data-linktype=\"relative-path\">User</a> property to determine whether a user is associated with a role in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config).</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example programmatically checks to see whether the logged-on user is in the Administrators role before allowing the user to view user roles. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#4\">&lt;%@ Page Language=&quot;C#&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nstring[] rolesArray;\nMembershipUserCollection users;\n\npublic void Page_Load()\n{\n  Msg.Text = &quot;&quot;;\n\n  try\n  {\n    if (!Roles.IsUserInRole(User.Identity.Name, &quot;Administrators&quot;))\n    {\n      Msg.Text = &quot;You are not authorized to view user roles.&quot;;\n      UsersListBox.Visible = false;\n      return;\n    }\n  }\n  catch (HttpException e)\n  {\n    Msg.Text = &quot;There is no current logged on user. Role membership cannot be verified.&quot;;\n    return;\n  }\n\n\n  if (!IsPostBack)\n  {\n    // Bind users to ListBox.\n\n    users = Membership.GetAllUsers();\n    UsersListBox.DataSource = users;\n    UsersListBox.DataBind();\n  }\n\n\n  // If a user is selected, show the roles for the selected user.\n\n  if (UsersListBox.SelectedItem != null)\n  {\n    // Bind roles to GridView.\n\n    rolesArray = Roles.GetRolesForUser(UsersListBox.SelectedItem.Value);\n    UserRolesGrid.DataSource = rolesArray;\n    UserRolesGrid.DataBind();\n\n    UserRolesGrid.Columns[0].HeaderText = &quot;Roles for &quot; + UsersListBox.SelectedItem.Value;\n  }\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: View User Roles&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n\n  &lt;h3&gt;View User Roles&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  &lt;table border=&quot;0&quot; cellspacing=&quot;4&quot;&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:ListBox id=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; \n                                    Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; runat=&quot;server&quot; /&gt;&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; id=&quot;UserRolesGrid&quot; \n                                     AutoGenerateColumns=&quot;false&quot; Gridlines=&quot;None&quot; \n                                     CellSpacing=&quot;0&quot; &gt;\n                         &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n                         &lt;Columns&gt;\n                           &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n                             &lt;ItemTemplate&gt;\n                               &lt;%# Container.DataItem.ToString() %&gt;\n                             &lt;/ItemTemplate&gt;\n                           &lt;/asp:TemplateField&gt;\n                         &lt;/Columns&gt;\n                       &lt;/asp:GridView&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#4\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nDim rolesArray() As String\nDim users As MembershipUserCollection\n\nPublic Sub Page_Load()\n\n  Msg.Text = &quot;&quot;\n\n  Try\n    If Not Roles.IsUserInRole(User.Identity.Name, &quot;Administrators&quot;) Then\n      Msg.Text = &quot;You are not authorized to view user roles.&quot;\n      UsersListBox.Visible = False\n      Return\n    End If\n  Catch e As HttpException\n    Msg.Text = &quot;There is no current logged on user. Role membership cannot be verified.&quot;\n    Return\n  End Try\n\n\n  If Not IsPostBack Then\n    &#39; Bind users to ListBox.\n\n    users = Membership.GetAllUsers()\n    UsersListBox.DataSource = users\n    UsersListBox.DataBind()\n  End If\n\n\n  &#39; If a user is selected, show the roles for the selected user.\n\n  If Not UsersListBox.SelectedItem Is Nothing Then\n    &#39; Bind roles to GridView.\n\n    rolesArray = Roles.GetRolesForUser(UsersListBox.SelectedItem.Value)\n    UserRolesGrid.DataSource = rolesArray\n    UserRolesGrid.DataBind()\n\n    UserRolesGrid.Columns(0).HeaderText = &quot;Roles for &quot; &amp; UsersListBox.SelectedItem.Value\n  End If\n\nEnd Sub\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: View User Roles&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n\n  &lt;h3&gt;View User Roles&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  &lt;table border=&quot;0&quot; cellspacing=&quot;4&quot;&gt;\n    &lt;tr&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:ListBox id=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; \n                                    Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; runat=&quot;server&quot; /&gt;&lt;/td&gt;\n      &lt;td valign=&quot;top&quot;&gt;&lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; id=&quot;UserRolesGrid&quot; \n                                     AutoGenerateColumns=&quot;false&quot; Gridlines=&quot;None&quot; \n                                     CellSpacing=&quot;0&quot; &gt;\n                         &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n                         &lt;Columns&gt;\n                           &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n                             &lt;ItemTemplate&gt;\n                               &lt;%# Container.DataItem.ToString() %&gt;\n                             &lt;/ItemTemplate&gt;\n                           &lt;/asp:TemplateField&gt;\n                         &lt;/Columns&gt;\n                       &lt;/asp:GridView&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_RemoveUsersFromRoles_System_String___System_String___\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_RemoveUsersFromRoles_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">RemoveUsersFromRoles(String[],String[])</div>        \r\n          </div>\r\n    \r\n            <p>Removes the specified user names from the specified roles.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override void RemoveUsersFromRoles (string[] usernames, string[] roleNames);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>usernames</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A string array of user names to be removed from the specified roles.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleNames</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>[]</div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A string array of role names to remove the specified user names from.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>One of the roles in <code>roleNames</code> is <code>null</code>.  </p>\n<p> -or-  </p>\n<p> One of the users in <code>usernames</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p>One of the roles in <code>roleNames</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> One of the users in <code>usernames</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> One of the roles in <code>roleNames</code> is longer than 256 characters.  </p>\n<p> -or-  </p>\n<p> One of the users in <code>usernames</code> is longer than 256 characters.  </p>\n<p> -or-  </p>\n<p> <code>roleNames</code> contains a duplicate element.  </p>\n<p> -or-  </p>\n<p> <code>usernames</code> contains a duplicate element.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>One or more of the specified user names was not found.  </p>\n<p> -or-  </p>\n<p> One or more of the specified role names was not found.  </p>\n<p> -or-  </p>\n<p> One or more of the specified user names is not associated with one or more of the specified role names.  </p>\n<p> -or-  </p>\n<p> An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The RemoveUsersFromRoles method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to remove one or more users from one or more roles in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config). This method is called by the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_RemoveUserFromRole_\" data-linktype=\"relative-path\">RemoveUserFromRole</a>, <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_RemoveUserFromRoles_\" data-linktype=\"relative-path\">RemoveUserFromRoles</a>, <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_RemoveUsersFromRole_\" data-linktype=\"relative-path\">RemoveUsersFromRole</a>, and <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_RemoveUsersFromRoles_\" data-linktype=\"relative-path\">RemoveUsersFromRoles</a> methods of the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class.  </p>\n<p> The database updates that are performed during the call to RemoveUsersFromRoles are made within a transaction. If an error is encountered, such as a user name that does not exist or a user name that is already in a specified role, the transaction is rolled back and no updates are performed.  </p>\n<p> User names and role names cannot contain commas.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example adds one or more users to a role or removes a user from a role. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#3\">\n&lt;%@ Page Language=&quot;C#&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.UI&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  string[] rolesArray;\n  MembershipUserCollection users;\n  string[] usersInRole;\n\n  public void Page_Load()\n  {\n    Msg.Text = &quot;&quot;;\n\n    if (!IsPostBack)\n    {\n      // Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles();\n      RolesListBox.DataSource = rolesArray;\n      RolesListBox.DataBind();\n\n      // Bind users to ListBox.\n\n      users = Membership.GetAllUsers();\n      UsersListBox.DataSource = users;\n      UsersListBox.DataBind();\n    }\n\n    if (RolesListBox.SelectedItem != null)\n    {\n      // Show users in role. Bind user list to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n      UsersInRoleGrid.DataSource = usersInRole;\n      UsersInRoleGrid.DataBind();\n    }\n  }\n\n\n  public void AddUsers_OnClick(object sender, EventArgs args)\n  {\n    // Verify that a role is selected.\n\n    if (RolesListBox.SelectedItem == null)\n    {\n      Msg.Text = &quot;Please select a role.&quot;;\n      return;\n    }\n\n\n    // Verify that at least one user is selected.\n\n    if (UsersListBox.SelectedItem == null)\n    {\n      Msg.Text = &quot;Please select one or more users.&quot;;\n      return;\n    }\n\n\n    // Create list of users to be added to the selected role.\n\n    string[] newusers = new string[UsersListBox.GetSelectedIndices().Length];\n\n    for (int i = 0; i &lt; newusers.Length; i++)\n    {\n      newusers[i] = UsersListBox.Items[UsersListBox.GetSelectedIndices()[i]].Value;\n    }\n\n\n    // Add the users to the selected role.\n\n    try\n    {\n      Roles.AddUsersToRole(newusers, RolesListBox.SelectedItem.Value);\n\n      // Re-bind users in role to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n      UsersInRoleGrid.DataSource = usersInRole;\n      UsersInRoleGrid.DataBind();\n    }\n    catch (Exception e)\n    {\n      Msg.Text = e.Message;\n    }\n  }\n\n\n  public void UsersInRoleGrid_RemoveFromRole(object sender, GridViewCommandEventArgs args)\n  {\n    // Get the selected user name to remove.\n\n    int index = Convert.ToInt32(args.CommandArgument);\n\n    string username = ((DataBoundLiteralControl)UsersInRoleGrid.Rows[index].Cells[0].Controls[0]).Text;\n\n\n    // Remove the user from the selected role.\n\n    try\n    {\n      Roles.RemoveUserFromRole(username, RolesListBox.SelectedItem.Value);\n    }\n    catch (Exception e)\n    {\n      Msg.Text = &quot;An exception of type &quot; + e.GetType().ToString() +\n                 &quot; was encountered removing the user from the role.&quot;;\n    }\n\n\n    // Re-bind users in role to GridView.\n\n    usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value);\n    UsersInRoleGrid.DataSource = usersInRole;\n    UsersInRoleGrid.DataBind();\n  }\n\n\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Role Membership&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Role Membership&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table cellpadding=&quot;3&quot; border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Roles:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; Rows=&quot;8&quot; SelectionMode=&quot;Multiple&quot;\n            runat=&quot;server&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Add User(s) to Role&quot; ID=&quot;AddUsersButton&quot; runat=&quot;server&quot; OnClick=&quot;AddUsers_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users In Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; ID=&quot;UsersInRoleGrid&quot; AutoGenerateColumns=&quot;false&quot;\n            GridLines=&quot;None&quot; CellSpacing=&quot;0&quot; OnRowCommand=&quot;UsersInRoleGrid_RemoveFromRole&quot;&gt;\n            &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n            &lt;Columns&gt;\n              &lt;asp:TemplateField HeaderText=&quot;User Name&quot; &gt;\n                &lt;ItemTemplate&gt;\n                  &lt;%# Container.DataItem.ToString() %&gt;\n                &lt;/ItemTemplate&gt;\n              &lt;/asp:TemplateField&gt;\n              &lt;asp:ButtonField Text=&quot;Remove From Role&quot; ButtonType=&quot;Link&quot; /&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#3\">\n&lt;%@ Page Language=&quot;VB&quot; %&gt;\n\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.UI&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  Dim rolesArray() As String\n  Dim users As MembershipUserCollection\n  Dim usersInRole() As String\n\n  Public Sub Page_Load()\n\n    Msg.Text = &quot;&quot;\n\n    If Not IsPostBack Then\n      &#39; Bind roles to ListBox.\n\n      rolesArray = Roles.GetAllRoles()\n      RolesListBox.DataSource = rolesArray\n      RolesListBox.DataBind()\n\n      &#39; Bind users to ListBox.\n\n      users = Membership.GetAllUsers()\n      UsersListBox.DataSource = users\n      UsersListBox.DataBind()\n    End If\n\n    If Not RolesListBox.SelectedItem Is Nothing Then\n      &#39; Show users in role. Bind user list to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n      UsersInRoleGrid.DataSource = usersInRole\n      UsersInRoleGrid.DataBind()\n    End If\n\n  End Sub\n\n\n  Public Sub AddUsers_OnClick(ByVal sender As Object, ByVal args As EventArgs)\n\n    &#39; Verify that a role is selected.\n\n    If RolesListBox.SelectedItem Is Nothing Then\n      Msg.Text = &quot;Please select a role.&quot;\n      Return\n    End If\n\n\n    &#39; Verify that at least one user is selected.\n\n    If UsersListBox.SelectedItem Is Nothing Then\n      Msg.Text = &quot;Please select one or more users.&quot;\n      Return\n    End If\n\n\n    &#39; Create list of users to be added to the selected role.\n\n    Dim newusers(UsersListBox.GetSelectedIndices().Length - 1) As String\n\n    For i As Integer = 0 To newusers.Length - 1\n      newusers(i) = UsersListBox.Items(UsersListBox.GetSelectedIndices(i)).Value\n    Next\n\n\n    &#39; Add the users to the selected role.\n\n    Try\n      Roles.AddUsersToRole(newusers, RolesListBox.SelectedItem.Value)\n\n      &#39; Re-bind users in role to GridView.\n\n      usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n      UsersInRoleGrid.DataSource = usersInRole\n      UsersInRoleGrid.DataBind()\n    Catch e As Exception\n      Msg.Text = e.Message\n    End Try\n\n  End Sub\n\n\n  Public Sub UsersInRoleGrid_RemoveFromRole(ByVal sender As Object, ByVal args As GridViewCommandEventArgs)\n\n    &#39; Get the selected user name to remove.\n\n    Dim index As Integer = Convert.ToInt32(args.CommandArgument)\n\n    Dim username As String = (CType(UsersInRoleGrid.Rows(index).Cells(0).Controls(0), DataBoundLiteralControl)).Text\n\n\n    &#39; Remove the user from the selected role.\n\n    Try\n      Roles.RemoveUserFromRole(username, RolesListBox.SelectedItem.Value)\n    Catch e As Exception\n      Msg.Text = &quot;An exception of type &quot; &amp; e.GetType().ToString() &amp; _\n                 &quot; was encountered removing the user from the role.&quot;\n    End Try\n\n    &#39; Re-bind users in role to GridView.\n\n    usersInRole = Roles.GetUsersInRole(RolesListBox.SelectedItem.Value)\n    UsersInRoleGrid.DataSource = usersInRole\n    UsersInRoleGrid.DataBind()\n\n  End Sub\n\n\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n  &lt;title&gt;Sample: Role Membership&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n    &lt;h3&gt;\n      Role Membership&lt;/h3&gt;\n    &lt;asp:Label ID=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n    &lt;table cellpadding=&quot;3&quot; border=&quot;0&quot;&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Roles:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;RolesListBox&quot; runat=&quot;server&quot; Rows=&quot;8&quot; AutoPostBack=&quot;true&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:ListBox ID=&quot;UsersListBox&quot; DataTextField=&quot;Username&quot; Rows=&quot;8&quot; SelectionMode=&quot;Multiple&quot;\n            runat=&quot;server&quot; /&gt;&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:Button Text=&quot;Add User(s) to Role&quot; ID=&quot;AddUsersButton&quot; runat=&quot;server&quot; OnClick=&quot;AddUsers_OnClick&quot; /&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          Users In Role:&lt;/td&gt;\n        &lt;td valign=&quot;top&quot;&gt;\n          &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;4&quot; ID=&quot;UsersInRoleGrid&quot; AutoGenerateColumns=&quot;false&quot;\n            GridLines=&quot;None&quot; CellSpacing=&quot;0&quot; OnRowCommand=&quot;UsersInRoleGrid_RemoveFromRole&quot;&gt;\n            &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n            &lt;Columns&gt;\n              &lt;asp:TemplateField HeaderText=&quot;User Name&quot; &gt;\n                &lt;ItemTemplate&gt;\n                  &lt;%# Container.DataItem.ToString() %&gt;\n                &lt;/ItemTemplate&gt;\n              &lt;/asp:TemplateField&gt;\n              &lt;asp:ButtonField Text=&quot;Remove From Role&quot; ButtonType=&quot;Link&quot; /&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Web_Security_SqlRoleProvider_RoleExists_System_String_\">\r\n    \r\n            <a id=\"System_Web_Security_SqlRoleProvider_RoleExists_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">RoleExists(String)</div>        \r\n          </div>\r\n    \r\n            <p>Gets a value indicating whether the specified role name already exists in the role database.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override bool RoleExists (string roleName);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>roleName</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The name of the role to search for in the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the role name already exists in the database; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>roleName</code> is an empty string or contains a comma.  </p>\n<p> -or-  </p>\n<p> <code>roleName</code> is longer than 256 characters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.provider.providerexception\" data-linktype=\"relative-path\">ProviderException</a></div>\r\n                  </div>\r\n                  <p>An unknown error occurred while communicating with the database.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The RoleExists method is called by the <a class=\"xref\" href=\"system.web.security.roles\" data-linktype=\"relative-path\">Roles</a> class to determine whether a role name exists in the SQL Server database specified in the ASP.NET application&#39;s configuration file (Web.config).</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example uses the <a class=\"xref\" href=\"system.web.security.roles#System_Web_Security_Roles_RoleExists_\" data-linktype=\"relative-path\">RoleExists</a> method to determine whether a role name already exists before creating the role. For an example of a Web.config file that enables role management, see <a class=\"xref\" href=\"system.web.security.sqlroleprovider\" data-linktype=\"relative-path\">SqlRoleProvider</a>.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> This example contains a text box that accepts user input, which is a potential security threat. By default, ASP.NET Web pages validate that user input does not include script or HTML elements. For more information, see <a href=\"../Topic/Script%20Exploits%20Overview.md\" data-linktype=\"relative-path\">Script Exploits Overview</a>.  </p>\n</div>\n<pre><code class=\"lang-cs\" name=\"System.Web.Security.SqlRoleProvider#1\">&lt;%@ Page Language=&quot;C#&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nstring[] rolesArray;\n\npublic void Page_Load(object sender, EventArgs args)\n{\n  if (!IsPostBack)\n  {\n    // Bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles();\n    RolesGrid.DataSource = rolesArray;\n    RolesGrid.DataBind();\n  }\n}\n\npublic void CreateRole_OnClick(object sender, EventArgs args)\n{\n  string createRole = RoleTextBox.Text;\n\n  try\n  {\n    if (Roles.RoleExists(createRole))\n    {\n      Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; already exists. Please specify a different role name.&quot;;\n      return;\n    }\n\n    Roles.CreateRole(createRole);\n\n    Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; created.&quot;;\n\n    // Re-bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles();\n    RolesGrid.DataSource = rolesArray;\n    RolesGrid.DataBind();\n  }\n  catch (Exception e)\n  {\n    Msg.Text = &quot;Role &#39;&quot; + Server.HtmlEncode(createRole) + &quot;&#39; &lt;u&gt;not&lt;/u&gt; created.&quot;;\n    Response.Write(e.ToString());\n  }\n\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Create Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n  &lt;h3&gt;Create a Role&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  Role name: \n\n  &lt;asp:TextBox id=&quot;RoleTextBox&quot; runat=&quot;server&quot; /&gt;\n\n  &lt;asp:Button Text=&quot;Create Role&quot; id=&quot;CreateRoleButton&quot;\n              runat=&quot;server&quot; OnClick=&quot;CreateRole_OnClick&quot; /&gt;\n\n  &lt;br /&gt;\n\n  &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;2&quot; id=&quot;RolesGrid&quot; \n                Gridlines=&quot;Both&quot; CellSpacing=&quot;2&quot; AutoGenerateColumns=&quot;false&quot; &gt;\n    &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n    &lt;Columns&gt;\n      &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n        &lt;ItemTemplate&gt;\n          &lt;%# Container.DataItem.ToString() %&gt;\n        &lt;/ItemTemplate&gt;\n      &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n   &lt;/asp:GridView&gt;\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.Security.SqlRoleProvider#1\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Import Namespace=&quot;System.Web.Security&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\nDim rolesArray() As String\n\nPublic Sub Page_Load(sender As Object, args As EventArgs)\n\n  If Not IsPostBack Then\n    &#39; Bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles()\n    RolesGrid.DataSource = rolesArray\n    RolesGrid.DataBind()\n  End If\n\nEnd Sub\n\nPublic Sub CreateRole_OnClick(sender As Object, args As EventArgs)\n\n  Dim createRole As String = RoleTextBox.Text\n\n  Try\n    If Roles.RoleExists(createRole) Then\n      Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; already exists. Please specify a different role name.&quot;\n      Return\n    End If\n\n    Roles.CreateRole(createRole)\n\n    Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; created.&quot;\n\n    &#39; Re-bind roles to GridView.\n\n    rolesArray = Roles.GetAllRoles()\n    RolesGrid.DataSource = rolesArray\n    RolesGrid.DataBind()\n  Catch\n    Msg.Text = &quot;Role &#39;&quot; &amp; Server.HtmlEncode(createRole) &amp; &quot;&#39; &lt;u&gt;not&lt;/u&gt; created.&quot;\n  End Try\n\nEnd Sub\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head&gt;\n&lt;title&gt;Sample: Create Role&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;form runat=&quot;server&quot; id=&quot;PageForm&quot;&gt;\n  &lt;h3&gt;Create a Role&lt;/h3&gt;\n\n  &lt;asp:Label id=&quot;Msg&quot; ForeColor=&quot;maroon&quot; runat=&quot;server&quot; /&gt;&lt;br /&gt;\n\n  Role name: \n\n  &lt;asp:TextBox id=&quot;RoleTextBox&quot; runat=&quot;server&quot; /&gt;\n\n  &lt;asp:Button Text=&quot;Create Role&quot; id=&quot;CreateRoleButton&quot;\n              runat=&quot;server&quot; OnClick=&quot;CreateRole_OnClick&quot; /&gt;\n\n  &lt;br /&gt;\n\n  &lt;asp:GridView runat=&quot;server&quot; CellPadding=&quot;2&quot; id=&quot;RolesGrid&quot; \n                Gridlines=&quot;Both&quot; CellSpacing=&quot;2&quot; AutoGenerateColumns=&quot;false&quot; &gt;\n    &lt;HeaderStyle BackColor=&quot;navy&quot; ForeColor=&quot;white&quot; /&gt;\n    &lt;Columns&gt;\n      &lt;asp:TemplateField HeaderText=&quot;Roles&quot; &gt;\n        &lt;ItemTemplate&gt;\n          &lt;%# Container.DataItem.ToString() %&gt;\n        &lt;/ItemTemplate&gt;\n      &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n   &lt;/asp:GridView&gt;\n&lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Web.Security.SqlRoleProvider.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Web.Security.SqlRoleProvider.yml\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider..ctor\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.AddUsersToRoles\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.ApplicationName\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.CreateRole\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.DeleteRole\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.FindUsersInRole\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.GetAllRoles\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.GetRolesForUser\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.GetUsersInRole\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.Initialize\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.IsUserInRole\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles\">\r\n<meta name=\"APIName\" content=\"System.Web.Security.SqlRoleProvider.RoleExists\">\r\n<meta name=\"APILocation\" content=\"System.Web.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"4430a82e-18f2-e6e8-31c3-41db3a30b289\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Manages storage of role membership information for an ASP.NET application in a SQL Server database.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Web.Security/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Web.Security.SqlRoleProvider\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix pointer ref","commit_sha":"76befb0e7f7b41839ec719047e5b39a5981298f3","commit_date":"2017-02-28 15:47:23 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Web.Security.SqlRoleProvider.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Web.Security.SqlRoleProvider.yml","open_to_public_contributors":true,"api_name":["System.Web.Security.SqlRoleProvider","System.Web.Security.SqlRoleProvider..ctor","System.Web.Security.SqlRoleProvider.AddUsersToRoles","System.Web.Security.SqlRoleProvider.ApplicationName","System.Web.Security.SqlRoleProvider.CreateRole","System.Web.Security.SqlRoleProvider.DeleteRole","System.Web.Security.SqlRoleProvider.FindUsersInRole","System.Web.Security.SqlRoleProvider.GetAllRoles","System.Web.Security.SqlRoleProvider.GetRolesForUser","System.Web.Security.SqlRoleProvider.GetUsersInRole","System.Web.Security.SqlRoleProvider.Initialize","System.Web.Security.SqlRoleProvider.IsUserInRole","System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles","System.Web.Security.SqlRoleProvider.RoleExists"],"api_location":["System.Web.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Web.Security.SqlRoleProvider","System::Web::Security::SqlRoleProvider","System.Web.Security.SqlRoleProvider.#ctor","System::Web::Security::SqlRoleProvider::#ctor","System.Web.Security.SqlRoleProvider.AddUsersToRoles","System::Web::Security::SqlRoleProvider::AddUsersToRoles","System.Web.Security.SqlRoleProvider.ApplicationName","System::Web::Security::SqlRoleProvider::ApplicationName","System.Web.Security.SqlRoleProvider.CreateRole","System::Web::Security::SqlRoleProvider::CreateRole","System.Web.Security.SqlRoleProvider.DeleteRole","System::Web::Security::SqlRoleProvider::DeleteRole","System.Web.Security.SqlRoleProvider.FindUsersInRole","System::Web::Security::SqlRoleProvider::FindUsersInRole","System.Web.Security.SqlRoleProvider.GetAllRoles","System::Web::Security::SqlRoleProvider::GetAllRoles","System.Web.Security.SqlRoleProvider.GetRolesForUser","System::Web::Security::SqlRoleProvider::GetRolesForUser","System.Web.Security.SqlRoleProvider.GetUsersInRole","System::Web::Security::SqlRoleProvider::GetUsersInRole","System.Web.Security.SqlRoleProvider.Initialize","System::Web::Security::SqlRoleProvider::Initialize","System.Web.Security.SqlRoleProvider.IsUserInRole","System::Web::Security::SqlRoleProvider::IsUserInRole","System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles","System::Web::Security::SqlRoleProvider::RemoveUsersFromRoles","System.Web.Security.SqlRoleProvider.RoleExists","System::Web::Security::SqlRoleProvider::RoleExists"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"4430a82e-18f2-e6e8-31c3-41db3a30b289","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Web.Security/SqlRoleProvider.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"SqlRoleProvider class | Microsoft Docs","_op_ogTitle":"SqlRoleProvider class","description":"Manages storage of role membership information for an ASP.NET application in a SQL Server database.\n","toc_asset_id":"_splitted/System.Web.Security/toc.json","toc_rel":"_splitted/System.Web.Security/toc.json","source_url":"","ms.assetid":"System.Web.Security.SqlRoleProvider","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.web.security.sqlroleprovider","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.web.security.sqlroleprovider","fileRelativePath":"System.Web.Security.SqlRoleProvider.html"},"themesRelativePathToOutputRoot":"_themes/"}