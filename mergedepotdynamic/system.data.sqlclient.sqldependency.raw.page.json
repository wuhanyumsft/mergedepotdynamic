{"content":"    \r\n    <h1 id=\"System_Data_SqlClient_SqlDependency\">\r\n      <span class=\"lang-csharp\">SqlDependency</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>The SqlDependency object represents a query notification dependency between an application and an instance of SQL Server. An application can create a SqlDependency object and register to receive notifications via the <a class=\"xref\" href=\"system.data.sqlclient.onchangeeventhandler\" data-linktype=\"relative-path\">OnChangeEventHandler</a> event handler.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public sealed class SqlDependency</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">SqlDependency</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>SqlDependency is ideal for caching scenarios, where your ASP.NET application or middle-tier service needs to keep certain information cached in memory. SqlDependency allows you to receive notifications when the original data in the database changes so that the cache can be refreshed.  </p>\n<p> To set up a dependency, you need to associate a SqlDependency object to one or more <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> objects. To receive notifications, you need to subscribe to the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_OnChange\" data-linktype=\"relative-path\">OnChange</a> event. For more information about the requirements for creating queries for notifications, see &quot;Creating a Query for Notification&quot; in SQL Server Books Online.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> SqlDependency was designed to be used in ASP.NET or middle-tier services where there is a relatively small number of servers having dependencies active against the database. It was not designed for use in client applications, where hundreds or thousands of client computers would have SqlDependency objects set up for a single database server. If you are developing an application where you need reliable sub-second notifications when data changes, review the sections <strong>Planning an Efficient Query Notifications Strategy</strong> and <strong>Alternatives to Query Notifications</strong> in the <a href=\"http://go.microsoft.com/fwlink/?LinkId=211984\" data-linktype=\"external\">Planning for Notifications</a> topic in SQL Server Books Online.  </p>\n</div>\n<p> For more information, see <a href=\"../Topic/Query%20Notifications%20in%20SQL%20Server.md\" data-linktype=\"relative-path\">Query Notifications in SQL Server</a> and &quot;Building Notification Solutions&quot; in SQL Server Books Online.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_OnChange\" data-linktype=\"relative-path\">OnChange</a> event may be generated on a different thread from the thread that initiated command execution.  </p>\n</div>\n<p> Query notifications are supported only for SELECT statements that meet a list of specific requirements. The following table provides links to the Service Broker and Query Notifications documentation in SQL Server Books Online.  </p>\n<p> <strong>SQL Server Books Online</strong>  </p>\n<ul>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms181122.aspx\" data-linktype=\"external\">Creating a Query for Notification</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166059.aspx\" data-linktype=\"external\">Security Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522911.aspx\" data-linktype=\"external\">Security and Protection (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms172604.aspx\" data-linktype=\"external\">Security Considerations for Notifications Services</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms188311.aspx\" data-linktype=\"external\">Query Notification Permissions</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166028.aspx\" data-linktype=\"external\">International Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522899.aspx\" data-linktype=\"external\">Solution Design Considerations (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166100.aspx\" data-linktype=\"external\">Service Broker Developer InfoCenter</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522908.aspx\" data-linktype=\"external\">Developer&#39;s Guide (Service Broker)</a></p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency__ctor\" data-linktype=\"self-bookmark\">SqlDependency()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates a new instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class with the default settings.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency__ctor_System_Data_SqlClient_SqlCommand_\" data-linktype=\"self-bookmark\">SqlDependency(SqlCommand)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates a new instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class and associates it with the <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> parameter.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency__ctor_System_Data_SqlClient_SqlCommand_System_String_System_Int32_\" data-linktype=\"self-bookmark\">SqlDependency(SqlCommand,String,Int32)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates a new instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class, associates it with the <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> parameter, and specifies notification options and a time-out value.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_HasChanges\" data-linktype=\"self-bookmark\">HasChanges</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a value that indicates whether one of the result sets associated with the dependency has changed.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_Id\" data-linktype=\"self-bookmark\">Id</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets a value that uniquely identifies this instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_AddCommandDependency_System_Data_SqlClient_SqlCommand_\" data-linktype=\"self-bookmark\">AddCommandDependency(SqlCommand)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Associates a <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object with this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> instance.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_Start_System_String_\" data-linktype=\"self-bookmark\">Start(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Starts the listener for receiving dependency change notifications from the instance of SQL Server specified by the connection string.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_Start_System_String_System_String_\" data-linktype=\"self-bookmark\">Start(String,String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Starts the listener for receiving dependency change notifications from the instance of SQL Server specified by the connection string using the specified SQL Server Service Broker queue.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_Stop_System_String_\" data-linktype=\"self-bookmark\">Stop(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Stops a listener for a connection specified in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_Stop_System_String_System_String_\" data-linktype=\"self-bookmark\">Stop(String,String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Stops a listener for a connection specified in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Events\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Data_SqlClient_SqlDependency_OnChange\" data-linktype=\"self-bookmark\">OnChange</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Occurs when a notification is received for any of the commands associated with this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> object.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency__ctor\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SqlDependency()</div>        \r\n          </div>\r\n    \r\n            <p>Creates a new instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class with the default settings.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public SqlDependency ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The constructor initializes the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> object using the default Service Broker service name and time-out. At some point after construction, you must use the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_AddCommandDependency_\" data-linktype=\"relative-path\">AddCommandDependency</a> method to associate one or more commands to this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> object.  </p>\n<p> Query notifications are supported only for SELECT statements that meet a list of specific requirements. The following table provides links to the Service Broker and Query Notifications documentation in SQL Server Books Online.  </p>\n<p> <strong>SQL Server Books Online</strong>  </p>\n<ul>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms181122.aspx\" data-linktype=\"external\">Creating a Query for Notification</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166059.aspx\" data-linktype=\"external\">Security Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522911.aspx\" data-linktype=\"external\">Security and Protection (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms172604.aspx\" data-linktype=\"external\">Security Considerations for Notifications Services</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms188311.aspx\" data-linktype=\"external\">Query Notification Permissions</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166028.aspx\" data-linktype=\"external\">International Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522899.aspx\" data-linktype=\"external\">Solution Design Considerations (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166100.aspx\" data-linktype=\"external\">Service Broker Developer InfoCenter</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522908.aspx\" data-linktype=\"external\">Developer&#39;s Guide (Service Broker)</a></p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency__ctor_System_Data_SqlClient_SqlCommand_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SqlDependency(SqlCommand)</div>        \r\n          </div>\r\n    \r\n            <p>Creates a new instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class and associates it with the <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> parameter.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public SqlDependency (System.Data.SqlClient.SqlCommand command);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>command</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object to associate with this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> object. The constructor will set up a <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> object and bind it to the command.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>command</code> parameter is NULL.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object already has a <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> object assigned to its <span class=\"xref\">stem.Data.SqlClient.SqlCommand.Notification*</span> property, and that <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> is not associated with this dependency.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Internally, this constructor creates an instance of the <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> class, and binds it to a <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object.  </p>\n<p> Query notifications are supported only for SELECT statements that meet a list of specific requirements. The following table provides links to the Service Broker and Query Notifications documentation in SQL Server Books Online.  </p>\n<p> <strong>SQL Server Books Online</strong>  </p>\n<ul>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms181122.aspx\" data-linktype=\"external\">Creating a Query for Notification</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166059.aspx\" data-linktype=\"external\">Security Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522911.aspx\" data-linktype=\"external\">Security and Protection (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms172604.aspx\" data-linktype=\"external\">Security Considerations for Notifications Services</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms188311.aspx\" data-linktype=\"external\">Query Notification Permissions</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166028.aspx\" data-linktype=\"external\">International Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522899.aspx\" data-linktype=\"external\">Solution Design Considerations (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166100.aspx\" data-linktype=\"external\">Service Broker Developer InfoCenter</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522908.aspx\" data-linktype=\"external\">Developer&#39;s Guide (Service Broker)</a></p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency__ctor_System_Data_SqlClient_SqlCommand_System_String_System_Int32_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SqlDependency(SqlCommand,String,Int32)</div>        \r\n          </div>\r\n    \r\n            <p>Creates a new instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class, associates it with the <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> parameter, and specifies notification options and a time-out value.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public SqlDependency (System.Data.SqlClient.SqlCommand command, string options, int timeout);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>command</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object to associate with this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> object. The constructor sets up a <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> object and bind it to the command.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>options</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The notification request options to be used by this dependency.  <code>null</code> to use the default service.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>timeout</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The time-out for this notification in seconds. The default is 0, indicating that the server&#39;s time-out should be used.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>command</code> parameter is NULL.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentoutofrangeexception\" data-linktype=\"relative-path\">ArgumentOutOfRangeException</a></div>\r\n                  </div>\r\n                  <p>The time-out value is less than zero.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object already has a <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> object assigned to its <span class=\"xref\">stem.Data.SqlClient.SqlCommand.Notification*</span> property and that <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> is not associated with this dependency.  </p>\n<p> An attempt was made to create a <strong>SqlDependency</strong> instance from within SQLCLR.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Query notifications are supported only for SELECT statements that meet a list of specific requirements. The following table provides links to the Service Broker and Query Notifications documentation in SQL Server Books Online.  </p>\n<p> <strong>SQL Server Books Online</strong>  </p>\n<ul>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms181122.aspx\" data-linktype=\"external\">Creating a Query for Notification</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166059.aspx\" data-linktype=\"external\">Security Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522911.aspx\" data-linktype=\"external\">Security and Protection (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms172604.aspx\" data-linktype=\"external\">Security Considerations for Notifications Services</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms188311.aspx\" data-linktype=\"external\">Query Notification Permissions</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166028.aspx\" data-linktype=\"external\">International Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522899.aspx\" data-linktype=\"external\">Solution Design Considerations (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166100.aspx\" data-linktype=\"external\">Service Broker Developer InfoCenter</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522908.aspx\" data-linktype=\"external\">Developer&#39;s Guide (Service Broker)</a></p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_HasChanges\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_HasChanges_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">HasChanges</div>        \r\n          </div>\r\n    \r\n            <p>Gets a value that indicates whether one of the result sets associated with the dependency has changed.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public bool HasChanges { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p>A Boolean value indicating whether one of the result sets has changed.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>If you are not using the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_OnChange\" data-linktype=\"relative-path\">OnChange</a> event, you can check the HasChanges property to determine if the query results have changed.  </p>\n<p> The HasChanges property does not necessarily imply a change in the data. Other circumstances, such as time-out expired and failure to set the notification request, also generate a change event.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_Id\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_Id_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Id</div>        \r\n          </div>\r\n    \r\n            <p>Gets a value that uniquely identifies this instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public string Id { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </div>\r\n                  <p>A string representation of a GUID that is generated for each instance of the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> class.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The Id property is used to uniquely identify a given <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> instance.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_AddCommandDependency_System_Data_SqlClient_SqlCommand_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_AddCommandDependency_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">AddCommandDependency(SqlCommand)</div>        \r\n          </div>\r\n    \r\n            <p>Associates a <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object with this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> instance.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void AddCommandDependency (System.Data.SqlClient.SqlCommand command);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>command</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object containing a statement that is valid for notifications.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>command</code> parameter is null.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqlcommand\" data-linktype=\"relative-path\">SqlCommand</a> object already has a <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> object assigned to its <span class=\"xref\">stem.Data.SqlClient.SqlCommand.Notification*</span> property, and that <a class=\"xref\" href=\"system.data.sql.sqlnotificationrequest\" data-linktype=\"relative-path\">SqlNotificationRequest</a> is not associated with this dependency.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Query notifications are supported only for SELECT statements that meet a list of specific requirements. The following table provides links to the Service Broker and Query Notifications documentation in SQL Server Books Online.  </p>\n<p> <strong>SQL Server Books Online</strong>  </p>\n<ul>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms181122.aspx\" data-linktype=\"external\">Creating a Query for Notification</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166059.aspx\" data-linktype=\"external\">Security Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522911.aspx\" data-linktype=\"external\">Security and Protection (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms172604.aspx\" data-linktype=\"external\">Security Considerations for Notifications Services</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms188311.aspx\" data-linktype=\"external\">Query Notification Permissions</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166028.aspx\" data-linktype=\"external\">International Considerations for Service Broker</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522899.aspx\" data-linktype=\"external\">Solution Design Considerations (Service Broker)</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/ms166100.aspx\" data-linktype=\"external\">Service Broker Developer InfoCenter</a>  </p>\n</li>\n<li><p><a href=\"http://msdn.microsoft.com/library/bb522908.aspx\" data-linktype=\"external\">Developer&#39;s Guide (Service Broker)</a></p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_Start_System_String_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_Start_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Start(String)</div>        \r\n          </div>\r\n    \r\n            <p>Starts the listener for receiving dependency change notifications from the instance of SQL Server specified by the connection string.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static bool Start (string connectionString);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>connectionString</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The connection string for the instance of <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/ssnoversion-md.md&quot; -->SQL Server<!--END INCLUDE --> from which to obtain change notifications.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><strong>true</strong> if the listener initialized successfully; <strong>false</strong> if a compatible listener already exists.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionString</code> parameter is NULL.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionString</code> parameter is the same as a previous call to this method, but the parameters are different.  </p>\n<p> The method was called from within the CLR.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securityexception\" data-linktype=\"relative-path\">SecurityException</a></div>\r\n                  </div>\r\n                  <p>The caller does not have the required <a class=\"xref\" href=\"system.data.sqlclient.sqlclientpermission\" data-linktype=\"relative-path\">SqlClientPermission</a> code access security (CAS) permission.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlexception\" data-linktype=\"relative-path\">SqlException</a></div>\r\n                  </div>\r\n                  <p>A subsequent call to the method has been made with an equivalent <code>connectionString</code> parameter with a different user, or a user that does not default to the same schema.  </p>\n<p> Also, any underlying <strong>SqlClient</strong> exceptions.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method starts the listener for the <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a> for receiving dependency notifications from the instance of <!-- BEGIN INCLUDE: Include content from &quot;~/add/includes/ssnoversion-md.md&quot; -->SQL Server<!--END INCLUDE --> specified by the <code>connectionString</code> parameter. This method may be called more than once with different connection strings for multiple servers.  </p>\n<p> For additional remarks, see <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Start_\" data-linktype=\"relative-path\">Start</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_Start_System_String_System_String_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_Start_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Start(String,String)</div>        \r\n          </div>\r\n    \r\n            <p>Starts the listener for receiving dependency change notifications from the instance of SQL Server specified by the connection string using the specified SQL Server Service Broker queue.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static bool Start (string connectionString, string queue);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>connectionString</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The connection string for the instance of SQL Server from which to obtain change notifications.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>queue</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An existing SQL Server Service Broker queue to be used. If <code>null</code>, the default queue is used.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><strong>true</strong> if the listener initialized successfully; <strong>false</strong> if a compatible listener already exists.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionString</code> parameter is NULL.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionString</code> parameter is the same as a previous call to this method, but the parameters are different.  </p>\n<p> The method was called from within the CLR.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securityexception\" data-linktype=\"relative-path\">SecurityException</a></div>\r\n                  </div>\r\n                  <p>The caller does not have the required <a class=\"xref\" href=\"system.data.sqlclient.sqlclientpermission\" data-linktype=\"relative-path\">SqlClientPermission</a> code access security (CAS) permission.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlexception\" data-linktype=\"relative-path\">SqlException</a></div>\r\n                  </div>\r\n                  <p>A subsequent call to the method has been made with an equivalent <code>connectionString</code> parameter but a different user, or a user that does not default to the same schema.  </p>\n<p> Also, any underlying <strong>SqlClient</strong> exceptions.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method starts the listener for the <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a> for receiving dependency notifications from the instance of SQL Server specified by the <code>connectionString</code> parameter. This method may be called more than once with different connection strings for multiple servers.  </p>\n<p> If no queue name is specified, <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> creates a temporary queue and service in the server that is used for the entire process, even if the process involves more than one <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a>. The queue and service are automatically removed upon application shutdown.  </p>\n<p> For additional remarks, see <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Start_\" data-linktype=\"relative-path\">Start</a>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_Stop_System_String_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_Stop_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Stop(String)</div>        \r\n          </div>\r\n    \r\n            <p>Stops a listener for a connection specified in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static bool Stop (string connectionString);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>connectionString</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>Connection string for the instance of SQL Server that was used in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><strong>true</strong> if the listener was completely stopped; <strong>false</strong> if the <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a> was unbound from the listener, but there are is at least one other <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a> using the same listener.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionString</code> parameter is NULL.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The method was called from within SQLCLR.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securityexception\" data-linktype=\"relative-path\">SecurityException</a></div>\r\n                  </div>\r\n                  <p>The caller does not have the required <a class=\"xref\" href=\"system.data.sqlclient.sqlclientpermission\" data-linktype=\"relative-path\">SqlClientPermission</a> code access security (CAS) permission.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlexception\" data-linktype=\"relative-path\">SqlException</a></div>\r\n                  </div>\r\n                  <p>An underlying <strong>SqlClient</strong> exception occurred.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Stop_\" data-linktype=\"relative-path\">Stop</a> method must be called for each <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Start_\" data-linktype=\"relative-path\">Start</a> call. A given listener only shuts down fully when it receives the same number of <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Stop_\" data-linktype=\"relative-path\">Stop</a> requests as <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Start_\" data-linktype=\"relative-path\">Start</a> requests.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_Stop_System_String_System_String_\">\r\n    \r\n            <a id=\"System_Data_SqlClient_SqlDependency_Stop_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Stop(String,String)</div>        \r\n          </div>\r\n    \r\n            <p>Stops a listener for a connection specified in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static bool Stop (string connectionString, string queue);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>connectionString</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>Connection string for the instance of SQL Server that was used in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>queue</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The SQL Server Service Broker queue that was used in a previous <span class=\"xref\">stem.Data.SqlClient.SqlDependency.Start*</span> call.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><strong>true</strong> if the listener was completely stopped; <strong>false</strong> if the <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a> was unbound from the listener, but there is at least one other <a class=\"xref\" href=\"system.appdomain\" data-linktype=\"relative-path\">AppDomain</a> using the same listener.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>connectionString</code> parameter is NULL.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The method was called from within SQLCLR.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securityexception\" data-linktype=\"relative-path\">SecurityException</a></div>\r\n                  </div>\r\n                  <p>The caller does not have the required <a class=\"xref\" href=\"system.data.sqlclient.sqlclientpermission\" data-linktype=\"relative-path\">SqlClientPermission</a> code access security (CAS) permission.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.sqlclient.sqlexception\" data-linktype=\"relative-path\">SqlException</a></div>\r\n                  </div>\r\n                  <p>And underlying <strong>SqlClient</strong> exception occurred.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Stop_\" data-linktype=\"relative-path\">Stop</a> method must be called for each <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Start_\" data-linktype=\"relative-path\">Start</a> call. A given listener only shuts down fully when it receives the same number of <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Stop_\" data-linktype=\"relative-path\">Stop</a> requests as <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_Start_\" data-linktype=\"relative-path\">Start</a> requests.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"events\">\r\n        <h2>Events\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Data_SqlClient_SqlDependency_OnChange\">\r\n    \r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OnChange</div>        \r\n          </div>\r\n    \r\n            <p>Occurs when a notification is received for any of the commands associated with this <a class=\"xref\" href=\"system.data.sqlclient.sqldependency\" data-linktype=\"relative-path\">SqlDependency</a> object.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public event System.Data.SqlClient.OnChangeEventHandler OnChange;</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>OnChange occurs when the results for the associated command change. If you are not using OnChange, you can check the <a class=\"xref\" href=\"system.data.sqlclient.sqldependency#System_Data_SqlClient_SqlDependency_HasChanges_\" data-linktype=\"relative-path\">HasChanges</a> property to determine whether the query results have changed.  </p>\n<p> The OnChange event does not necessarily imply a change in the data. Other circumstances, such as time-out expired and failure to set the notification request, also generate OnChange.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Data.SqlClient.SqlDependency.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Data.SqlClient.SqlDependency.yml\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency..ctor\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.AddCommandDependency\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.HasChanges\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.Id\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.OnChange\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.add_OnChange\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.remove_OnChange\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.Start\">\r\n<meta name=\"APIName\" content=\"System.Data.SqlClient.SqlDependency.Stop\">\r\n<meta name=\"APILocation\" content=\"System.Data.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"7d6ed416-b2cc-15ff-4592-6d052d4cb2d9\">\r\n<meta name=\"original_ecmaxml_local_path\" content=\"W:\\vejk\\s\\fulldocset\\xml\\System.Data.SqlClient\\SqlDependency.xml\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"The SqlDependency object represents a query notification dependency between an application and an instance of SQL Server. An application can create a SqlDependency object and register to receive notiâ€¦\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Data.SqlClient/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Data.SqlClient.SqlDependency\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Data.SqlClient.SqlDependency.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Data.SqlClient.SqlDependency.yml","open_to_public_contributors":true,"api_name":["System.Data.SqlClient.SqlDependency","System.Data.SqlClient.SqlDependency..ctor","System.Data.SqlClient.SqlDependency.AddCommandDependency","System.Data.SqlClient.SqlDependency.HasChanges","System.Data.SqlClient.SqlDependency.Id","System.Data.SqlClient.SqlDependency.OnChange","System.Data.SqlClient.SqlDependency.add_OnChange","System.Data.SqlClient.SqlDependency.remove_OnChange","System.Data.SqlClient.SqlDependency.Start","System.Data.SqlClient.SqlDependency.Stop"],"api_location":["System.Data.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Data.SqlClient.SqlDependency","System::Data::SqlClient::SqlDependency","System.Data.SqlClient.SqlDependency.#ctor","System::Data::SqlClient::SqlDependency::#ctor","System.Data.SqlClient.SqlDependency.AddCommandDependency","System::Data::SqlClient::SqlDependency::AddCommandDependency","System.Data.SqlClient.SqlDependency.HasChanges","System::Data::SqlClient::SqlDependency::HasChanges","System.Data.SqlClient.SqlDependency.Id","System::Data::SqlClient::SqlDependency::Id","System.Data.SqlClient.SqlDependency.OnChange","System::Data::SqlClient::SqlDependency::OnChange","System.Data.SqlClient.SqlDependency.Start","System::Data::SqlClient::SqlDependency::Start","System.Data.SqlClient.SqlDependency.Stop","System::Data::SqlClient::SqlDependency::Stop"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"7d6ed416-b2cc-15ff-4592-6d052d4cb2d9","original_ecmaxml_local_path":"W:\\vejk\\s\\fulldocset\\xml\\System.Data.SqlClient\\SqlDependency.xml","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Data.SqlClient/SqlDependency.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"SqlDependency class | Microsoft Docs","_op_ogTitle":"SqlDependency class","description":"The SqlDependency object represents a query notification dependency between an application and an instance of SQL Server. An application can create a SqlDependency object and register to receive notiâ€¦","toc_asset_id":"_splitted/System.Data.SqlClient/toc.json","toc_rel":"_splitted/System.Data.SqlClient/toc.json","source_url":"","ms.assetid":"System.Data.SqlClient.SqlDependency","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.data.sqlclient.sqldependency","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.data.sqlclient.sqldependency","fileRelativePath":"System.Data.SqlClient.SqlDependency.html"},"themesRelativePathToOutputRoot":"_themes/"}