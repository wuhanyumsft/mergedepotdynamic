{"content":"    \r\n    <h1 id=\"System_Security_SecurityContext\">\r\n      <span class=\"lang-csharp\">SecurityContext</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Encapsulates and propagates all security-related data for execution contexts transferred across threads. This class cannot be inherited.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public sealed class SecurityContext : IDisposable</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">SecurityContext</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>A SecurityContext object captures all security-related information for a logical thread, including the information contained in the <a class=\"xref\" href=\"system.security.principal.windowsidentity\" data-linktype=\"relative-path\">WindowsIdentity</a> and <a class=\"xref\" href=\"system.threading.compressedstack\" data-linktype=\"relative-path\">CompressedStack</a> objects.  This configuration allows the Windows identity and the security elements on the stack to be propagated automatically when the SecurityContext is copied and transferred across asynchronous threads.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The common language runtime (CLR) is aware of impersonation operations performed using only managed code, not of impersonation performed outside of managed code, such as through platform invoke to unmanaged code or through direct calls to Win32 functions. Only managed <a class=\"xref\" href=\"system.security.principal.windowsidentity\" data-linktype=\"relative-path\">WindowsIdentity</a> objects can flow across asynchronous points, unless the <code>alwaysFlowImpersonationPolicy</code> element has been set to <code>true</code> (<code>&lt;alwaysFlowImpersonationPolicy enabled=&quot;true&quot;/&gt;</code>). Setting the <code>alwaysFlowImpersonationPolicy</code> element to <code>true</code> specifies that the Windows identity always flows across asynchronous points, regardless of how impersonation was performed. For more information about flowing unmanaged impersonation across asynchronous points, see <a href=\"../Topic/%3CalwaysFlowImpersonationPolicy%3E%20Element.md\" data-linktype=\"relative-path\">&amp;lt;alwaysFlowImpersonationPolicy&amp;gt; Element</a>.  </p>\n</div>\n<p> The SecurityContext is part of the larger <a class=\"xref\" href=\"system.threading.executioncontext\" data-linktype=\"relative-path\">ExecutionContext</a> and flows or migrates when the <a class=\"xref\" href=\"system.threading.executioncontext\" data-linktype=\"relative-path\">ExecutionContext</a> flows or migrates.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> This type implements the <a class=\"xref\" href=\"system.idisposable\" data-linktype=\"relative-path\">IDisposable</a> interface. When you have finished using the type, you should dispose of it either directly or indirectly. To dispose of the type directly, call its <a class=\"xref\" href=\"system.idisposable#System_IDisposable_Dispose_\" data-linktype=\"relative-path\">Dispose</a> method in a <code>try</code>/<code>catch</code> block. To dispose of it indirectly, use a language construct such as <code>using</code> (in C#) or <code>Using</code> (in Visual Basic). For more information, see the â€œUsing an Object that Implements IDisposableâ€ section in the <a class=\"xref\" href=\"system.idisposable\" data-linktype=\"relative-path\">IDisposable</a> interface topic.</p>\n</div>\n\r\n    \r\n    \r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_Capture\" data-linktype=\"self-bookmark\">Capture()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Captures the security context for the current thread.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_CreateCopy\" data-linktype=\"self-bookmark\">CreateCopy()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates a copy of the current security context.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_Dispose\" data-linktype=\"self-bookmark\">Dispose()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Releases all resources used by the current instance of the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_IsFlowSuppressed\" data-linktype=\"self-bookmark\">IsFlowSuppressed()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Determines whether the flow of the security context has been suppressed.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_IsWindowsIdentityFlowSuppressed\" data-linktype=\"self-bookmark\">IsWindowsIdentityFlowSuppressed()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Determines whether the flow of the Windows identity portion of the current security context has been suppressed.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_RestoreFlow\" data-linktype=\"self-bookmark\">RestoreFlow()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Restores the flow of the security context across asynchronous threads.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_Run_System_Security_SecurityContext_System_Threading_ContextCallback_System_Object_\" data-linktype=\"self-bookmark\">Run(SecurityContext,ContextCallback,Object)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Runs the specified method in the specified security context on the current thread.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_SuppressFlow\" data-linktype=\"self-bookmark\">SuppressFlow()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Suppresses the flow of the security context across asynchronous threads.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_SecurityContext_SuppressFlowWindowsIdentity\" data-linktype=\"self-bookmark\">SuppressFlowWindowsIdentity()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Suppresses the flow of the Windows identity portion of the current security context across asynchronous threads.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_Capture\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_Capture_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Capture()</div>        \r\n          </div>\r\n    \r\n            <p>Captures the security context for the current thread.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Security.SecurityContext Capture ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a></div>\r\n                  </div>\r\n                  <p>The security context for the current thread.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The captured security context can be applied to another thread. The <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> consists of the <a class=\"xref\" href=\"system.threading.compressedstack\" data-linktype=\"relative-path\">CompressedStack</a> and the <a class=\"xref\" href=\"system.security.principal.windowsidentity\" data-linktype=\"relative-path\">WindowsIdentity</a> for the executing thread.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_CreateCopy\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_CreateCopy_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CreateCopy()</div>        \r\n          </div>\r\n    \r\n            <p>Creates a copy of the current security context.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Security.SecurityContext CreateCopy ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a></div>\r\n                  </div>\r\n                  <p>The security context for the current thread.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The current security context has been previously used, was marshaled across application domains, or was not acquired through the <span class=\"xref\">stem.Security.SecurityContext.Capture*</span> method.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The current context must have been acquired through a capture or a copy operation. This method is useful for applying a captured <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> to multiple threads.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_Dispose\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_Dispose_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Dispose()</div>        \r\n          </div>\r\n    \r\n            <p>Releases all resources used by the current instance of the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void Dispose ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Call <code>Dispose</code> when you are finished using the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a>. The <code>Dispose</code> method leaves the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> in an unusable state. After calling <code>Dispose</code>, you must release all references to the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> so the garbage collector can reclaim the memory that the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> was occupying.  </p>\n<p> For more information, see <a href=\"../Topic/Cleaning%20Up%20Unmanaged%20Resources.md\" data-linktype=\"relative-path\">Cleaning Up Unmanaged Resources</a> and <a href=\"../Topic/Implementing%20a%20Dispose%20Method.md\" data-linktype=\"relative-path\">Implementing a Dispose Method</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Always call <code>Dispose</code> before you release your last reference to the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a>. Otherwise, the resources it is using will not be freed until the garbage collector calls the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> object&#39;s <code>Finalize</code> method.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_IsFlowSuppressed\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_IsFlowSuppressed_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IsFlowSuppressed()</div>        \r\n          </div>\r\n    \r\n            <p>Determines whether the flow of the security context has been suppressed.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static bool IsFlowSuppressed ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the flow has been suppressed; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The IsFlowSuppressed method is used by infrastructure components to determine whether to transfer the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> information during asynchronous operations.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_IsWindowsIdentityFlowSuppressed\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_IsWindowsIdentityFlowSuppressed_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">IsWindowsIdentityFlowSuppressed()</div>        \r\n          </div>\r\n    \r\n            <p>Determines whether the flow of the Windows identity portion of the current security context has been suppressed.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static bool IsWindowsIdentityFlowSuppressed ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the flow has been suppressed; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The IsWindowsIdentityFlowSuppressed method is used by infrastructure components to determine whether to transfer the Windows identity information when the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> migrates during asynchronous operations.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_RestoreFlow\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_RestoreFlow_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">RestoreFlow()</div>        \r\n          </div>\r\n    \r\n            <p>Restores the flow of the security context across asynchronous threads.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static void RestoreFlow ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The security context is <code>null</code> or an empty string.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The RestoreFlow method is called by the <a class=\"xref\" href=\"system.threading.asyncflowcontrol#System_Threading_AsyncFlowControl_Undo_\" data-linktype=\"relative-path\">Undo</a> method to reverse the effect of a prior <a class=\"xref\" href=\"system.security.securitycontext#System_Security_SecurityContext_SuppressFlow_\" data-linktype=\"relative-path\">SuppressFlow</a> method call.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_Run_System_Security_SecurityContext_System_Threading_ContextCallback_System_Object_\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_Run_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Run(SecurityContext,ContextCallback,Object)</div>        \r\n          </div>\r\n    \r\n            <p>Runs the specified method in the specified security context on the current thread.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static void Run (System.Security.SecurityContext securityContext, System.Threading.ContextCallback callback, object state);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>securityContext</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The security context to set.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>callback</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.threading.contextcallback\" data-linktype=\"relative-path\">ContextCallback</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The delegate that represents the method to run in the specified security context.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>state</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The object to pass to the callback method.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p><code>securityContext</code> is <code>null</code>.  </p>\n<p> -or-  </p>\n<p> <code>securityContext</code> was not acquired through a capture operation.  </p>\n<p> -or-  </p>\n<p> <code>securityContext</code> has already been used as the argument to a Run method call.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The security context for the current thread is returned to its previous state when the method call is complete.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example shows how to use the Run method to execute a method in a specified security context.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Security.SecurityContext.Run#1\">using System;\nusing System.Security;\nusing System.Threading;\n\nclass Test\n{\n    static void Main()\n    {\n        SecurityContext.Run(SecurityContext.Capture(), \n            new ContextCallback(Callback), &quot;Hello world.&quot;);\n    }\n    static void Callback(object o)\n    {\n        Console.WriteLine(o);\n    }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Security.SecurityContext.Run#1\">Imports System\nImports System.Security\nImports System.Threading\n\n\n\nClass Test\n    \n    Shared Sub Main() \n        Dim cCallBack As New ContextCallback(AddressOf Callback)\n        SecurityContext.Run(SecurityContext.Capture(), cCallBack, &quot;Hello world.&quot;)\n    End Sub &#39;Main\n    \n    Shared Sub Callback(ByVal o As Object) \n        Console.WriteLine(o)\n    \n    End Sub &#39;Callback\nEnd Class &#39;Test\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_SuppressFlow\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_SuppressFlow_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SuppressFlow()</div>        \r\n          </div>\r\n    \r\n            <p>Suppresses the flow of the security context across asynchronous threads.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Threading.AsyncFlowControl SuppressFlow ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.threading.asyncflowcontrol\" data-linktype=\"relative-path\">AsyncFlowControl</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.threading.asyncflowcontrol\" data-linktype=\"relative-path\">AsyncFlowControl</a> structure for restoring the flow.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this method to suppress the flow of <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> information on the current thread for asynchronous operations.  </p>\n<p> The common language runtime (CLR) is only aware of the impersonation operations performed using managed code. The CLR has no knowledge of impersonation performed outside of managed code, such as platform invokes to unmanaged code that does the impersonation, or through calls to Win32 functions. To flow identity across asynchronous points you must use the managed <a class=\"xref\" href=\"system.security.principal.windowsidentity\" data-linktype=\"relative-path\">WindowsIdentity</a> and <a class=\"xref\" href=\"system.security.principal.windowsimpersonationcontext\" data-linktype=\"relative-path\">WindowsImpersonationContext</a> methods.  </p>\n<p> Use the <a class=\"xref\" href=\"system.threading.asyncflowcontrol#System_Threading_AsyncFlowControl_Undo_\" data-linktype=\"relative-path\">Undo</a> method on the returned <a class=\"xref\" href=\"system.threading.asyncflowcontrol\" data-linktype=\"relative-path\">AsyncFlowControl</a> structure to return the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> object to its previous state.  </p>\n<p> This method is protected with a <a class=\"xref\" href=\"system.security.permissions.securityaction\" data-linktype=\"relative-path\">System.Security.Permissions.SecurityAction</a> for <a class=\"xref\" href=\"system.security.permissions.securitypermissionflag\" data-linktype=\"relative-path\">System.Security.Permissions.SecurityPermissionFlag</a> permission. A fully trusted component can call this method to suppress the flow of the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> information during asynchronous calls. When the flow is suppressed, the <a class=\"xref\" href=\"system.security.securitycontext#System_Security_SecurityContext_Capture_\" data-linktype=\"relative-path\">Capture</a> method returns <code>null</code>.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Security_SecurityContext_SuppressFlowWindowsIdentity\">\r\n    \r\n            <a id=\"System_Security_SecurityContext_SuppressFlowWindowsIdentity_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SuppressFlowWindowsIdentity()</div>        \r\n          </div>\r\n    \r\n            <p>Suppresses the flow of the Windows identity portion of the current security context across asynchronous threads.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Threading.AsyncFlowControl SuppressFlowWindowsIdentity ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.threading.asyncflowcontrol\" data-linktype=\"relative-path\">AsyncFlowControl</a></div>\r\n                  </div>\r\n                  <p>A structure for restoring the flow.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this method to suppress the flow of the Windows identity when the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> migrates across asynchronous threads.  </p>\n<p> Use the <a class=\"xref\" href=\"system.threading.asyncflowcontrol#System_Threading_AsyncFlowControl_Undo_\" data-linktype=\"relative-path\">Undo</a> method on the returned <a class=\"xref\" href=\"system.threading.asyncflowcontrol\" data-linktype=\"relative-path\">AsyncFlowControl</a> structure to return the <a class=\"xref\" href=\"system.security.securitycontext\" data-linktype=\"relative-path\">SecurityContext</a> object to its previous state.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The common language runtime (CLR) is aware of impersonation operations performed using only managed code, not of impersonation performed outside of managed code, such as through platform invoke to unmanaged code or through direct calls to Win32 functions. Only managed <a class=\"xref\" href=\"system.security.principal.windowsidentity\" data-linktype=\"relative-path\">WindowsIdentity</a> objects can flow across asynchronous points, unless the <code>alwaysFlowImpersonationPolicy</code> element has been set to <code>true</code> (<code>&lt;alwaysFlowImpersonationPolicy enabled=&quot;true&quot;/&gt;</code>). Setting the <code>alwaysFlowImpersonationPolicy</code> element to <code>true</code> specifies that the Windows identity always flows across asynchronous points, regardless of how impersonation was performed. For more information about flowing unmanaged impersonation across asynchronous points, see <a href=\"../Topic/%3CalwaysFlowImpersonationPolicy%3E%20Element.md\" data-linktype=\"relative-path\">&lt;alwaysFlowImpersonationPolicy&gt; Element</a>.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Security.SecurityContext.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Security.SecurityContext.yml\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.Capture\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.CreateCopy\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.Dispose\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.IsFlowSuppressed\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.IsWindowsIdentityFlowSuppressed\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.RestoreFlow\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.Run\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.SuppressFlow\">\r\n<meta name=\"APIName\" content=\"System.Security.SecurityContext.SuppressFlowWindowsIdentity\">\r\n<meta name=\"APILocation\" content=\"mscorlib.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"f04ae2b9-f8c7-dd83-cfad-67fd17ca9777\">\r\n<meta name=\"original_ecmaxml_local_path\" content=\"W:\\vejk\\s\\fulldocset\\xml\\System.Security\\SecurityContext.xml\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Encapsulates and propagates all security-related data for execution contexts transferred across threads. This class cannot be inherited.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Security/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Security.SecurityContext\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Security.SecurityContext.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Security.SecurityContext.yml","open_to_public_contributors":true,"api_name":["System.Security.SecurityContext","System.Security.SecurityContext.Capture","System.Security.SecurityContext.CreateCopy","System.Security.SecurityContext.Dispose","System.Security.SecurityContext.IsFlowSuppressed","System.Security.SecurityContext.IsWindowsIdentityFlowSuppressed","System.Security.SecurityContext.RestoreFlow","System.Security.SecurityContext.Run","System.Security.SecurityContext.SuppressFlow","System.Security.SecurityContext.SuppressFlowWindowsIdentity"],"api_location":["mscorlib.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Security.SecurityContext","System::Security::SecurityContext","System.Security.SecurityContext.Capture","System::Security::SecurityContext::Capture","System.Security.SecurityContext.CreateCopy","System::Security::SecurityContext::CreateCopy","System.Security.SecurityContext.Dispose","System::Security::SecurityContext::Dispose","System.Security.SecurityContext.IsFlowSuppressed","System::Security::SecurityContext::IsFlowSuppressed","System.Security.SecurityContext.IsWindowsIdentityFlowSuppressed","System::Security::SecurityContext::IsWindowsIdentityFlowSuppressed","System.Security.SecurityContext.RestoreFlow","System::Security::SecurityContext::RestoreFlow","System.Security.SecurityContext.Run","System::Security::SecurityContext::Run","System.Security.SecurityContext.SuppressFlow","System::Security::SecurityContext::SuppressFlow","System.Security.SecurityContext.SuppressFlowWindowsIdentity","System::Security::SecurityContext::SuppressFlowWindowsIdentity"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"f04ae2b9-f8c7-dd83-cfad-67fd17ca9777","original_ecmaxml_local_path":"W:\\vejk\\s\\fulldocset\\xml\\System.Security\\SecurityContext.xml","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Security/SecurityContext.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"SecurityContext class | Microsoft Docs","_op_ogTitle":"SecurityContext class","description":"Encapsulates and propagates all security-related data for execution contexts transferred across threads. This class cannot be inherited.\n","toc_asset_id":"_splitted/System.Security/toc.json","toc_rel":"_splitted/System.Security/toc.json","source_url":"","ms.assetid":"System.Security.SecurityContext","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.security.securitycontext","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.security.securitycontext","fileRelativePath":"System.Security.SecurityContext.html"},"themesRelativePathToOutputRoot":"_themes/"}