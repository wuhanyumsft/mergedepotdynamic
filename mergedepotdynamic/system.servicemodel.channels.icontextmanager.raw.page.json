{"content":"\r\n<div style=\"display:none\">\r\n\t\r\n</div>\r\n\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">IContextManager</span>\r\n      Interface\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Defines an interface that allows you to get and set the context on the channel.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">[System.Runtime.CompilerServices.TypeForwardedFrom(&quot;System.WorkflowServices, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;)]\npublic interface IContextManager</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>For channels that use <a class=\"xref\" href=\"system.servicemodel.wshttpcontextbinding\" data-linktype=\"relative-path\">WSHttpContextBinding</a> with the <a class=\"xref\" href=\"system.servicemodel.sessionmode\" data-linktype=\"relative-path\">SessionMode</a> value set, the context cannot be retrieved on the client using IContextManager because a new channel that establishes a session is created each time &lt;xref:System.ServiceModel.Channels.IChannelFactory.GetProperty%2A&gt; is called to enforce <a class=\"xref\" href=\"system.servicemodel.sessionmode\" data-linktype=\"relative-path\">SessionMode</a> semantics on a channel. This means that even though the context is properly propagated back to the client in this case, it cannot be retrieved using IContextManager. You can still retrieve it using <a class=\"xref\" href=\"system.servicemodel.channels.contextmessageproperty\" data-linktype=\"relative-path\">ContextMessageProperty</a> as shown in the following code.  </p>\n<pre><code class=\"lang-c#\">using (new OperationContextScope((IContextChannel)channel))  \n{  \n    channel.MyChannel(&quot;Test&quot;);  \n    ContextMessageProperty context;  \n    if (ContextMessageProperty.TryGet(OperationContext.Current.IncomingMessageProperties, out context))  \n    {  \n        Console.WriteLine(context.Count);  \n    }  \n}  \n</code></pre>\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Channels_IContextManager_Enabled\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Enabled</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets or sets a value that indicates whether the context management is enabled.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public bool Enabled { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p><code>true</code> if the context is enabled; otherwise, <code>false</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>When context management is enabled the context channel caches the context in its lifetime. Context can be retrieved from the channel through the <code>IContextManager</code> channel property by calling <a class=\"xref\" href=\"system.servicemodel.channels.icontextmanager#System_ServiceModel_Channels_IContextManager_GetContext_\" data-linktype=\"relative-path\">GetContext</a> method on it. The channel can also be pre-initialized with context before being opened by calling the <a class=\"xref\" href=\"system.servicemodel.channels.icontextmanager#System_ServiceModel_Channels_IContextManager_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method on the channel property. Once the channel is initialized with context it cannot be reset.  </p>\n<p> The following are invariants in this mode:  </p>\n<ul>\n<li><p>Any call to <a class=\"xref\" href=\"system.servicemodel.channels.icontextmanager#System_ServiceModel_Channels_IContextManager_SetContext_\" data-linktype=\"relative-path\">SetContext</a> after the channel is open throws an <code>InvalidOperationException</code>.  </p>\n</li>\n<li><p>Any attempt to send context through the <code>ContextMessageProperty</code> in an outgoing message throws <code>InvalidOperationException</code>.  </p>\n</li>\n<li><p>If a message is received from the server with context, when the channel is already initialized with a context a <code>ProtocolException</code> is thrown. Note that you can receive initial context from a server if the channel is opened without explicitly setting the context.  </p>\n</li>\n<li><p>The <code>ContextMessageProperty</code> on an incoming message is always <code>null</code>.  </p>\n<p>When context management is not enabled, the context channel does not manage context. It is the application&#39;s responsibility to retrieve, manage and apply context through the <code>ContextMessageProperty</code>. Any attempt to call <a class=\"xref\" href=\"system.servicemodel.channels.icontextmanager#System_ServiceModel_Channels_IContextManager_GetContext_\" data-linktype=\"relative-path\">GetContext</a> or <a class=\"xref\" href=\"system.servicemodel.channels.icontextmanager#System_ServiceModel_Channels_IContextManager_SetContext_\" data-linktype=\"relative-path\">SetContext</a> using through the <code>IContextManager</code> channel property results in <code>InvalidOperationException</code>.  </p>\n<p>All HTTP cookies, except for context HTTP cookies, are handled at the channel level. Context HTTP cookies are managed at the application level. This can have unexpected consequences when channels are shared to talk to different instances targeted by <a class=\"xref\" href=\"system.servicemodel.channels.contextmessageproperty\" data-linktype=\"relative-path\">ContextMessageProperty</a>. The following table shows how HTTP cookies are affected when Enabled is set to either <code>true</code> or <code>false</code>.  </p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Binding</th>\n<th>IContextManager.Enabled Value</th>\n<th>Context HTTP Cookie Scope</th>\n<th>Other HTTP Cookies Scope</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>BasicHttpBinding</td>\n<td>n/a</td>\n<td>ChannelFactory</td>\n<td>ChannelFactory</td>\n</tr>\n<tr>\n<td>BasicHttpContextBinding</td>\n<td>true</td>\n<td>Channel</td>\n<td>Channel</td>\n</tr>\n<tr>\n<td>BasicHttpContextBinding</td>\n<td>false</td>\n<td>For each message (explicitly managed by application)</td>\n<td>Channel</td>\n</tr>\n</tbody>\n</table>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t  \r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Channels_IContextManager_GetContext\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">GetContext()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets the context.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Collections.Generic.IDictionary&lt;string,string&gt; GetContext ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.generic.idictionary-2\" data-linktype=\"relative-path\">IDictionary</a>&lt;<a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>,<a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>&gt;</span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <span class=\"xref\">stem.Collections.Generic.IDictionary`2</span> of key/value pairs with the namespace and name of the context.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Channels_IContextManager_SetContext_System_Collections_Generic_IDictionary_System_String_System_String__\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">SetContext(IDictionary&lt;String,String&gt;)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Sets the context.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public void SetContext (System.Collections.Generic.IDictionary&lt;string,string&gt; context);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>context</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.generic.idictionary-2\" data-linktype=\"relative-path\">IDictionary</a>&lt;<a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>,<a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a>&gt;</span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <span class=\"xref\">stem.Collections.Generic.IDictionary`2</span> of key/value pairs with the namespace and name of the context that is set.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t  \r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.ServiceModel.Channels.IContextManager.yml\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Channels.IContextManager\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Channels.IContextManager.Enabled\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Channels.IContextManager.GetContext\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Channels.IContextManager.SetContext\">\r\n<meta name=\"APILocation\" content=\"System.WorkflowServices.dll\">\r\n<meta name=\"APILocation\" content=\"System.ServiceModel.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-20 09:40 AM\">\r\n<meta name=\"document_id\" content=\"e95b02ce-9bcb-ae6e-413e-b3396abed3f3\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Defines an interface that allows you to get and set the context on the channel.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.ServiceModel.Channels/toc.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.ServiceModel.Channels.IContextManager\">\r\n","rawMetadata":{"author":"dotnet-bot","breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.ServiceModel.Channels.IContextManager.yml","open_to_public_contributors":true,"api_name":["System.ServiceModel.Channels.IContextManager","System.ServiceModel.Channels.IContextManager.Enabled","System.ServiceModel.Channels.IContextManager.GetContext","System.ServiceModel.Channels.IContextManager.SetContext"],"api_location":["System.WorkflowServices.dll","System.ServiceModel.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.ServiceModel.Channels.IContextManager","System::ServiceModel::Channels::IContextManager","System.ServiceModel.Channels.IContextManager.Enabled","System::ServiceModel::Channels::IContextManager::Enabled","System.ServiceModel.Channels.IContextManager.GetContext","System::ServiceModel::Channels::IContextManager::GetContext","System.ServiceModel.Channels.IContextManager.SetContext","System::ServiceModel::Channels::IContextManager::SetContext"],"dev_langs":["csharp"],"updated_at":"2017-03-20 09:40 AM","document_id":"e95b02ce-9bcb-ae6e-413e-b3396abed3f3","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.ServiceModel.Channels/IContextManager.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"IContextManager interface | Microsoft Docs","_op_ogTitle":"IContextManager interface","description":"Defines an interface that allows you to get and set the context on the channel.\n","toc_asset_id":"_splitted/System.ServiceModel.Channels/toc.json","toc_rel":"_splitted/System.ServiceModel.Channels/toc.json","source_url":"","ms.assetid":"System.ServiceModel.Channels.IContextManager","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.servicemodel.channels.icontextmanager","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.servicemodel.channels.icontextmanager","fileRelativePath":"System.ServiceModel.Channels.IContextManager.html"},"themesRelativePathToOutputRoot":"_themes/"}