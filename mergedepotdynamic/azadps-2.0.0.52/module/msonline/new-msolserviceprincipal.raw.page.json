{"content":"\r\n<h1 id=\"azadps_2_0_0_52_MSOnline_New_MsolServicePrincipal_md\">New-MsolServicePrincipal</h1>\r\n\r\n\r\n\t<div class=\"summary\">Adds a service principal to Azure Active Directory.</div>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax\"><code class=\"lang-powershell\" dir=\"ltr\">New-MsolServicePrincipal [-AccountEnabled &lt;Boolean&gt;] [-Addresses &lt;RedirectUri[]&gt;] [-AppPrincipalId &lt;Guid&gt;]\r\n -DisplayName &lt;String&gt; [-EndDate &lt;DateTime&gt;] [-ServicePrincipalNames &lt;String[]&gt;] [-StartDate &lt;DateTime&gt;]\r\n [-TenantId &lt;Guid&gt;] [-Type &lt;ServicePrincipalCredentialType&gt;] [-Usage &lt;ServicePrincipalCredentialUsage&gt;]\r\n [-Value &lt;String&gt;] [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>New-MsolServicePrincipal</strong> cmdlet creates a service principal that can be used to represent a Line Of Business (LOB) application or an on-premises server such as Microsoft Exchange, SharePoint or Lync in Microsoft Azure Active Directory as service principal objects.\nAdding a new application as a service principal allows that application to authenticate to other services such as Microsoft Office 365.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Create a service principal</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> New-MsolServicePrincipal -ServicePrincipalNames @(\"MyApp/myApp.com\") -DisplayName \"My Application\"</code></pre>\r\n\t<p>This command creates a service principal.\nIn this example, the service principal is created with the service principal name MyApp/myApp.com, the display name My Application, and will use an auto-generated 256 bit symmetric key to verify the application.\nThis key will be valid for a year from today.</p>\n\r\n\t<p><strong>Example 2: Create a service principal that uses an X509 certificate</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> $cer = New-Object System.Security.Cryptography.X509Certificates.X509Certificate\r\nPS C:\\> $cer.Import(\"C:\\temp\\myapp.cer\")\r\nPS C:\\> $binCert = $cer.GetRawCertData()\r\nPS C:\\> $credValue = [System.Convert]::ToBase64String($binCert);\r\nPS C:\\> New-MsolServicePrincipal -ServicePrincipalNames @(\"MyApp/myApp.com\") -DisplayName \"My Application\" -Type asymmetric -Value $credValue</code></pre>\r\n\t<p>This example creates a service principal.\nIn this example, the service principal is created with the service principal name MyApp/myApp.com, the display name My Application, and uses the supplied X509 certificate myapp.cer that is configured with a base 64 encoded asymmetric key.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-AccountEnabled</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies whether the account needs to be enabled.\nThe default value is $True.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Boolean</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>True</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Addresses</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the of addresses used by the application.\nUse the <a href=\"new-msolserviceprincipaladdresses\" data-linktype=\"relative-path\">New-MsolServicePrincipalAddresses</a> cmdlet to help create the Addresses list object.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>RedirectUri[]</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-AppPrincipalId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the unique application ID for a service principal in a tenant.\nOnce created, this property cannot be changed.\nIf you do not specify this parameter, the application ID is generated.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-DisplayName</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies a display name of the service principal.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-EndDate</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the effective end date of the credential usage.\nThe default end date value is one year from today.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>DateTime</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Today + 1 year</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-ServicePrincipalNames</div>\r\n\t<div class=\"parameterSummary\"><p>A list of service principal names (SPNs) associated with the service principal.<br><br>An SPN must be unique per company tenant and is used by an application to uniquely identify itself.\nBy default, the service principal <strong>AppID</strong> is always added as an SPN.\nAn SPN must use one of the following formats:</p>\n<ul>\n<li><code>appName</code></li>\n<li><code>appName/hostname</code></li>\n<li>a valid URL<br><br>AppName represents the name of the application and hostname represents the URI authority for the application.\nWhen the service principal represents a WS-Federation relying party, an SPN can be set to a URL that would be treated as the WS-Federation wtrealm parameter.<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String[]</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>AppId of the service principal</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-StartDate</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the effective start date of the credential usage.\nThe default start date value is today.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>DateTime</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Today</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-TenantId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the unique ID of the tenant on which to perform the operation.\nThe default value is the tenant of the current user.\nThis parameter applies only to partner users.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Type</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the type of credential to use.\nValid values are: asymmetric, symmetric, and password.</p>\n<ul>\n<li>If asymmetric, the <em>Value</em> parameter must be set to the public portion of a base 64 encoded X509 certificate.</li>\n<li>If symmetric, a 256 bit AES symmetric key will be generated if <em>Value</em> is not set.</li>\n<li>If password, the <em>Value</em> parameter must be specified and it should not be base 64 encoded.<br><br>The default setting is &quot;symmetric&quot;.<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>ServicePrincipalCredentialType</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Symmetric</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Usage</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the usage of the credential key.\nThe credential key usage can either be set to sign or verify a token.\nThe default setting is verify.<br><br>Sign is allowed ONLY for symmetric keys.\nVerify is allowed for all key types.<br><br>A verify credential key is required by Azure Active Directory to verify that the request token was sent by your application, represented by this service principal.\nYour application may optionally require that Azure Active Directory issue tokens to your application signed by using your signing key rather than the asymmetric public key identifying Azure Active Directory.\nIn this case, provide a sign credential key for your service principal.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>ServicePrincipalCredentialUsage</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Verify</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Value</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the value of the credential.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"outputs\">Outputs</h2>\r\n\t\t<p><strong>Microsoft.Online.Administration.ServicePrincipalExtended</strong></p>\r\n\tThis cmdlet returns the service principal that it added. This includes the following information:<br><br>* ObjectId. The unique identifier of the service principal.\r\n* AppPrincipalId. The application identifier of the service principal.\r\n* DisplayName. The friendly name of the service principal.\r\n* ServicePrincipalName. The list of service principal names (SPNs) associated with the service principal.\r\n* TrustedForDelegation. The value indicating if the service principal is allowed for delegation.\r\n* AccountEnabled. The value indicating if the account is enabled.<br><br>It also retrieves the list of credentials that were added.\r\nEach credential object contains the following information:<br><br>* Type. The type of service principal credential (Asymmetric/Symmetric/Other).\r\n* Value. The value of the credential.\r\nIf the credential type is certificate, this represents the base 64 encoded certificate.\r\nIf credential type is symmetric, it represents an AES key.\r\n* KeyGroupId. The identifier reserved for internal use.\r\n* KeyId. The unique identifier of the key.\r\n* StartDate. The effective start date of the credential usage.\r\n* EndDate. The effective end date of the credential usage.\r\n* Usage. Specifies if the credential is used to sign or verify a token.\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"./get-msolserviceprincipal\" data-linktype=\"relative-path\">Get-MsolServicePrincipal</a></li>\r\n\t<li><a href=\"./new-msolserviceprincipaladdresses\" data-linktype=\"relative-path\">New-MsolServicePrincipalAddresses</a></li>\r\n\t<li><a href=\"./remove-msolserviceprincipal\" data-linktype=\"relative-path\">Remove-MsolServicePrincipal</a></li>\r\n\t<li><a href=\"./set-msolserviceprincipal\" data-linktype=\"relative-path\">Set-MsolServicePrincipal</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Adds a service principal to Azure Active Directory.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azadps/2.0.0.52/MSOnline/New-MsolServicePrincipal.md\">\r\n<meta name=\"document_id\" content=\"c78cc984-a756-f918-6b3e-62834b1e2293\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.Online.Administration.Automation.PSModule.dll-Help.xml\">\r\n<meta name=\"online_version\" content=\"\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"ms.assetid\" content=\"90C7E9B8-165A-4628-8399-F71F371FBB42\">\r\n<meta name=\"updated_at\" content=\"11/15/2016 05:11 AM\">\r\n<meta name=\"ms.date\" content=\"11/15/2016\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell-azuread/blob/master/Azure%20AD%20Cmdlets/MSOnline/v1/New-MsolServicePrincipal.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell-azuread/blob/2fc7c934766545163d747d78fd2431e341b5bd4f\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc.json\">\r\n","rawMetadata":{"commandList":[],"description":"Adds a service principal to Azure Active Directory.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azadps/2.0.0.52/MSOnline/New-MsolServicePrincipal.md","document_id":"c78cc984-a756-f918-6b3e-62834b1e2293","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"New-MsolServicePrincipal | Microsoft Docs","_op_ogTitle":"New-MsolServicePrincipal","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/msonline/new-msolserviceprincipal","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/msonline/new-msolserviceprincipal","external_help_file":"Microsoft.Online.Administration.Automation.PSModule.dll-Help.xml","online_version":"","schema":"2.0.0","ms.assetid":"90C7E9B8-165A-4628-8399-F71F371FBB42","updated_at":"11/15/2016 05:11 AM","ms.date":"11/15/2016","content_git_url":"https://github.com/Azure/azure-docs-powershell-azuread/blob/master/Azure%20AD%20Cmdlets/MSOnline/v1/New-MsolServicePrincipal.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell-azuread/blob/master/Azure%20AD%20Cmdlets/MSOnline/v1/New-MsolServicePrincipal.md","gitcommit":"https://github.com/Azure/azure-docs-powershell-azuread/blob/2fc7c934766545163d747d78fd2431e341b5bd4f","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azadps-2.0.0.52/module/toc.json","toc_rel":"../toc.json","fileRelativePath":"azadps-2.0.0.52/module/MSOnline/New-MsolServicePrincipal.html"},"themesRelativePathToOutputRoot":"_themes/"}