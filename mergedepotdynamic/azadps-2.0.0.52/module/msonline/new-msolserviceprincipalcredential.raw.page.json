{"content":"\r\n<h1 id=\"azadps_2_0_0_52_MSOnline_New_MsolServicePrincipalCredential_md\">New-MsolServicePrincipalCredential</h1>\r\n\r\n\r\n\t<div class=\"summary\">Add a credential key to a service principal.</div>\r\n\r\n<nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n  <h3>In this Article</h3>\r\n</nav>\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax loading\"><code class=\"lang-powershell\" dir=\"ltr\">New-MsolServicePrincipalCredential -AppPrincipalId &lt;Guid&gt; [-EndDate &lt;DateTime&gt;] [-StartDate &lt;DateTime&gt;]\r\n [-TenantId &lt;Guid&gt;] [-Type &lt;ServicePrincipalCredentialType&gt;] [-Usage &lt;ServicePrincipalCredentialUsage&gt;]\r\n [-Value &lt;String&gt;] [&lt;CommonParameters&gt;]</code></pre>\r\n\t\t<pre class=\"syntax loading\"><code class=\"lang-powershell\" dir=\"ltr\">New-MsolServicePrincipalCredential [-EndDate &lt;DateTime&gt;] -ObjectId &lt;Guid&gt; [-StartDate &lt;DateTime&gt;]\r\n [-TenantId &lt;Guid&gt;] [-Type &lt;ServicePrincipalCredentialType&gt;] [-Usage &lt;ServicePrincipalCredentialUsage&gt;]\r\n [-Value &lt;String&gt;] [&lt;CommonParameters&gt;]</code></pre>\r\n\t\t<pre class=\"syntax loading\"><code class=\"lang-powershell\" dir=\"ltr\">New-MsolServicePrincipalCredential [-EndDate &lt;DateTime&gt;] -ServicePrincipalName &lt;String&gt; [-StartDate &lt;DateTime&gt;]\r\n [-TenantId &lt;Guid&gt;] [-Type &lt;ServicePrincipalCredentialType&gt;] [-Usage &lt;ServicePrincipalCredentialUsage&gt;]\r\n [-Value &lt;String&gt;] [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>New-MsolServicePrincipalCredential</strong> cmdlet adds a new credential to a service principal or adds or rolls credential keys for an application.\nThe service principal is identified by supplying either the object ID, app principal ID, or service principal name (SPN).</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Add a credential to a service principal</strong></p>\r\n\t\r\n\t<pre class=\"loading\"><code class=\"lang-powershell\">PS C:\\> New-MsolServicePrincipalCredential -ServicePrincipalName \"MyApp/myApp.com\"</code></pre>\r\n\t<p>This command adds a credential, or a key, object to an existing service principal.\nIn this example, a symmetric key is generated for this credential and added to the service principal using the service principal name value of MyApp/myApp.com.</p>\n\r\n\t<p><strong>Example 2: Add an existing credential to a service principal</strong></p>\r\n\t\r\n\t<pre class=\"loading\"><code class=\"lang-powershell\">PS C:\\> $Certificate = New-Object System.Security.Cryptography.X509Certificates.X509Certificate\r\nPS C:\\> $Certificate.Import(\"C:\\myapp.cer\")\r\nPS C:\\> $BinCert = $Certificate.GetRawCertData()\r\nPS C:\\> $CredValue = [System.Convert]::ToBase64String($binCert);\r\nPS C:\\> New-MsolServicePrincipalCredential -ServicePrincipalName \"MyApp/myApp.com\" -Type asymmetric -Value $CredValue -StartDate $Certificate.GetEffectiveDateString() -EndDate $Certificate.GetExpirationDateString()</code></pre>\r\n\t<p>This example adds a credential, or a key, object to an existing service principal.\nIn this example, the supplied base64 encoded public X509 certificate, named myapp.cer, is added to the service principal using the service principal name value of MyApp/myApp.com.</p>\n\r\n\t<p><strong>Example 3: Register an on-premises Exchange Server</strong></p>\r\n\t\r\n\t<pre class=\"loading\"><code class=\"lang-powershell\">PS C:\\> New-MsolServicePrincipalCredential -AppPrincipalId  -Type asymmetric -Value $CredValue</code></pre>\r\n\t<p>This command registers an on-premises Exchange Server so that communications between the Exchange Server and Microsoft Azure Active Directory services such as Office 365 can occur.\nThis example assumes that $credValue contains the base64 encoded public X509 certificate used to represent the on-premises Exchange server.\nThe well known IDs for Office 365 servers are:<br><br>* Exchange: 00000002-0000-0ff1-ce00-000000000000</p>\n<ul>\n<li>SharePoint: 00000003-0000-0ff1-ce00-000000000000</li>\n<li>Lync: 00000004-0000-0ff1-ce00-000000000000</li>\n</ul>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-AppPrincipalId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the application ID of the service principal to which to add the credential.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-EndDate</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the effective end date of the credential usage.\nThe default value is one year from today.\nFor an asymmetric type credential, this must be set to on or before the date that the X509 certificate is valid until, otherwise an OAuth token will not be issued for this application.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>DateTime</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Today + 1 year</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-ObjectId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the unique object ID of the service principal to which to add the credential.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-ServicePrincipalName</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the name of the service principal to which to add the credential.\nAn SPN must use one of the following formats:<br><br>* <code>appName</code></p>\n<ul>\n<li><code>appName/hostname</code></li>\n<li>a valid URL<br><br>AppName represents the name of the application.\nHostname represents the URI authority for the application.<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-StartDate</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the effective start date of the credential usage.\nThe default value is today.\nFor an asymmetric type credential, this must be set to on or after the date that the X509 certificate is valid from, otherwise an OAuth token will not be issued for this application.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>DateTime</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Today</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-TenantId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the unique ID of the tenant on which to perform the operation.\nThe default value is the tenant of the current user.\nThis parameter applies only to partner users.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Type</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the type of credential used.\nValid values are:<br><br>* asymmetric</p>\n<ul>\n<li>symmetric</li>\n<li>password<br><br>The default value is symmetric.<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>ServicePrincipalCredentialType</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Symmetric</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Usage</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the usage of the credential key.\nThe credential key usage can either be set to sign or verify a token.\nThe default value is verify.\nSign is allowed ONLY for symmetric keys.\nVerify is allowed for all key types.<br><br>A verify credential key is required by the Azure Active Directory directory to verify that the request token was sent by your application, which is represented by this service principal.<br><br>Your application may optionally require that Azure Active Directory services issue tokens to your application signed with your signing key rather than the asymmetric public key identifying Microsoft Azure Active Directory.\nIn this case, provide a sign credential key for your service principal.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>ServicePrincipalCredentialUsage</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>Verify</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Value</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the value of the credential.<br><br>* If the credential type is asymmetric, the value represents the base 64 encoded certificate.</p>\n<ul>\n<li>If the credential type is symmetric and the <em>Value</em> parameter is not specified, a 256 bit AES key is automatically created and valid for one year from creation.</li>\n<li>If the credential type is password, specify <em>Value</em>.\nIt should not be base 64 encoded.<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"./get-msolserviceprincipalcredential\">Get-MsolServicePrincipalCredential</a></li>\r\n\t<li><a href=\"./remove-msolserviceprincipalcredential\">Remove-MsolServicePrincipalCredential</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Add a credential key to a service principal.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azadps/2.0.0.52/MSOnline/New-MsolServicePrincipalCredential.md\">\r\n<meta name=\"document_id\" content=\"e8eb7dbc-d310-0655-5152-aa93e76be9ea\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.Online.Administration.Automation.PSModule.dll-Help.xml\">\r\n<meta name=\"online_version\" content=\"\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"ms.assetid\" content=\"67573FFF-F6B6-4681-A96C-05BB5874F9FB\">\r\n<meta name=\"updated_at\" content=\"11/09/2016 06:11 AM\">\r\n<meta name=\"ms.date\" content=\"11/09/2016\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell-azuread/blob/master/Azure%20AD%20Cmdlets/MSOnline/v1/New-MsolServicePrincipalCredential.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell-azuread/blob/1f9ce90a071efd51795186ba3f8b8d76905a96c3\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc2.json\">\r\n","rawMetadata":{"commandList":[],"description":"Add a credential key to a service principal.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azadps/2.0.0.52/MSOnline/New-MsolServicePrincipalCredential.md","document_id":"e8eb7dbc-d310-0655-5152-aa93e76be9ea","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"New-MsolServicePrincipalCredential | Microsoft Docs","_op_ogTitle":"New-MsolServicePrincipalCredential","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/msonline/new-msolserviceprincipalcredential","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/msonline/new-msolserviceprincipalcredential","external_help_file":"Microsoft.Online.Administration.Automation.PSModule.dll-Help.xml","online_version":"","schema":"2.0.0","ms.assetid":"67573FFF-F6B6-4681-A96C-05BB5874F9FB","updated_at":"11/09/2016 06:11 AM","ms.date":"11/09/2016","content_git_url":"https://github.com/Azure/azure-docs-powershell-azuread/blob/master/Azure%20AD%20Cmdlets/MSOnline/v1/New-MsolServicePrincipalCredential.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell-azuread/blob/master/Azure%20AD%20Cmdlets/MSOnline/v1/New-MsolServicePrincipalCredential.md","gitcommit":"https://github.com/Azure/azure-docs-powershell-azuread/blob/1f9ce90a071efd51795186ba3f8b8d76905a96c3","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azadps-2.0.0.52/module/toc.json","toc_rel":"../toc.json","_op_displayDate":"2016-11-9","_op_displayDate_source":"2016-11-09T00:00:00Z","fileRelativePath":"azadps-2.0.0.52/module/MSOnline/New-MsolServicePrincipalCredential.html"},"themesRelativePathToOutputRoot":"_themes/"}