{"content":"    \r\n    <h1 id=\"System_Xml_XmlSecureResolver\">\r\n      <span class=\"lang-csharp\">XmlSecureResolver</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Helps to secure another implementation of <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> by wrapping the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> object and restricting the resources that the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> has access to.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class XmlSecureResolver : System.Xml.XmlResolver</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a>\r\n          </div>\r\n        </li>\r\n        <li class=\"l1\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">System.Xml.XmlResolver</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l2\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">XmlSecureResolver</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.xml.xmlresolver#System_Xml_XmlResolver_SupportsType_System_Uri_System_Type_\" data-linktype=\"relative-path\">SupportsType(Uri,Type)</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>The <a class=\"xref\" href=\"system.xml.xmlurlresolver\" data-linktype=\"relative-path\">XmlUrlResolver</a> class is the default resolver for all classes in the <a class=\"xref\" href=\"system.xml\" data-linktype=\"relative-path\">System.Xml</a> namespace. It is used to load XML documents and to resolve external resources such as entities, DTDs or schemas, and import or include directives.  </p>\n<p> You can override this default by specifying the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> object to use. For example, if you want to restrict the resources that the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> can access, you can use an XmlSecureResolver object.  </p>\n<p> XmlSecureResolver wraps around a concrete implementation of <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and restricts the resources that the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> has access to. For example, XmlSecureResolver has the ability to prohibit cross-domain redirection, which occurs from an embedded Uniform Resource Identifier (URI) reference.  </p>\n<p> When you construct an XmlSecureResolver object, you provide a valid <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> implementation along with a URL, an instance of an evidence object, or a permission set, which is used by the XmlSecureResolver to determine security. Either a <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">System.Security.PermissionSet</a> is generated or the existing one is used and <a class=\"xref\" href=\"system.security.permissionset#System_Security_PermissionSet_PermitOnly_\" data-linktype=\"relative-path\">PermitOnly</a> is called on it to help secure the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> XmlSecureResolver objects can contain sensitive information such as user credentials. You should be careful when caching XmlSecureResolver objects and should not pass the XmlSecureResolver object to an untrusted component.  </p>\n</div>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> There are differences in the security infrastructure for code running on the .NET Framework common language runtime (CLR) and for code running on the CLR that is integrated within Microsoft SQL Server 2005. This can lead to cases where code developed for the .NET Framework CLR operates differently when used on the SQL Server integrated CLR. One of these differences affects the XmlSecureResolver class when you have evidence that is based on a URL (that is, when you use the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver_CreateEvidenceForUrl_System_String_\" data-linktype=\"relative-path\">CreateEvidenceForUrl(String)</a> method or the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver__ctor_\" data-linktype=\"relative-path\">XmlSecureResolver</a> constructor). The policy resolution mechanism of the SQL Server integrated CLR does not use the <a class=\"xref\" href=\"system.security.policy.url\" data-linktype=\"relative-path\">Url</a> or <a class=\"xref\" href=\"system.security.policy.zone\" data-linktype=\"relative-path\">Zone</a> information. Instead, it grants permissions based on the GUID that the server adds when assemblies are loaded. When you use the XmlSecureResolver in the SQL Server integrated CLR, provide any required evidence directly by using a specified <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a>.  </p>\n</div>\n<h2 id=\"to-use-a-secure-resolver\">To use a secure resolver</h2>\n<ol>\n<li><p>Create an XmlSecureResolver with the correct permission set.  </p>\n</li>\n<li><p>Create an <a class=\"xref\" href=\"system.xml.xmlreadersettings\" data-linktype=\"relative-path\">XmlReaderSettings</a> object that uses the XmlSecureResolver object.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#5a\">Dim settings As New XmlReaderSettings()\nsettings.XmlResolver = myResolver\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#5a\">XmlReaderSettings settings = new XmlReaderSettings();\nsettings.XmlResolver = myResolver;\n</code></pre></li>\n<li><p>Pass  the <a class=\"xref\" href=\"system.xml.xmlreadersettings\" data-linktype=\"relative-path\">XmlReaderSettings</a> object to the <a class=\"xref\" href=\"system.xml.xmlreader#System_Xml_XmlReader_Create_\" data-linktype=\"relative-path\">Create</a> method when you&#39;re creating the <a class=\"xref\" href=\"system.xml.xmlreader\" data-linktype=\"relative-path\">XmlReader</a> object.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#5b\">Dim reader As XmlReader = XmlReader.Create(&quot;books.xml&quot;, settings)   \n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#5b\">XmlReader reader = XmlReader.Create(&quot;books.xml&quot;, settings);\n</code></pre></li>\n</ol>\n<h2 id=\"to-restrict-access-by-using-a-url\">To restrict access by using a URL</h2>\n<p> Use the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_String_\" data-linktype=\"relative-path\">XmlSecureResolver(XmlResolver,String)</a> constructor to create an XmlSecureResolver object that is allowed to access your local intranet site only.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#3\">Dim myResolver As New XmlSecureResolver(New XmlUrlResolver(), &quot;http://myLocalSite/&quot;) \n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#3\">XmlSecureResolver myResolver = new XmlSecureResolver(new XmlUrlResolver(), &quot;http://myLocalSite/&quot;);\n</code></pre><h2 id=\"to-restrict-access-by-using-a-permission-set\">To restrict access by using a permission set</h2>\n<ol>\n<li><p>Create a <a class=\"xref\" href=\"system.net.webpermission\" data-linktype=\"relative-path\">WebPermission</a> object.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#4a\">Dim myWebPermission As New WebPermission(PermissionState.None)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#4a\">WebPermission myWebPermission = new WebPermission(PermissionState.None);\n</code></pre></li>\n<li><p>Specify the URLs that you want to allow access to.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#4b\">myWebPermission.AddPermission(NetworkAccess.Connect, &quot;http://www.contoso.com/&quot;)\nmyWebPermission.AddPermission(NetworkAccess.Connect, &quot;http://litwareinc.com/data/&quot;)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#4b\">myWebPermission.AddPermission(NetworkAccess.Connect,&quot;http://www.contoso.com/&quot;);\nmyWebPermission.AddPermission(NetworkAccess.Connect,&quot;http://litwareinc.com/data/&quot;);\n</code></pre></li>\n<li><p>Add the web permissions to the <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> object.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#4c\">Dim myPermissions As New PermissionSet(PermissionState.None)\nmyPermissions.AddPermission(myWebPermission)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#4c\">PermissionSet myPermissions = new PermissionSet(PermissionState.None);\nmyPermissions.AddPermission(myWebPermission);\n</code></pre></li>\n<li><p>Use the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_Security_PermissionSet_\" data-linktype=\"relative-path\">XmlSecureResolver(XmlResolver,PermissionSet)</a> constructor to create an XmlSecureResolver object by using the permission set.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#4d\">Dim myResolver As New XmlSecureResolver(New XmlUrlResolver(), myPermissions)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#4d\">XmlSecureResolver myResolver = new XmlSecureResolver(new XmlUrlResolver(), myPermissions);\n</code></pre><p> See the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver__ctor_\" data-linktype=\"relative-path\">XmlSecureResolver</a> reference page for another example.  </p>\n</li>\n</ol>\n<h2 id=\"to-restrict-access-by-using-evidence\">To restrict access by using evidence</h2>\n<p> You can restrict access by using the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_Security_Policy_Evidence_\" data-linktype=\"relative-path\">XmlSecureResolver(XmlResolver,Evidence)</a> constructor and specifying <a class=\"xref\" href=\"system.security.policy.evidence\" data-linktype=\"relative-path\">Evidence</a>. The <a class=\"xref\" href=\"system.security.policy.evidence\" data-linktype=\"relative-path\">Evidence</a> is used to create the <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> that is applied to the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. The XmlSecureResolver calls <a class=\"xref\" href=\"system.security.permissionset#System_Security_PermissionSet_PermitOnly_\" data-linktype=\"relative-path\">PermitOnly</a> on the created <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> before opening any resources.  </p>\n<p> Here are some common scenarios and the type of evidence to provide for each:  </p>\n<ul>\n<li><p>If you are working in a fully trusted environment, use your assembly to create the evidence:  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#1\">Dim myEvidence As Evidence = Me.GetType().Assembly.Evidence\nDim myResolver As XmlSecureResolver\nmyResolver = New XmlSecureResolver(New XmlUrlResolver(), myEvidence)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#1\">Evidence myEvidence = this.GetType().Assembly.Evidence;\nXmlSecureResolver myResolver;\nmyResolver = new XmlSecureResolver(new XmlUrlResolver(), myEvidence);\n</code></pre></li>\n<li><p>If you are working in a semi-trusted environment, you have code or data coming from an outside source, and you know the origin of the outside source and have a verifiable URI, use the URI to create the evidence:  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#2\">Dim myEvidence As Evidence = XmlSecureResolver.CreateEvidenceForUrl(sourceURI)\nDim myResolver As New XmlSecureResolver(New XmlUrlResolver(), myEvidence)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#2\">\nEvidence myEvidence = XmlSecureResolver.CreateEvidenceForUrl(sourceURI);\nXmlSecureResolver myResolver = new XmlSecureResolver(new XmlUrlResolver(), myEvidence);\n</code></pre></li>\n<li><p>If you are working in a semi-trusted environment and you have code or data coming from an outside source, but you don&#39;t know the origin of the outside source, either:  </p>\n<p> Set the <code>evidence</code> parameter to <code>null</code>. This allows no access to resources.  </p>\n<p> -or-  </p>\n<p> If your application requires some access to resources, request evidence from the caller.  </p>\n</li>\n</ul>\n<h2 id=\"to-use-the-secure-resolver-to-load-an-xslt-style-sheet\">To use the secure resolver to load an XSLT style sheet</h2>\n<ol>\n<li><p>Create an XmlSecureResolver with the correct permission set.  </p>\n</li>\n<li><p>Pass the XmlSecureResolver to the <a class=\"xref\" href=\"system.xml.xsl.xslcompiledtransform#System_Xml_Xsl_XslCompiledTransform_Load_\" data-linktype=\"relative-path\">Load</a> method.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#6\">Dim xslt As New XslCompiledTransform()\nxslt.Load(&quot;http://serverName/data/xsl/sort.xsl&quot;, Nothing, myResolver)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#6\">XslCompiledTransform xslt = new XslCompiledTransform();\nxslt.Load(&quot;http://serverName/data/xsl/sort.xsl&quot;, null, myResolver);\n</code></pre></li>\n</ol>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_Security_PermissionSet_\" data-linktype=\"self-bookmark\">XmlSecureResolver(XmlResolver,PermissionSet)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class with the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> specified.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_Security_Policy_Evidence_\" data-linktype=\"self-bookmark\">XmlSecureResolver(XmlResolver,Evidence)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class with the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and <a class=\"xref\" href=\"system.security.policy.evidence\" data-linktype=\"relative-path\">Evidence</a> specified.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_String_\" data-linktype=\"self-bookmark\">XmlSecureResolver(XmlResolver,String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class with the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and URL provided.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver_Credentials\" data-linktype=\"self-bookmark\">Credentials</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Sets credentials used to authenticate web requests.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver_CreateEvidenceForUrl_System_String_\" data-linktype=\"self-bookmark\">CreateEvidenceForUrl(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates evidence using the supplied URL.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver_GetEntity_System_Uri_System_String_System_Type_\" data-linktype=\"self-bookmark\">GetEntity(Uri,String,Type)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Maps a URI to an object that contains the actual resource. This method temporarily sets the <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> created in the constructor by calling <span class=\"xref\">stem.Security.PermissionSet.PermitOnly*</span> before calling <code>GetEntity</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> to open the resource.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver_GetEntityAsync_System_Uri_System_String_System_Type_\" data-linktype=\"self-bookmark\">GetEntityAsync(Uri,String,Type)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Asynchronously maps a URI to an object that contains the actual resource.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XmlSecureResolver_ResolveUri_System_Uri_System_String_\" data-linktype=\"self-bookmark\">ResolveUri(Uri,String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Resolves the absolute URI from the base and relative URIs by calling <code>ResolveUri</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_Security_PermissionSet_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">XmlSecureResolver(XmlResolver,PermissionSet)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class with the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> specified.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public XmlSecureResolver (System.Xml.XmlResolver resolver, System.Security.PermissionSet permissionSet);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>resolver</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">System.Xml.XmlResolver</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The XML resolver that is wrapped by the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>permissionSet</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The permission set to apply to the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. The <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> calls the <span class=\"xref\">stem.Security.PermissionSet.PermitOnly*</span> method on the permission set before calling the <span class=\"xref\">stem.Xml.XmlSecureResolver.GetEntity*</span> method on the underlying XML resolver.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example constructs an <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> object by using a customized permission set.  </p>\n<pre><code class=\"lang-cs\" name=\"XmlSecureResolver.cctor#1\">\n   public static Object GetFile (String fileURL, XmlResolver resolver) {\n    \n     // Generate the default PermissionSet using the file URL.\n     Evidence evidence = XmlSecureResolver.CreateEvidenceForUrl(fileURL);\n     PermissionSet myPermissions = SecurityManager.ResolvePolicy(evidence);\n\n     // Modify the PermissionSet to only allow access to http://www.contoso.com.\n     // Create a WebPermission which only allows access to http://www.contoso.com.\n     WebPermission myWebPermission = new WebPermission(NetworkAccess.Connect, &quot;http://www.contoso.com&quot;);\n     // Replace the existing WebPermission in myPermissions with the updated WebPermission.\n     myPermissions.SetPermission(myWebPermission);\n\n     // Use the modified PermissionSet to construct the XmlSecureResolver.\n     XmlSecureResolver sResolver = new XmlSecureResolver(resolver, myPermissions);\n\n     // Get the object.\n     Uri fullUri = sResolver.ResolveUri(null, fileURL);\n     return sResolver.GetEntity(fullUri, null, null);\n   } \n</code></pre><pre><code class=\"lang-cpp\" name=\"XmlSecureResolver.cctor#1\">Object^ GetFile( String^ fileURL, XmlResolver^ resolver )\n{\n   // Generate the default PermissionSet using the file URL.\n   Evidence^ evidence = XmlSecureResolver::CreateEvidenceForUrl( fileURL );\n   PermissionSet^ myPermissions = SecurityManager::ResolvePolicy( evidence );\n   \n   // Modify the PermissionSet to only allow access to http://www.contoso.com.\n   // Create a WebPermission which only allows access to http://www.contoso.com.\n   WebPermission^ myWebPermission = gcnew WebPermission(\n      NetworkAccess::Connect,&quot;http://www.contoso.com&quot; );\n   // Replace the existing WebPermission in myPermissions with the updated WebPermission.\n   myPermissions-&gt;SetPermission( myWebPermission );\n   \n   // Use the modified PermissionSet to construct the XmlSecureResolver.\n   XmlSecureResolver^ sResolver = gcnew XmlSecureResolver( resolver,myPermissions );\n   \n   // Get the object.\n   Uri^ fullUri = sResolver-&gt;ResolveUri( nullptr, fileURL );\n   return sResolver-&gt;GetEntity( fullUri, nullptr, nullptr );\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"XmlSecureResolver.cctor#1\">\n   public shared function GetFile (fileURL as String , resolver as XmlResolver) as Object\n    \n     &#39;  Generate the default PermissionSet using the file URL.\n     Dim evidence as Evidence = XmlSecureResolver.CreateEvidenceForUrl(fileURL)\n     Dim myPermissions as PermissionSet = SecurityManager.ResolvePolicy(evidence)\n\n     &#39;  Modify the PermissionSet to only allow access to http://www.contoso.com.\n     &#39;  Create a WebPermission that only allows access to http://www.contoso.com.\n     Dim myWebPermission as WebPermission = new WebPermission(NetworkAccess.Connect, &quot;http://www.contoso.com&quot;)\n     &#39;  Replace the existing WebPermission in myPermissions with the updated WebPermission.\n     myPermissions.SetPermission(myWebPermission)\n\n     &#39;  Use the modified PermissionSet to construct the XmlSecureResolver.\n     Dim sResolver as XmlSecureResolver = new XmlSecureResolver(resolver, myPermissions)\n\n     &#39;  Get the object.\n     Dim fullUri as Uri = sResolver.ResolveUri(nothing, fileURL)\n     return sResolver.GetEntity(fullUri, nothing, nothing)\n   end function \n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_Security_Policy_Evidence_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">XmlSecureResolver(XmlResolver,Evidence)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class with the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and <a class=\"xref\" href=\"system.security.policy.evidence\" data-linktype=\"relative-path\">Evidence</a> specified.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public XmlSecureResolver (System.Xml.XmlResolver resolver, System.Security.Policy.Evidence evidence);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>resolver</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">System.Xml.XmlResolver</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The XML resolver that is wrapped by the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>evidence</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.policy.evidence\" data-linktype=\"relative-path\">Evidence</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The evidence used to create the <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> that will be applied to the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. The <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> calls the <span class=\"xref\">stem.Security.PermissionSet.PermitOnly*</span> method on the created <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> before calling <span class=\"xref\">stem.Xml.XmlSecureResolver.GetEntity*</span> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Here are some possible scenarios and the type of evidence to provide for each scenario:  </p>\n<ul>\n<li><p>If you are working in a fully trusted environment, use your assembly to create the evidence:  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#1\">Dim myEvidence As Evidence = Me.GetType().Assembly.Evidence\nDim myResolver As XmlSecureResolver\nmyResolver = New XmlSecureResolver(New XmlUrlResolver(), myEvidence)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#1\">Evidence myEvidence = this.GetType().Assembly.Evidence;\nXmlSecureResolver myResolver;\nmyResolver = new XmlSecureResolver(new XmlUrlResolver(), myEvidence);\n</code></pre></li>\n<li><p>If you are working in a semi-trusted environment, you have code or data coming from an outside source, and you know the origin of the outside source and have a verifiable URI, use the URI to create the evidence:  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#2\">Dim myEvidence As Evidence = XmlSecureResolver.CreateEvidenceForUrl(sourceURI)\nDim myResolver As New XmlSecureResolver(New XmlUrlResolver(), myEvidence)\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#2\">\nEvidence myEvidence = XmlSecureResolver.CreateEvidenceForUrl(sourceURI);\nXmlSecureResolver myResolver = new XmlSecureResolver(new XmlUrlResolver(), myEvidence);\n</code></pre></li>\n<li><p>If you are working in a semi-trusted environment and you have code or data coming from an outside source, but you don&#39;t know the origin of the outside source, either:  </p>\n<p> Set the <code>evidence</code> parameter to <code>null</code>. This allows no access to resources.  </p>\n<p> -or-  </p>\n<p> If your application requires some access to resources, request evidence from the caller.</p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_String_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">XmlSecureResolver(XmlResolver,String)</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class with the <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> and URL provided.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public XmlSecureResolver (System.Xml.XmlResolver resolver, string securityUrl);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>resolver</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">System.Xml.XmlResolver</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The XML resolver that is wrapped by the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>securityUrl</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The URL used to create the <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> that will be applied to the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. The <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> calls <span class=\"xref\">stem.Security.PermissionSet.PermitOnly*</span> on the created <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> before calling <span class=\"xref\">stem.Xml.XmlSecureResolver.GetEntity*</span> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <div class=\"IMPORTANT\"><h5>Important</h5><p> There are differences in the security infrastructure for code running on the .NET Framework common language runtime (CLR) and for code running on the CLR that is integrated within Microsoft SQL Server 2005. This can lead to cases where code developed for the .NET Framework CLR operates differently when used on the SQL Server integrated CLR. One of these differences affects the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class when you have evidence that is based on a URL (that is, when you use the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver_CreateEvidenceForUrl_\" data-linktype=\"relative-path\">CreateEvidenceForUrl</a> method or the XmlSecureResolver constructor). The policy resolution mechanism of the SQL Server integrated CLR does not use the <a class=\"xref\" href=\"system.security.policy.url\" data-linktype=\"relative-path\">Url</a> or <a class=\"xref\" href=\"system.security.policy.zone\" data-linktype=\"relative-path\">Zone</a> information. Instead, it grants permissions based on the GUID that the server adds when assemblies are loaded. When you use the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> in the SQL Server integrated CLR, provide any required evidence directly by using a specified <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a>.</p>\n</div>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>This example uses the XmlSecureResolver constructor to create an <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> object that is allowed to access your local intranet site only.  </p>\n<pre><code class=\"lang-vb\" name=\"XmlSecureResolver_Samples#3\">Dim myResolver As New XmlSecureResolver(New XmlUrlResolver(), &quot;http://myLocalSite/&quot;) \n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver_Samples#3\">XmlSecureResolver myResolver = new XmlSecureResolver(new XmlUrlResolver(), &quot;http://myLocalSite/&quot;);\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver_Credentials\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver_Credentials_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Credentials</div>        \r\n          </div>\r\n    \r\n            <p>Sets credentials used to authenticate web requests.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override System.Net.ICredentials Credentials { set; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.net.icredentials\" data-linktype=\"relative-path\">ICredentials</a></div>\r\n                  </div>\r\n                  <p>The credentials to be used to authenticate web requests. The <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> sets the given credentials on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. If this property is not set, the value defaults to <code>null</code>; that is, the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> has no user credentials.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example uses an <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> with default credentials to resolve and open network resources needed by the <a class=\"xref\" href=\"system.xml.xmltextreader\" data-linktype=\"relative-path\">XmlTextReader</a>.  </p>\n<pre><code class=\"lang-cpp\" name=\"XmlSecureResolver.Credentials#1\">#using &lt;System.dll&gt;\n#using &lt;System.Xml.dll&gt;\n\nusing namespace System;\nusing namespace System::IO;\nusing namespace System::Xml;\nusing namespace System::Net;\nint main()\n{\n   \n   // Create the reader.\n   XmlTextReader^ reader = gcnew XmlTextReader( &quot;http://myServer/data/books.xml&quot; );\n   \n   // Create a secure resolver with default credentials.\n   XmlUrlResolver^ resolver = gcnew XmlUrlResolver;\n   XmlSecureResolver^ sResolver = gcnew XmlSecureResolver( resolver,&quot;http://myServer/data/&quot; );\n   sResolver-&gt;Credentials = CredentialCache::DefaultCredentials;\n   \n   // Use the secure resolver to resolve resources.\n   reader-&gt;XmlResolver = sResolver;\n   \n   // Parse the file.\n   while ( reader-&gt;Read() )\n   {\n      \n      // Do any additional processing here.\n   }\n\n   \n   // Close the reader.\n   reader-&gt;Close();\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"XmlSecureResolver.Credentials#1\">Imports System\nImports System.IO\nImports System.Xml\nImports System.Net\n\npublic class Sample \n\n  public shared sub Main() \n\n    &#39; Create the reader.\n    Dim reader as XmlTextReader = new XmlTextReader(&quot;http://myServer/data/books.xml&quot;)\n   \n    &#39; Create a secure resolver with default credentials.\n    Dim resolver as XmlUrlResolver = new XmlUrlResolver()\n    Dim sResolver as XmlSecureResolver = new XmlSecureResolver(resolver, &quot;http://myServer/data/&quot;)\n    sResolver.Credentials = CredentialCache.DefaultCredentials\n\n    &#39; Use the secure resolver to resolve resources.\n    reader.XmlResolver = sResolver\n\n    &#39; Parse the file.\n    while (reader.Read()) \n       &#39; Do any additional processing here.\n    end while           \n  \n    &#39; Close the reader.\n    reader.Close()     \n  \n  end sub\nend class\n</code></pre><pre><code class=\"lang-cs\" name=\"XmlSecureResolver.Credentials#1\">using System;\nusing System.IO;\nusing System.Xml;\nusing System.Net;\n\npublic class Sample {\n\n  public static void Main() {\n\n    // Create the reader.\n    XmlTextReader reader = new XmlTextReader(&quot;http://myServer/data/books.xml&quot;);\n   \n    // Create a secure resolver with default credentials.\n    XmlUrlResolver resolver = new XmlUrlResolver();\n    XmlSecureResolver sResolver = new XmlSecureResolver(resolver, &quot;http://myServer/data/&quot;);\n    sResolver.Credentials = CredentialCache.DefaultCredentials;\n\n    // Use the secure resolver to resolve resources.\n    reader.XmlResolver = sResolver;\n\n    // Parse the file.\n    while (reader.Read()) {\n       // Do any additional processing here.\n    }           \n  \n    // Close the reader.\n    reader.Close();     \n  \n  }\n}\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver_CreateEvidenceForUrl_System_String_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver_CreateEvidenceForUrl_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CreateEvidenceForUrl(String)</div>        \r\n          </div>\r\n    \r\n            <p>Creates evidence using the supplied URL.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Security.Policy.Evidence CreateEvidenceForUrl (string securityUrl);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>securityUrl</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The URL used to create the evidence.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.policy.evidence\" data-linktype=\"relative-path\">Evidence</a></div>\r\n                  </div>\r\n                  <p>The evidence generated from the supplied URL as defined by the default policy.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <div class=\"IMPORTANT\"><h5>Important</h5><p> There are differences in the security infrastructure for code running on the .NET Framework common language runtime (CLR) and for code running on the CLR that is integrated within Microsoft SQL Server 2005. This can lead to cases where code developed for the .NET Framework CLR operates differently when used on the SQL Server integrated CLR. One of these differences affects the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> class when you have evidence that is based on a URL (that is, when you use the CreateEvidenceForUrl method or the <a class=\"xref\" href=\"system.xml.xmlsecureresolver#System_Xml_XmlSecureResolver__ctor_System_Xml_XmlResolver_System_String_\" data-linktype=\"relative-path\">XmlSecureResolver(XmlResolver,String)</a> constructor). The policy resolution mechanism of the SQL Server integrated CLR doesn&#39;t use the <a class=\"xref\" href=\"system.security.policy.url\" data-linktype=\"relative-path\">Url</a> or <a class=\"xref\" href=\"system.security.policy.zone\" data-linktype=\"relative-path\">Zone</a> information. Instead, it grants permissions based on the GUID that the server adds when assemblies are loaded. When you use the <a class=\"xref\" href=\"system.xml.xmlsecureresolver\" data-linktype=\"relative-path\">XmlSecureResolver</a> in the SQL Server integrated CLR, provide any required evidence directly by using a specified <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a>.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver_GetEntity_System_Uri_System_String_System_Type_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver_GetEntity_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetEntity(Uri,String,Type)</div>        \r\n          </div>\r\n    \r\n            <p>Maps a URI to an object that contains the actual resource. This method temporarily sets the <a class=\"xref\" href=\"system.security.permissionset\" data-linktype=\"relative-path\">PermissionSet</a> created in the constructor by calling <span class=\"xref\">stem.Security.PermissionSet.PermitOnly*</span> before calling <code>GetEntity</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a> to open the resource.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override object GetEntity (Uri absoluteUri, string role, Type ofObjectToReturn);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>absoluteUri</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.uri\" data-linktype=\"relative-path\">Uri</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The URI that is returned from <span class=\"xref\">stem.Xml.XmlSecureResolver.ResolveUri*</span>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>role</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>Currently not used.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>ofObjectToReturn</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.type\" data-linktype=\"relative-path\">Type</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The type of object to return. The current version only returns <a class=\"xref\" href=\"system.io.stream\" data-linktype=\"relative-path\">Stream</a> objects.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></div>\r\n                  </div>\r\n                  <p>The stream returned by calling <code>GetEntity</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. If a type other than <a class=\"xref\" href=\"system.io.stream\" data-linktype=\"relative-path\">Stream</a> is specified, the method returns <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xmlexception\" data-linktype=\"relative-path\">XmlException</a></div>\r\n                  </div>\r\n                  <p><code>ofObjectToReturn</code> is neither <code>null</code> nor a <a class=\"xref\" href=\"system.io.stream\" data-linktype=\"relative-path\">Stream</a> type.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.uriformatexception\" data-linktype=\"relative-path\">UriFormatException</a></div>\r\n                  </div>\r\n                  <p>The specified URI is not an absolute URI.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.nullreferenceexception\" data-linktype=\"relative-path\">NullReferenceException</a></div>\r\n                  </div>\r\n                  <p><code>absoluteUri</code> is <code>null</code>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a></div>\r\n                  </div>\r\n                  <p>There is a runtime error (for example, an interrupted server connection).</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <div class=\"IMPORTANT\"><h5>Important</h5><p> Your application can mitigate memory denial of service threats to the GetEntity method by implementing an <a class=\"xref\" href=\"system.runtime.interopservices.comtypes.istream\" data-linktype=\"relative-path\">IStream</a> that limits the number of bytes read. This helps guard against situations where malicious code attempts to pass an infinite stream of bytes to the GetEntity method.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver_GetEntityAsync_System_Uri_System_String_System_Type_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver_GetEntityAsync_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">GetEntityAsync(Uri,String,Type)</div>        \r\n          </div>\r\n    \r\n            <p>Asynchronously maps a URI to an object that contains the actual resource.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override System.Threading.Tasks.Task&lt;object&gt; GetEntityAsync (Uri absoluteUri, string role, Type ofObjectToReturn);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>absoluteUri</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.uri\" data-linktype=\"relative-path\">Uri</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The URI returned from <span class=\"xref\">stem.Xml.XmlSecureResolver.ResolveUri*</span>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>role</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>Currently not used.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>ofObjectToReturn</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.type\" data-linktype=\"relative-path\">Type</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The type of object to return. The current version only returns <a class=\"xref\" href=\"system.io.stream\" data-linktype=\"relative-path\">Stream</a> objects.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.threading.tasks.task-1\" data-linktype=\"relative-path\">Task</a>&lt;<a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a>&gt;</div>\r\n                  </div>\r\n                  <p>The stream returned by calling <code>GetEntity</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>. If a type other than <a class=\"xref\" href=\"system.io.stream\" data-linktype=\"relative-path\">Stream</a> is specified, the method returns <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XmlSecureResolver_ResolveUri_System_Uri_System_String_\">\r\n    \r\n            <a id=\"System_Xml_XmlSecureResolver_ResolveUri_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ResolveUri(Uri,String)</div>        \r\n          </div>\r\n    \r\n            <p>Resolves the absolute URI from the base and relative URIs by calling <code>ResolveUri</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public override Uri ResolveUri (Uri baseUri, string relativeUri);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>baseUri</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.uri\" data-linktype=\"relative-path\">Uri</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The base URI used to resolve the relative URI.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>relativeUri</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The URI to resolve. The URI can be absolute or relative. If absolute, this value effectively replaces the <code>baseUri</code> value. If relative, it combines with the <code>baseUri</code> to make an absolute URI.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.uri\" data-linktype=\"relative-path\">Uri</a></div>\r\n                  </div>\r\n                  <p>The absolute URI or <code>null</code> if the relative URI cannot be resolved (returned by calling <code>ResolveUri</code> on the underlying <a class=\"xref\" href=\"system.xml.xmlresolver\" data-linktype=\"relative-path\">XmlResolver</a>).</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p><code>relativeUri</code> is <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Xml.XmlSecureResolver.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Xml.XmlSecureResolver.yml\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver..ctor\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver.CreateEvidenceForUrl\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver.Credentials\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver.GetEntity\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver.GetEntityAsync\">\r\n<meta name=\"APIName\" content=\"System.Xml.XmlSecureResolver.ResolveUri\">\r\n<meta name=\"APILocation\" content=\"System.Xml.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"296a6a21-dd77-a1da-1d9f-405acfabade2\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Helps to secure another implementation of  by wrapping the  object and restricting the resources that the underlying  has access to.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Xml/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Xml.XmlSecureResolver\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Xml.XmlSecureResolver.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Xml.XmlSecureResolver.yml","open_to_public_contributors":true,"api_name":["System.Xml.XmlSecureResolver","System.Xml.XmlSecureResolver..ctor","System.Xml.XmlSecureResolver.CreateEvidenceForUrl","System.Xml.XmlSecureResolver.Credentials","System.Xml.XmlSecureResolver.GetEntity","System.Xml.XmlSecureResolver.GetEntityAsync","System.Xml.XmlSecureResolver.ResolveUri"],"api_location":["System.Xml.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Xml.XmlSecureResolver","System::Xml::XmlSecureResolver","System.Xml.XmlSecureResolver.#ctor","System::Xml::XmlSecureResolver::#ctor","System.Xml.XmlSecureResolver.CreateEvidenceForUrl","System::Xml::XmlSecureResolver::CreateEvidenceForUrl","System.Xml.XmlSecureResolver.Credentials","System::Xml::XmlSecureResolver::Credentials","System.Xml.XmlSecureResolver.GetEntity","System::Xml::XmlSecureResolver::GetEntity","System.Xml.XmlSecureResolver.GetEntityAsync","System::Xml::XmlSecureResolver::GetEntityAsync","System.Xml.XmlSecureResolver.ResolveUri","System::Xml::XmlSecureResolver::ResolveUri"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"296a6a21-dd77-a1da-1d9f-405acfabade2","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Xml/XmlSecureResolver.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"XmlSecureResolver class | Microsoft Docs","_op_ogTitle":"XmlSecureResolver class","description":"Helps to secure another implementation of  by wrapping the  object and restricting the resources that the underlying  has access to.\n","toc_asset_id":"_splitted/System.Xml/toc.json","toc_rel":"_splitted/System.Xml/toc.json","source_url":"","ms.assetid":"System.Xml.XmlSecureResolver","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.xml.xmlsecureresolver","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.xml.xmlsecureresolver","fileRelativePath":"System.Xml.XmlSecureResolver.html"},"themesRelativePathToOutputRoot":"_themes/"}