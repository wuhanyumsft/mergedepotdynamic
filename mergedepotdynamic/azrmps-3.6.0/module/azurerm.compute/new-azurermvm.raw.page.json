{"content":"\r\n<h1 id=\"azrmps_3_6_0_AzureRM_Compute_New_AzureRmVM_md\">New-AzureRmVM</h1>\r\n\r\n\r\n\t<div class=\"summary\">Creates a virtual machine.</div>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax\"><code class=\"lang-powershell\" dir=\"ltr\">New-AzureRmVM [-ResourceGroupName] &lt;String&gt; [-Location] &lt;String&gt; [-VM] &lt;PSVirtualMachine&gt;\r\n [-DisableBginfoExtension] [-LicenseType &lt;String&gt;] [-Tags &lt;Hashtable&gt;] [-Confirm] [-WhatIf]\r\n [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>New-AzureRmVM</strong> cmdlet creates a virtual machine in Azure.\nThis cmdlet takes a virtual machine object as input.\nUse the New-AzureRmVMConfig cmdlet to create a virtual machine object.\nOther cmdlets can be used to configure the virtual machine, such as Set-AzureRmVMOperatingSystem, Set-AzureRmVMSourceImage, Add-AzureRmVMNetworkInterface, and Set-AzureRmVMOSDisk.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Create a virtual machine</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\># Variables    \r\n## Global\r\n$ResourceGroupName = \"ResourceGroup11\"\r\n$Location = \"WestEurope\"\r\n\r\n## Storage\r\n$StorageName = \"generalstorage6cc\"\r\n$StorageType = \"Standard_GRS\"\r\n\r\n## Network\r\n$InterfaceName = \"ServerInterface06\"\r\n$Subnet1Name = \"Subnet1\"\r\n$VNetName = \"VNet09\"\r\n$VNetAddressPrefix = \"10.0.0.0/16\"\r\n$VNetSubnetAddressPrefix = \"10.0.0.0/24\"\r\n\r\n## Compute\r\n$VMName = \"VirtualMachine12\"\r\n$ComputerName = \"Server22\"\r\n$VMSize = \"Standard_A2\"\r\n$OSDiskName = $VMName + \"OSDisk\"\r\n\r\n# Resource Group\r\nNew-AzureRmResourceGroup -Name $ResourceGroupName -Location $Location\r\n\r\n# Storage\r\n$StorageAccount = New-AzureRmStorageAccount -ResourceGroupName $ResourceGroupName -Name $StorageName -Type $StorageType -Location $Location\r\n\r\n# Network\r\n$PIp = New-AzureRmPublicIpAddress -Name $InterfaceName -ResourceGroupName $ResourceGroupName -Location $Location -AllocationMethod Dynamic\r\n$SubnetConfig = New-AzureRmVirtualNetworkSubnetConfig -Name $Subnet1Name -AddressPrefix $VNetSubnetAddressPrefix\r\n$VNet = New-AzureRmVirtualNetwork -Name $VNetName -ResourceGroupName $ResourceGroupName -Location $Location -AddressPrefix $VNetAddressPrefix -Subnet $SubnetConfig\r\n$Interface = New-AzureRmNetworkInterface -Name $InterfaceName -ResourceGroupName $ResourceGroupName -Location $Location -SubnetId $VNet.Subnets[0].Id -PublicIpAddressId $PIp.Id\r\n\r\n# Compute\r\n\r\n## Setup local VM object\r\n$Credential = Get-Credential\r\n$VirtualMachine = New-AzureRmVMConfig -VMName $VMName -VMSize $VMSize\r\n$VirtualMachine = Set-AzureRmVMOperatingSystem -VM $VirtualMachine -Windows -ComputerName $ComputerName -Credential $Credential -ProvisionVMAgent -EnableAutoUpdate\r\n$VirtualMachine = Set-AzureRmVMSourceImage -VM $VirtualMachine -PublisherName MicrosoftWindowsServer -Offer WindowsServer -Skus 2012-R2-Datacenter -Version \"latest\"\r\n$VirtualMachine = Add-AzureRmVMNetworkInterface -VM $VirtualMachine -Id $Interface.Id\r\n$OSDiskUri = $StorageAccount.PrimaryEndpoints.Blob.ToString() + \"vhds/\" + $OSDiskName + \".vhd\"\r\n$VirtualMachine = Set-AzureRmVMOSDisk -VM $VirtualMachine -Name $OSDiskName -VhdUri $OSDiskUri -CreateOption FromImage\r\n\r\n## Create the VM in Azure\r\nNew-AzureRmVM -ResourceGroupName $ResourceGroupName -Location $Location -VM $VirtualMachine</code></pre>\r\n\t<p>This example script shows how to create a virtual machine.\nThis script uses several other cmdlets.</p>\n\r\n\t<p><strong>Example 2: Create a virtual machine from a custom user image</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\>## VM Account\r\n# Credentials for Local Admin account you created in the sysprepped (generalized) vhd image\r\n$VMLocalAdminUser = \"LocalAdminUser\"\r\n$VMLocalAdminSecurePassword = ConvertTo-SecureString \"Password\" -AsPlainText -Force \r\n## Azure Account\r\n$LocationName = \"westus\"\r\n$ResourceGroupName = \"MyResourceGroup\"\r\n# This a Premium_LRS storage account. \r\n# It is required in order to run a client VM with efficiency and high performance.\r\n$StorageAccount = \"Mydisk\"\r\n\r\n## VM\r\n$OSDiskName = \"MyClient\"\r\n$ComputerName = \"MyClientVM\"\r\n$OSDiskUri = \"https://Mydisk.blob.core.windows.net/disks/MyOSDisk.vhd\"\r\n$SourceImageUri = \"https://Mydisk.blob.core.windows.net/vhds/MyOSImage.vhd\"\r\n$VMName = \"MyVM\"\r\n# Modern hardware environment with fast disk, high IOPs performance. \r\n# Required to run a client VM with efficiency and performance\r\n$VMSize = \"Standard_DS3\" \r\n$OSDiskCaching = \"ReadWrite\"\r\n$OSCreateOption = \"FromImage\"\r\n\r\n## Networking\r\n$DNSNameLabel = \"mydnsname\" # mydnsname.westus.cloudapp.azure.com\r\n$NetworkName = \"MyNet\"\r\n$NICName = \"MyNIC\"\r\n$PublicIPAddressName = \"MyPIP\"\r\n$SubnetName = \"MySubnet\"\r\n$SubnetAddressPrefix = \"10.0.0.0/24\"\r\n$VnetAddressPrefix = \"10.0.0.0/16\"\r\n\r\n$SingleSubnet = New-AzureRmVirtualNetworkSubnetConfig -Name $SubnetName -AddressPrefix $SubnetAddressPrefix\r\n$Vnet = New-AzureRmVirtualNetwork -Name $NetworkName -ResourceGroupName $ResourceGroupName -Location $LocationName -AddressPrefix $VnetAddressPrefix -Subnet $SingleSubnet\r\n$PIP = New-AzureRmPublicIpAddress -Name $PublicIPAddressName -DomainNameLabel $DNSNameLabel -ResourceGroupName $ResourceGroupName -Location $LocationName -AllocationMethod Dynamic\r\n$NIC = New-AzureRmNetworkInterface -Name $NICName -ResourceGroupName $ResourceGroupName -Location $LocationName -SubnetId $Vnet.Subnets[0].Id -PublicIpAddressId $PIP.Id\r\n\r\n$Crededntial = New-Object System.Management.Automation.PSCredential ($VMLocalAdminUser, $VMLocalAdminSecurePassword); \r\n\r\n$VirtualMachine = New-AzureRmVMConfig -VMName $VMName -VMSize $VMSize\r\n$VirtualMachine = Set-AzureRmVMOperatingSystem -VM $VirtualMachine -Windows -ComputerName $ComputerName -Credential $Credential -ProvisionVMAgent -EnableAutoUpdate\r\n$VirtualMachine = Add-AzureRmVMNetworkInterface -VM $VirtualMachine -Id $NIC.Id\r\n$VirtualMachine = Set-AzureRmVMOSDisk -VM $VirtualMachine -Name $OSDiskName -VhdUri $OSDiskUri -SourceImageUri $SourceImageUri -Caching $OSDiskCaching -CreateOption $OSCreateOption -Windows\r\n\r\nNew-AzureRmVM -ResourceGroupName $ResourceGroupName -Location $LocationName -VM $VirtualMachine -Verbose</code></pre>\r\n\t<p>This example takes an existing sys-prepped, generalized custom operating system image and attaches a data disk to it, provisions a new network, deploys the VHD, and runs it.<br><br>This script can be used for automatic provisioning because it uses the local virtual machine admin credentials inline instead of calling <strong>Get-Credential</strong> which requires user interaction.<br><br>This script assumes that you are already logged into your Azure account.\nYou can confirm your login status by using the <strong>Get-AzureSubscription</strong> cmdlet.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-DisableBginfoExtension</div>\r\n\t<div class=\"parameterSummary\"><p>Indicates that this cmdlet does not install the <strong>BG Info</strong> extension on the virtual machine.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>4</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-LicenseType</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies a license type, which indicates that the image or disk for the virtual machine was licensed on-premises.\nThis value is used only for images that contain the Windows Server operating system.\nThe acceptable values for this parameter are:<br><br>- Windows_Client </p>\n<ul>\n<li>Windows_Server<br><br>This value cannot be updated.\nIf you specify this parameter for an update, the value must match the initial value for the virtual machine.<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Location</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies a location for the virtual machine.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>2</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-ResourceGroupName</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the name of a resource group.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>1</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Tags</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies that resources and resource groups can be tagged with a set of name-value pairs.\nAdding tags to resources enables you to group resources together across resource groups and to create your own views.\nEach resource or resource group can have a maximum of 15 tags.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Hashtable</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-VM</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies a local virtual machine to create.\nTo obtain a virtual machine object, use the New-AzureRmVMConfig cmdlet.\nOther cmdlets can be used to configure the virtual machine, such as Set-AzureRmVMOperatingSystem, Set-AzureRmVMSourceImage, and Add-AzureRmVMNetworkInterface.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>PSVirtualMachine</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>VMProfile</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>3</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Confirm</div>\r\n\t<div class=\"parameterSummary\"><p>Prompts you for confirmation before running the cmdlet.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>cf</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-WhatIf</div>\r\n\t<div class=\"parameterSummary\"><p>Shows what would happen if the cmdlet runs.<br><br>The cmdlet is not run.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>wi</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"./get-azurermvm\">Get-AzureRmVM</a></li>\r\n\t<li><a href=\"./remove-azurermvm\">Remove-AzureRmVM</a></li>\r\n\t<li><a href=\"./restart-azurermvm\">Restart-AzureRmVM</a></li>\r\n\t<li><a href=\"./start-azurermvm\">Start-AzureRmVM</a></li>\r\n\t<li><a href=\"./stop-azurermvm\">Stop-AzureRmVM</a></li>\r\n\t<li><a href=\"./update-azurermvm\">Update-AzureRmVM</a></li>\r\n\t<li><a href=\"./add-azurermvmdatadisk\">Add-AzureRmVMDataDisk</a></li>\r\n\t<li><a href=\"./add-azurermvmnetworkinterface\">Add-AzureRmVMNetworkInterface</a></li>\r\n\t<li><a href=\"./new-azurermvmconfig\">New-AzureRmVMConfig</a></li>\r\n\t<li><a href=\"./set-azurermvmoperatingsystem\">Set-AzureRmVMOperatingSystem</a></li>\r\n\t<li><a href=\"./set-azurermvmsourceimage\">Set-AzureRmVMSourceImage</a></li>\r\n\t<li><a href=\"./set-azurermvmosdisk\">Set-AzureRmVMOSDisk</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Creates a virtual machine.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azrmps/3.6.0/AzureRM.Compute/New-AzureRmVM.md\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.Azure.Commands.Compute.dll-Help.xml\">\r\n<meta name=\"ms.assetid\" content=\"05E6155D-4F0E-406B-9312-77AD97EF66EE\">\r\n<meta name=\"online_version\" content=\"\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"updated_at\" content=\"03/11/2017 23:03 PM\">\r\n<meta name=\"ms.date\" content=\"03/11/2017\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell/blob/master/azureps-cmdlets-docs/ResourceManager/AzureRM.Compute/v2.7.0/New-AzureRmVM.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell/blob/bc71000aa3c7f754b95442dcc415a7324626a15c\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc2.json\">\r\n","rawMetadata":{"commandList":[],"description":"Creates a virtual machine.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azrmps/3.6.0/AzureRM.Compute/New-AzureRmVM.md","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"New-AzureRmVM | Microsoft Docs","_op_ogTitle":"New-AzureRmVM","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/azurerm.compute/new-azurermvm","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/azurerm.compute/new-azurermvm","external_help_file":"Microsoft.Azure.Commands.Compute.dll-Help.xml","ms.assetid":"05E6155D-4F0E-406B-9312-77AD97EF66EE","online_version":"","schema":"2.0.0","updated_at":"03/11/2017 23:03 PM","ms.date":"03/11/2017","content_git_url":"https://github.com/Azure/azure-docs-powershell/blob/master/azureps-cmdlets-docs/ResourceManager/AzureRM.Compute/v2.7.0/New-AzureRmVM.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell/blob/master/azureps-cmdlets-docs/ResourceManager/AzureRM.Compute/v2.7.0/New-AzureRmVM.md","gitcommit":"https://github.com/Azure/azure-docs-powershell/blob/bc71000aa3c7f754b95442dcc415a7324626a15c","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azrmps-3.6.0/module/toc.json","toc_rel":"../toc.json","fileRelativePath":"azrmps-3.6.0/module/AzureRM.Compute/New-AzureRmVM.html"},"themesRelativePathToOutputRoot":"_themes/"}