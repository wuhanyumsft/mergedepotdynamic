{"content":"    \r\n    <h1 id=\"System_Messaging_ActiveXMessageFormatter\">\r\n      <span class=\"lang-csharp\">ActiveXMessageFormatter</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Serializes or deserializes primitive data types and other objects to or from the body of a Message Queuing message, using a format that is compatible with the MSMQ ActiveX Component.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class ActiveXMessageFormatter : ICloneable, System.Messaging.IMessageFormatter</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">ActiveXMessageFormatter</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>The ActiveXMessageFormatter is compatible with messages sent using Message Queuing COM components, allowing interoperability with applications that use the MSMQ COM control.  </p>\n<p> The ActiveXMessageFormatter can serialize most primitives, as well as objects that implement the <code>IPersistStream</code> OLE interface. It can deserialize the same set of primitives, but requires further effort when deserializing a COM object (for example, an object created using Visual Basic 6.0) that implements <code>IPersistStream</code>. The object to deserialize must be in memory by first importing the object into a .NET Framework application.  </p>\n<p> When an application sends a message to the queue using an instance of the <a class=\"xref\" href=\"system.messaging.messagequeue\" data-linktype=\"relative-path\">MessageQueue</a> class, the formatter serializes the object into a stream and inserts it into the message body. When reading from a queue using a <a class=\"xref\" href=\"system.messaging.messagequeue\" data-linktype=\"relative-path\">MessageQueue</a>, the formatter deserializes the message data into the <a class=\"xref\" href=\"system.messaging.message#System_Messaging_Message_Body_\" data-linktype=\"relative-path\">Body</a> property of a <a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a>.  </p>\n<p> ActiveX serialization is very compact, which makes using the ActiveXMessageFormatter and MSMQ COM control a very fast method of serialization.</p>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Messaging_ActiveXMessageFormatter__ctor\" data-linktype=\"self-bookmark\">ActiveXMessageFormatter()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Messaging_ActiveXMessageFormatter_CanRead_System_Messaging_Message_\" data-linktype=\"self-bookmark\">CanRead(Message)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Determines whether the formatter can deserialize the contents of the message.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Messaging_ActiveXMessageFormatter_Clone\" data-linktype=\"self-bookmark\">Clone()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates an instance of the <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a> class that is identical to the current <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Messaging_ActiveXMessageFormatter_InitStreamedObject_System_Object_\" data-linktype=\"self-bookmark\">InitStreamedObject(Object)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Provides a utility to help serialize COM objects that implement <code>IPersistStream</code> and require <code>IPersistStreamInit</code> to be called.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Messaging_ActiveXMessageFormatter_Read_System_Messaging_Message_\" data-linktype=\"self-bookmark\">Read(Message)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Reads the contents from the given message and creates an object that contains the deserialized message.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Messaging_ActiveXMessageFormatter_Write_System_Messaging_Message_System_Object_\" data-linktype=\"self-bookmark\">Write(Message,Object)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Serializes an object into the body of the message.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Messaging_ActiveXMessageFormatter__ctor\">\r\n    \r\n            <a id=\"System_Messaging_ActiveXMessageFormatter__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ActiveXMessageFormatter()</div>        \r\n          </div>\r\n    \r\n            <p>Initializes a new instance of the <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public ActiveXMessageFormatter ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Messaging_ActiveXMessageFormatter_CanRead_System_Messaging_Message_\">\r\n    \r\n            <a id=\"System_Messaging_ActiveXMessageFormatter_CanRead_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CanRead(Message)</div>        \r\n          </div>\r\n    \r\n            <p>Determines whether the formatter can deserialize the contents of the message.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public bool CanRead (System.Messaging.Message message);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>message</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a> to inspect.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></div>\r\n                  </div>\r\n                  <p><code>true</code> if the <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a> can deserialize the message; otherwise, <code>false</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>message</code> parameter is <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>CanRead returns <code>false</code> if the message body is not a primitive that the Message Queuing ActiveX control can deserialize or if it does not implement the <code>IPersistStream</code> interface.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Messaging_ActiveXMessageFormatter_Clone\">\r\n    \r\n            <a id=\"System_Messaging_ActiveXMessageFormatter_Clone_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Clone()</div>        \r\n          </div>\r\n    \r\n            <p>Creates an instance of the <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a> class that is identical to the current <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public object Clone ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </div>\r\n                  <p>An object whose properties are identical to those of this <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method is used by the <a class=\"xref\" href=\"system.messaging.messagequeue\" data-linktype=\"relative-path\">MessageQueue</a> class in order to receive multiple messages at the same time (for example, if the application is receiving asynchronously). You typically do not need to call this method in your application code.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Messaging_ActiveXMessageFormatter_InitStreamedObject_System_Object_\">\r\n    \r\n            <a id=\"System_Messaging_ActiveXMessageFormatter_InitStreamedObject_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">InitStreamedObject(Object)</div>        \r\n          </div>\r\n    \r\n            <p>Provides a utility to help serialize COM objects that implement <code>IPersistStream</code> and require <code>IPersistStreamInit</code> to be called.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static void InitStreamedObject (object streamedObject);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>streamedObject</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An OLE object that implements <code>IPersistStreamInit</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Messaging_ActiveXMessageFormatter_Read_System_Messaging_Message_\">\r\n    \r\n            <a id=\"System_Messaging_ActiveXMessageFormatter_Read_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Read(Message)</div>        \r\n          </div>\r\n    \r\n            <p>Reads the contents from the given message and creates an object that contains the deserialized message.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public object Read (System.Messaging.Message message);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>message</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a>, in MSMQ ActiveX control format, to deserialize.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </div>\r\n                  <p>The deserialized message.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The <span class=\"xref\">stem.Messaging.Message.BodyType*</span> property of the <code>message</code> passed as a parameter cannot be mapped to a primitive type, nor does it represent a streamed object.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.notsupportedexception\" data-linktype=\"relative-path\">NotSupportedException</a></div>\r\n                  </div>\r\n                  <p>The body represents a stored object. The <a class=\"xref\" href=\"system.messaging.activexmessageformatter\" data-linktype=\"relative-path\">ActiveXMessageFormatter</a> does not support deserialization of stored objects.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>message</code> parameter is <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>If the body of the message represents a primitive type, the message&#39;s <a class=\"xref\" href=\"system.messaging.message#System_Messaging_Message_BodyType_\" data-linktype=\"relative-path\">BodyType</a> property must be one of the managed types in the following table.  </p>\n<table>\n<thead>\n<tr>\n<th>BodyType value</th>\n<th>Managed type</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>VT_LPSTR</td>\n<td><a class=\"xref\" href=\"system.char\" data-linktype=\"relative-path\">Char</a> array (deserialized using ASCII encoding)</td>\n</tr>\n<tr>\n<td>VT_BSTR, VT_LPWSTR</td>\n<td><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a> (deserialized using Unicode encoding)</td>\n</tr>\n<tr>\n<td>VT_VECTOR &#124; VT_UI1</td>\n<td><a class=\"xref\" href=\"system.byte\" data-linktype=\"relative-path\">Byte</a> array</td>\n</tr>\n<tr>\n<td>VT_BOOL</td>\n<td><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></td>\n</tr>\n<tr>\n<td>VT_CLSID</td>\n<td><a class=\"xref\" href=\"system.guid\" data-linktype=\"relative-path\">Guid</a></td>\n</tr>\n<tr>\n<td>VT_CY</td>\n<td><a class=\"xref\" href=\"system.decimal\" data-linktype=\"relative-path\">Decimal</a></td>\n</tr>\n<tr>\n<td>VT_DATE</td>\n<td><a class=\"xref\" href=\"system.datetime\" data-linktype=\"relative-path\">DateTime</a></td>\n</tr>\n<tr>\n<td>VT_I1, VT_UI1</td>\n<td><a class=\"xref\" href=\"system.byte\" data-linktype=\"relative-path\">Byte</a></td>\n</tr>\n<tr>\n<td>VT_I2</td>\n<td><a class=\"xref\" href=\"system.int16\" data-linktype=\"relative-path\">Int16</a></td>\n</tr>\n<tr>\n<td>VT_UI2</td>\n<td><a class=\"xref\" href=\"system.uint16\" data-linktype=\"relative-path\">UInt16</a></td>\n</tr>\n<tr>\n<td>VT_I4</td>\n<td><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></td>\n</tr>\n<tr>\n<td>VT_UI4</td>\n<td><a class=\"xref\" href=\"system.uint32\" data-linktype=\"relative-path\">UInt32</a></td>\n</tr>\n<tr>\n<td>VT_I8</td>\n<td><a class=\"xref\" href=\"system.int64\" data-linktype=\"relative-path\">Int64</a></td>\n</tr>\n<tr>\n<td>VT_UI8</td>\n<td><a class=\"xref\" href=\"system.uint64\" data-linktype=\"relative-path\">UInt64</a></td>\n</tr>\n<tr>\n<td>VT_R4</td>\n<td><a class=\"xref\" href=\"system.single\" data-linktype=\"relative-path\">Single</a></td>\n</tr>\n<tr>\n<td>VT_R8</td>\n<td><a class=\"xref\" href=\"system.double\" data-linktype=\"relative-path\">Double</a></td>\n</tr>\n<tr>\n<td>VT_NULL</td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td>VT_STREAMED_OBJECT</td>\n<td><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></td>\n</tr>\n</tbody>\n</table>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Messaging_ActiveXMessageFormatter_Write_System_Messaging_Message_System_Object_\">\r\n    \r\n            <a id=\"System_Messaging_ActiveXMessageFormatter_Write_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Write(Message,Object)</div>        \r\n          </div>\r\n    \r\n            <p>Serializes an object into the body of the message.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void Write (System.Messaging.Message message, object obj);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>message</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The <a class=\"xref\" href=\"system.messaging.message\" data-linktype=\"relative-path\">Message</a> whose <span class=\"xref\">stem.Messaging.Message.Body*</span> property will contain the serialized object.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>obj</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The object to be serialized into the message body.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The object to serialize is neither a primitive nor a streamed object that implements the OLE <code>IPersistStream</code> interface.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p>The <code>message</code> parameter is <code>null</code>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The following table shows the relationship between managed types and the <a class=\"xref\" href=\"system.messaging.message#System_Messaging_Message_BodyType_\" data-linktype=\"relative-path\">BodyType</a> property. The object that you serialize must be one of these managed types or must implement the OLE <code>IPersistStream</code> interface.  </p>\n<table>\n<thead>\n<tr>\n<th>BodyType value</th>\n<th>Managed type</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>VT_LPSTR</td>\n<td><a class=\"xref\" href=\"system.char\" data-linktype=\"relative-path\">Char</a></td>\n</tr>\n<tr>\n<td>VT_BSTR, VT_LPWSTR</td>\n<td><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></td>\n</tr>\n<tr>\n<td>VT_VECTOR &#124; VT_UI1</td>\n<td><a class=\"xref\" href=\"system.byte\" data-linktype=\"relative-path\">Byte</a></td>\n</tr>\n<tr>\n<td>VT_BOOL</td>\n<td><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></td>\n</tr>\n<tr>\n<td>VT_CLSID</td>\n<td><a class=\"xref\" href=\"system.guid\" data-linktype=\"relative-path\">Guid</a></td>\n</tr>\n<tr>\n<td>VT_CY</td>\n<td><a class=\"xref\" href=\"system.decimal\" data-linktype=\"relative-path\">Decimal</a></td>\n</tr>\n<tr>\n<td>VT_DATE</td>\n<td><a class=\"xref\" href=\"system.datetime\" data-linktype=\"relative-path\">DateTime</a></td>\n</tr>\n<tr>\n<td>VT_I1, VT_UI1</td>\n<td><a class=\"xref\" href=\"system.byte\" data-linktype=\"relative-path\">Byte</a></td>\n</tr>\n<tr>\n<td>VT_I2</td>\n<td><a class=\"xref\" href=\"system.int16\" data-linktype=\"relative-path\">Int16</a></td>\n</tr>\n<tr>\n<td>VT_UI2</td>\n<td><a class=\"xref\" href=\"system.uint16\" data-linktype=\"relative-path\">UInt16</a></td>\n</tr>\n<tr>\n<td>VT_I4</td>\n<td><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></td>\n</tr>\n<tr>\n<td>VT_UI4</td>\n<td><a class=\"xref\" href=\"system.uint32\" data-linktype=\"relative-path\">UInt32</a></td>\n</tr>\n<tr>\n<td>VT_I8</td>\n<td><a class=\"xref\" href=\"system.int64\" data-linktype=\"relative-path\">Int64</a></td>\n</tr>\n<tr>\n<td>VT_UI8</td>\n<td><a class=\"xref\" href=\"system.uint64\" data-linktype=\"relative-path\">UInt64</a></td>\n</tr>\n<tr>\n<td>VT_R4</td>\n<td><a class=\"xref\" href=\"system.single\" data-linktype=\"relative-path\">Single</a></td>\n</tr>\n<tr>\n<td>VT_R8</td>\n<td><a class=\"xref\" href=\"system.double\" data-linktype=\"relative-path\">Double</a></td>\n</tr>\n<tr>\n<td>VT_NULL</td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td>VT_STREAMED_OBJECT</td>\n<td><code>IPersistStream</code> (OLE) <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></td>\n</tr>\n</tbody>\n</table>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Messaging.ActiveXMessageFormatter.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Messaging.ActiveXMessageFormatter.yml\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter..ctor\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter.CanRead\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter.Clone\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter.InitStreamedObject\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter.Read\">\r\n<meta name=\"APIName\" content=\"System.Messaging.ActiveXMessageFormatter.Write\">\r\n<meta name=\"APILocation\" content=\"System.Messaging.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"b6c8940e-f9bf-9a36-8052-2a2ccebc6037\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Serializes or deserializes primitive data types and other objects to or from the body of a Message Queuing message, using a format that is compatible with the MSMQ ActiveX Component.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Messaging/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Messaging.ActiveXMessageFormatter\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Messaging.ActiveXMessageFormatter.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Messaging.ActiveXMessageFormatter.yml","open_to_public_contributors":true,"api_name":["System.Messaging.ActiveXMessageFormatter","System.Messaging.ActiveXMessageFormatter..ctor","System.Messaging.ActiveXMessageFormatter.CanRead","System.Messaging.ActiveXMessageFormatter.Clone","System.Messaging.ActiveXMessageFormatter.InitStreamedObject","System.Messaging.ActiveXMessageFormatter.Read","System.Messaging.ActiveXMessageFormatter.Write"],"api_location":["System.Messaging.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Messaging.ActiveXMessageFormatter","System::Messaging::ActiveXMessageFormatter","System.Messaging.ActiveXMessageFormatter.#ctor","System::Messaging::ActiveXMessageFormatter::#ctor","System.Messaging.ActiveXMessageFormatter.CanRead","System::Messaging::ActiveXMessageFormatter::CanRead","System.Messaging.ActiveXMessageFormatter.Clone","System::Messaging::ActiveXMessageFormatter::Clone","System.Messaging.ActiveXMessageFormatter.InitStreamedObject","System::Messaging::ActiveXMessageFormatter::InitStreamedObject","System.Messaging.ActiveXMessageFormatter.Read","System::Messaging::ActiveXMessageFormatter::Read","System.Messaging.ActiveXMessageFormatter.Write","System::Messaging::ActiveXMessageFormatter::Write"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"b6c8940e-f9bf-9a36-8052-2a2ccebc6037","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Messaging/ActiveXMessageFormatter.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ActiveXMessageFormatter class | Microsoft Docs","_op_ogTitle":"ActiveXMessageFormatter class","description":"Serializes or deserializes primitive data types and other objects to or from the body of a Message Queuing message, using a format that is compatible with the MSMQ ActiveX Component.\n","toc_asset_id":"_splitted/System.Messaging/toc.json","toc_rel":"_splitted/System.Messaging/toc.json","source_url":"","ms.assetid":"System.Messaging.ActiveXMessageFormatter","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.messaging.activexmessageformatter","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.messaging.activexmessageformatter","fileRelativePath":"System.Messaging.ActiveXMessageFormatter.html"},"themesRelativePathToOutputRoot":"_themes/"}