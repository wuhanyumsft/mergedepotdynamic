{"content":"\r\n<h1 id=\"azipps_1_3_155_2_AADRM_Set_AadrmOnboardingControlPolicy_md\">Set-AadrmOnboardingControlPolicy</h1>\r\n\r\n\r\n\t<div class=\"summary\">Sets the user on-boarding control policy for Rights Management.</div>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax\"><code class=\"lang-powershell\" dir=\"ltr\">Set-AadrmOnboardingControlPolicy [-Force] [-Scope &lt;OnboardingControlPolicyScope&gt;]\r\n [-SecurityGroupObjectId &lt;Guid&gt;] -UseRmsUserLicense &lt;Boolean&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>Set-AadrmOnboardingControlPolicy</strong> cmdlet sets the policy that controls user on-boarding for Azure Rights Management. This cmdlet supports a gradual deployment by controlling which users in your organization can protect content by using Azure Rights Management.<br><br>You must use PowerShell to set this configuration; you cannot do this configuration by using a management portal.<br><br>This control can be based on assigned user licenses for the service or membership in a designated security group.\nYou can also define whether the policy applies to just mobile devices, just Windows clients, or mobile devices and Windows clients.<br><br>If you use the assigned license option, you can assign licenses to users by using the Office 365 admin center or by using Azure PowerShell and the <a href=\"./set-msoluserlicense\" data-linktype=\"relative-path\">Set-MsolUserLicense</a> cmdlet from the Azure AD PowerShell administration module. You can also use the <a href=\"./get-msolaccountsku\" data-linktype=\"relative-path\">Get-MsolAccountSku</a> cmdlet to obtain the different types of licenses that you can assign in your organization.<br><br>If you use the group membership option, you must specify a security group, which does not have to be mail-enabled and it can contain other groups. To specify the group, use the group GUID. To obtain that GUID,  use the <a href=\"./get-msolgroup\" data-linktype=\"relative-path\">Get-MsolGroup</a> cmdlet from the Azure AD PowerShell administration module.<br><br>For more information about the Azure AD PowerShell cmdlets, see <a href=\"http://msdn.microsoft.com/library/azure/jj151815.aspx\" data-linktype=\"external\">Azure Active Directory Cmdlets</a> (<a href=\"http://msdn.microsoft.com/library/azure/jj151815.aspx\" data-linktype=\"external\">http://msdn.microsoft.com/library/azure/jj151815.aspx</a>).<br><br>Note: This cmdlet does not stop users from consuming protected content.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Restrict Azure RMS to users who have a license and are members of a specified group</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> Set-AadrmOnboardingControlPolicy -UseRmsUserLicense $True -SecurityGroupObjectId \"fba99fed-32a0-44e0-b032-37b419009501\" -Scope All</code></pre>\r\n\t<p>This command configures the Azure RMS service to allow only users who have a license to use Azure Rights Management to protect content. Further, the command requires users to be members of the security group with the specified object ID. The restriction applies to Windows clients and mobile devices.</p>\n\r\n\t<p><strong>Example 2: Restrict Azure RMS to users who are members of a specified group</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> Set-AadrmOnboardingControlPolicy -UseRmsUserLicense $False -SecurityGroupObjectId \"fba99fed-32a0-44e0-b032-37b419009501\" -Scope All</code></pre>\r\n\t<p>This command allows only users that are members of the security group with the specified object ID to protect content by using Azure Rights Management. The command applies to Windows clients and mobile devices.</p>\n\r\n\t<p><strong>Example 3: Restrict Azure RMS to users who have a license</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> Set-AadrmOnboardingControlPolicy -UseRmsUserLicense $True -Scope All</code></pre>\r\n\t<p>This command allows only users who have a  license assigned to protect content by using Azure Rights Management. The command applies to Windows clients and mobile devices.</p>\n\r\n\t<p><strong>Example 4: Do not restrict Azure RMS for users</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> Set-AadrmOnboardingControlPolicy -UseRmsUserLicense $False -Scope All</code></pre>\r\n\t<p>This command allows all users to protect content by using Azure Rights Management. The command applies to Windows clients and mobile devices.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-Force</div>\r\n\t<div class=\"parameterSummary\"><p>Indicates that this cmdlet configures the on-boarding control policy even if there is already an on-boarding control policy for the organization.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Scope</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the types of applications to which the on-boarding policy applies.<br><br>Valid values are:<br><br>- All</p>\n<ul>\n<li>WindowsApp</li>\n<li>MobileApp<br><br></li>\n</ul>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>OnboardingControlPolicyScope</td></tr>\r\n\t\t<tr><td>Parameter Sets:</td><td>All, WindowsApp, MobileApp</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-SecurityGroupObjectId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the object ID of a security group.<br><br>The specified group restricts which users can protect content by using Rights Management.If you also enable license enforcement, only users that have a license assigned and are members of this specified group can protect content by using Azure Rights Management.<br><br>You can use this parameter to implement a phased deployment of Azure Rights Management even if all users have a license assigned to them.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-UseRmsUserLicense</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies whether users without a license assigned to them can use Azure Rights Management to protect content. Users can always use Azure Rights Management to consume protected content regardless of this setting and their license assignment.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Boolean</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Confirm</div>\r\n\t<div class=\"parameterSummary\"><p>Prompts you for confirmation before running the cmdlet.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>cf</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-WhatIf</div>\r\n\t<div class=\"parameterSummary\"><p>Shows what would happen if the cmdlet runs.\nThe cmdlet is not run.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>wi</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"./get-aadrmonboardingcontrolpolicy\" data-linktype=\"relative-path\">Get-AadrmOnboardingControlPolicy</a></li>\r\n\t<li><a href=\"http://msdn.microsoft.com/library/azure/jj151815.aspx\" data-linktype=\"external\">Azure Active Directory Cmdlets</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Sets the user on-boarding control policy for Rights Management.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Set-AadrmOnboardingControlPolicy.md\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml\">\r\n<meta name=\"online_version\" content=\"http://go.microsoft.com/fwlink/?LinkId=521419\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"ms.assetid\" content=\"AC10D692-604D-40A3-94BE-AAA5008BF9D8\">\r\n<meta name=\"updated_at\" content=\"02/13/2017 05:02 AM\">\r\n<meta name=\"ms.date\" content=\"02/13/2017\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Set-AadrmOnboardingControlPolicy.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/e4c765ba645ee6c466dd1ff7182695aa9e59fb44\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc.json\">\r\n","rawMetadata":{"commandList":[],"description":"Sets the user on-boarding control policy for Rights Management.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Set-AadrmOnboardingControlPolicy.md","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"Set-AadrmOnboardingControlPolicy | Microsoft Docs","_op_ogTitle":"Set-AadrmOnboardingControlPolicy","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/set-aadrmonboardingcontrolpolicy","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/set-aadrmonboardingcontrolpolicy","external_help_file":"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml","online_version":"http://go.microsoft.com/fwlink/?LinkId=521419","schema":"2.0.0","ms.assetid":"AC10D692-604D-40A3-94BE-AAA5008BF9D8","updated_at":"02/13/2017 05:02 AM","ms.date":"02/13/2017","content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Set-AadrmOnboardingControlPolicy.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Set-AadrmOnboardingControlPolicy.md","gitcommit":"https://github.com/Azure/azure-docs-powershell-aip/blob/e4c765ba645ee6c466dd1ff7182695aa9e59fb44","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azipps-1.3.155.2/module/toc.json","toc_rel":"../toc.json","fileRelativePath":"azipps-1.3.155.2/module/AADRM/Set-AadrmOnboardingControlPolicy.html"},"themesRelativePathToOutputRoot":"_themes/"}