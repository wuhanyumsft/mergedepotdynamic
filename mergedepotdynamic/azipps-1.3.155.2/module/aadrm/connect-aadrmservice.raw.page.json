{"content":"\r\n<h1 id=\"azipps_1_3_155_2_AADRM_Connect_AadrmService_md\">Connect-AadrmService</h1>\r\n\r\n\r\n\t<div class=\"summary\">Connects to Rights Management.</div>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax\"><code class=\"lang-powershell\" dir=\"ltr\">Connect-AadrmService [-AccessToken &lt;String&gt;] [-TenantId &lt;Guid&gt;] [&lt;CommonParameters&gt;]</code></pre>\r\n\t\t<pre class=\"syntax\"><code class=\"lang-powershell\" dir=\"ltr\">Connect-AadrmService [-Credential &lt;PSCredential&gt;] [-TenantId &lt;Guid&gt;] [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>Connect-AadrmService</strong> cmdlet connects you to the Azure Rights Management service for your tenant so that you can then run administrative commands for this service. This cmdlet can also be used by a partner company that manages your tenant.<br><br>You must run this cmdlet before you can run the other Rights Management cmdlets in this module.<br><br>To connect to the Azure Rights Management service, use an account that is one of the following:</p>\n<ul>\n<li>A global admin for your Office 365 tenant.</li>\n<li>A global administrator for your Azure tenant. However, this account cannot be a Microsoft account (MSA) or from another Azure tenant.</li>\n<li>A user account from your tenant that has been granted administrative rights to Azure Rights Management by using the <a href=\"./Add-AadrmRoleBasedAdministrator\">Add-AadrmRoleBasedAdministrator</a> cmdlet.<br><br>Tip: If you are not prompted for your credentials, and you see an error message such as <strong>Cannot use this feature without credentials</strong>, verify that Internet Explorer is configured to use Windows integrated authentication. If this setting is not enabled, enable it, restart Internet Explorer, and then retry authentication to the Rights Management service.</li>\n</ul>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Connect to Azure RMS and be prompted for your user name and other credentials</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\> Connect-AadrmService</code></pre>\r\n\t<p>This command connects to the Rights Management service. This is the simplest way to connect to Azure Rights Management, by running the cmdlet with no parameters.<br><br>You are prompted for your user name and password. If your account is configured to use multi-factor authentication, you are then prompted for your alternative method of authentication, and then connected to the service.<br><br>If your account is configured to use multi-factor authentication, you must use this method to connect to Azure RMS.</p>\n\r\n\t<p><strong>Example 2: Connect to Azure RMS with stored credentials</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\>$AdminCredentials = Get-Credential \"Admin@aadrm.contoso.com\"\r\nPS C:\\> Connect-AadrmService -Credential $AdminCredentials</code></pre>\r\n\t<p>The first command creates a <strong>PSCredential</strong> object and stores your specified user name and password in the <strong>$AdminCredentials</strong> variable. When you run this command, you are prompted for the password for the user name that you specified.<br><br>The second command connects to the Rights Management service by using the credentials stored in <strong>$AdminCredentials</strong>. If you disconnect from the service and reconnect while the variable is still in use, simply rerun the second command.</p>\n\r\n\t<p><strong>Example 3: Connect to Azure RMS with a token</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\>[Reflection.Assembly]::LoadFile(\"C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\AADRM\\Microsoft.IdentityModel.Clients.ActiveDirectory.dll\")\r\nPS C:\\> $clientId='90f610bf-206d-4950-b61d-37fa6fd1b224';\r\nPS C:\\> $resourceId = 'https://api.aadrm.com/';\r\nPS C:\\> $clientId='90f610bf-206d-4950-b61d-37fa6fd1b224';\r\nPS C:\\> $userName='admin@contoso.com';\r\nPS C:\\> $password='Passw0rd!';\r\nPS C:\\> $redirectUri = new-object System.Uri(\"https://aadrm.com/AADRMAdminPowershell\");\r\nPS C:\\> $authority = \"https://login.microsoftonline.com/common\";\r\nPS C:\\> $authContext = New-Object Microsoft.IdentityModel.Clients.ActiveDirectory.AuthenticationContext($authority);\r\nPS C:\\> $userCreds = New-Object Microsoft.IdentityModel.Clients.ActiveDirectory.UserCredential($userName, $password);\r\nPS C:\\> $authenticationResult = $authContext.AcquireToken($resourceId,$clientId,$userCreds);\r\nPS C:\\> Import-module aadrm\r\nPS C:\\> Connect-Aadrmservice -AccessToken $authenticationResult.AccessToken</code></pre>\r\n\t<p>This example shows how you could connect to Azure RMS by using the <em>AccessToken</em> parameter, which lets you authenticate without a prompt. This connection method requires you to specify the client ID &#39;90f610bf-206d-4950-b61d-37fa6fd1b224&#39; and the resource ID &#39;<a href=\"https://api.aadrm.com/\">https://api.aadrm.com/</a>&#39;. After the connection is open, you can then run the Azure RMS administrative commands that you need.<br><br>After you confirm that these commands result in successfully connecting to the Azure RMS service, you could run them non-interactively, for example, from a script.<br><br>Note that for illustration purposes, this example uses the user name of &quot;admin@contoso.com&quot; with the password of &quot;Passw0rd!&quot;. In a production environment when you use this connection method non-interactively, use additional methods to secure the password so that it is not stored in clear text. For example, use the <strong>ConvertTo-SecureString</strong> command or use Key Vault to store the password as a secret.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-AccessToken</div>\r\n\t<div class=\"parameterSummary\"><p>Use this parameter to connect to Azure RMS by using a token that you acquire from Azure Active Directory, using the client ID &#39;90f610bf-206d-4950-b61d-37fa6fd1b224&#39; and the resource ID &#39;<a href=\"https://api.aadrm.com/\">https://api.aadrm.com/</a>&#39;. This connection method lets you sign in to the Azure RMS service non-interactively.<br><br>To get the access token, make sure that the account that you use from your tenant is not using multi-factor authentication (MFA). See Example 3 for how you might do this.<br><br>You cannot use this parameter with the <em>Credential</em> parameter.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Credential</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies a <strong>PSCredential</strong> object. To obtain a <strong>PSCredential</strong> object, use the <a href=\"http://go.microsoft.com/fwlink/?LinkID=293936\">Get-Credential</a> cmdlet. For more information, type <code>Get-Help Get-Cmdlet</code>.<br><br>The cmdlet prompts you for a password.<br><br>You cannot use this parameter with the <em>AccessToken</em> parameter and do not use it if your account is configured to use multi-factor authentication (MFA).<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>PSCredential</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-TenantId</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the tenant GUID.The cmdlet connects to Rights Management for the tenant that you specify by GUID.<br><br>If you do not specify this parameter, the cmdlet connects to the tenant that your account belongs to.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Guid</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"https://go.microsoft.com/fwlink/?LinkID=293936\">Get-Credential</a></li>\r\n\t<li><a href=\"./disconnect-aadrmservice\">Disconnect-AadrmService</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Connects to Rights Management.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Connect-AadrmService.md\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml\">\r\n<meta name=\"online_version\" content=\"https://go.microsoft.com/fwlink/?LinkId=400595\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"ms.assetid\" content=\"857D8EFC-9D6E-4756-A9A2-B90FF8E02A1F\">\r\n<meta name=\"updated_at\" content=\"02/13/2017 12:02 PM\">\r\n<meta name=\"ms.date\" content=\"02/13/2017\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Connect-AadrmService.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/6ca3a334d2d345bf1565d13869b0587b50bde3b6\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc2.json\">\r\n","rawMetadata":{"commandList":[],"description":"Connects to Rights Management.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Connect-AadrmService.md","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"Connect-AadrmService | Microsoft Docs","_op_ogTitle":"Connect-AadrmService","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/connect-aadrmservice","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/connect-aadrmservice","external_help_file":"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml","online_version":"https://go.microsoft.com/fwlink/?LinkId=400595","schema":"2.0.0","ms.assetid":"857D8EFC-9D6E-4756-A9A2-B90FF8E02A1F","updated_at":"02/13/2017 12:02 PM","ms.date":"02/13/2017","content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Connect-AadrmService.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Connect-AadrmService.md","gitcommit":"https://github.com/Azure/azure-docs-powershell-aip/blob/6ca3a334d2d345bf1565d13869b0587b50bde3b6","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azipps-1.3.155.2/module/toc.json","toc_rel":"../toc.json","fileRelativePath":"azipps-1.3.155.2/module/AADRM/Connect-AadrmService.html"},"themesRelativePathToOutputRoot":"_themes/"}