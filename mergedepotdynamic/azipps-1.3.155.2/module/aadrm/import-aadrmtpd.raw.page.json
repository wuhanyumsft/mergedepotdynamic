{"content":"\r\n<h1 id=\"azipps_1_3_155_2_AADRM_Import_AadrmTpd_md\">Import-AadrmTpd</h1>\r\n\r\n\r\n\t<div class=\"summary\">Imports a TPD from AD RMS for Rights Management.</div>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax\"><code class=\"lang-powershell\" dir=\"ltr\">Import-AadrmTpd -Active &lt;Boolean&gt; [-Force] [-HsmKeyFile &lt;String&gt;] [-KeyVaultKeyUrl &lt;String&gt;]\r\n -ProtectionPassword &lt;SecureString&gt; -TpdFile &lt;String&gt; [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>Import-AadrmTpd</strong> cmdlet imports an Active Directory Rights Management Services (AD RMS) trusted publishing domain (TPD) over the Internet into your tenant for Azure Rights Management so that you can migrate Rights Management from on-premises to the cloud.<br><br>You must use PowerShell to configure your tenant key; you cannot do this configuration by using a management portal.<br><br>This cmdlet sets the TPD to an active or archived state. The TPD contains your private key and RMS templates.<br><br>Active means that Rights Management uses the TPD key to protect all new content. The TPD key is now the Azure RMS tenant key.After import is successful, the previously active TPD becomes archived.<br><br>Warning: Do not run this cmdlet unless you have read and understood the requirements, restrictions, instructions, and implications of migrating from AD RMS to Azure Rights Management. For more information, see <a href=\"https://docs.microsoft.com/rights-management/plan-design/migrate-from-ad-rms-to-azure-rms\" data-linktype=\"external\">Migrating from AD RMS to Azure RMS</a> (<a href=\"https://docs.microsoft.com/rights-management/plan-design/migrate-from-ad-rms-to-azure-rms\" data-linktype=\"external\">https://docs.microsoft.com/rights-management/plan-design/migrate-from-ad-rms-to-azure-rms</a>) on the Microsoft documentation site.<br><br>After you run this command, the key in the imported TPD becomes available to Azure Rights Management to consume content that AD RMS protected by using this key.<br><br>If the TPD is active, users in your organization begin to use the new Azure RMS tenant TPD to protect documents. Existing users do not start to use the new keys until they are reactivated.<br><br>If you migrate templates from your AD RMS as active, you can edit these templates in the Azure classic portal. You can publish these templates so that users can select them from applications. If the migrated templates are not activated, they can only be used to open documents that they previously protected.<br><br>You must use the AD RMS management console to export the TPD. If you use a hardware security module (HSM) for your keys, you must first repackage the TPD keys by using the Azure Key Vault BYOK tools. You can download these tools from the <a href=\"http://www.microsoft.com/download/details.aspx?id=45345\" data-linktype=\"external\">Microsoft Download Site</a> (<a href=\"http://www.microsoft.com/download/details.aspx?id=45345\" data-linktype=\"external\">http://www.microsoft.com/download/details.aspx?id=45345</a>) For more information, see <a href=\"https://azure.microsoft.com/documentation/articles/key-vault-hsm-protected-keys/\" data-linktype=\"external\">How to generate and transfer HSM-protected keys for Azure Key Vault</a> (<a href=\"https://azure.microsoft.com/documentation/articles/key-vault-hsm-protected-keys/\" data-linktype=\"external\">https://azure.microsoft.com/documentation/articles/key-vault-hsm-protected-keys/</a>).</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Import TPD with a software key</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\>$Password = Read-Host -AsSecureString -Prompt \"Password: \"\r\nPS C:\\> Import-AadrmTpd -TpdFile \"C:\\rms_tpd.xml\" -ProtectionPassword $Password -Active $True -Verbose</code></pre>\r\n\t<p>The first command creates a password as a secure string by using the <strong>Read-Host</strong> cmdlet, and then stores the secure string in the $Password variable. For more information, type <code>Get-Help Read-Host</code>.<br><br>The second command imports a TPD with a software key.</p>\n\r\n\t<p><strong>Example 2: Import TPD with an HSM key</strong></p>\r\n\t\r\n\t<pre><code class=\"lang-powershell\">PS C:\\>$Password = Read-Host -AsSecureString -Prompt \"Password: \"\r\nPS C:\\> Import-AadrmTpd -TpdFile \"C:\\no_key_tpd.xml\" -ProtectionPassword $Password -KeyVaultKeyUrl \"https://contoso-byok-kv.vault.azure.net/keys/contosorms-byok/aaaabbbbcccc111122223333\"-Active $True -Verbose</code></pre>\r\n\t<p>The first command creates a password as a secure string, and then stores the secure string in the $Password variable.<br><br>The second command imports a TPD to be used with a key that is stored in Azure Key Vault.<br><br>Our example uses the key vault name of contoso-byok-kv, the key name of contosorms-byok, and the version number of aaaabbbbcccc111122223333.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-Active</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies whether to upload migrated TPD as active or archived.<br><br>Specify a value of $True to set the TPD to be active. Users in your organization begin to use the new TPD to help protect documents. Existing users do not start to use the new keys until they are reactivated.<br><br>If you migrate templates from your AD RMS as active, then you can edit these templates in the Azure classic portal and activate them for use. Otherwise you can use these templates only to open documents that they previously protected.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>Boolean</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Force</div>\r\n\t<div class=\"parameterSummary\"><p>Forces the command to run without asking for user confirmation.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-HsmKeyFile</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the packaged legacy HSM file that was prepared by using the Azure RMS BYOK tools to upload to your tenant key over the Internet<br><br>This parameter is deprecated now that Azure RMS BYOK supports Azure Key Vault, and this parameter is replaced with <em>KeyVaultKeyUrl</em>.<br><br>If this parameter and the <em>KeyVaultKeyUrl</em> parameter are both supplied, this parameter is ignored.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-KeyVaultKeyUrl</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the URL of the key in Azure Key Vault that you want to use for the Azure RMS tenant key. This key will be used in Azure RMS as the root key for all cryptographic operations for your Azure RMS tenant.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-ProtectionPassword</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the password that was used to encrypt the exported TPD file.<br><br>You can use either <strong>ConvertTo-SecureString -AsPlaintext</strong> or <strong>Read-Host</strong> to specify the SecureString.<br><br>When you use <strong>ConvertTo-SecureString</strong> and the password has special characters, enter the password between single quotes or escape the special characters. If you do not, the password will not parse correctly and in verbose mode, you will see the following error messages:<br><br><strong>VERBOSE: Trusted Publishing Domain data is corrupted.</strong>\n<strong>VERBOSE: The remote server returned an unexpected response: (400) Bad Request.</strong><br><br>For example, if your password is <strong>Pa$$word</strong>, enter <strong>&#39;Pa$$word&#39;</strong> or <strong>Pa`$`$word</strong> so that Windows PowerShell can correctly parse the special characters.\nAs a full example, you might type <strong>$pwd = ConvertTo-SecureString &#39;Pa$$w0rd&#39; -AsPlainText -Force</strong> and then to check that the stored value is correct, type <strong>$pwd</strong> to confirm that <strong>Pa$$word</strong> is displayed.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SecureString</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-TpdFile</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the TPD file exported from your AD RMS server to import to your Azure Rights Management tenant over the Internet.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>String</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>True (ByPropertyName, ByValue)</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Confirm</div>\r\n\t<div class=\"parameterSummary\"><p>Prompts you for confirmation before running the cmdlet.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>cf</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-WhatIf</div>\r\n\t<div class=\"parameterSummary\"><p>Shows what would happen if the cmdlet runs. The cmdlet is not run.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>wi</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"https://docs.microsoft.com/rights-management/plan-design/migrate-from-ad-rms-to-azure-rms\" data-linktype=\"external\">Migrating from AD RMS to Azure RMS</a></li>\r\n\t<li><a href=\"https://azure.microsoft.com/documentation/articles/key-vault-hsm-protected-keys/\" data-linktype=\"external\">How to generate and transfer HSM-protected keys for Azure Key Vault</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Imports a TPD from AD RMS for Rights Management.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Import-AadrmTpd.md\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml\">\r\n<meta name=\"online_version\" content=\"https://go.microsoft.com/fwlink/?LinkId=521420\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"ms.assetid\" content=\"CA482DE6-8575-4161-AD19-97F8A6C87605\">\r\n<meta name=\"updated_at\" content=\"02/13/2017 05:02 AM\">\r\n<meta name=\"ms.date\" content=\"02/13/2017\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Import-AadrmTpd.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/e4c765ba645ee6c466dd1ff7182695aa9e59fb44\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc2.json\">\r\n","rawMetadata":{"commandList":[],"description":"Imports a TPD from AD RMS for Rights Management.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Import-AadrmTpd.md","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"Import-AadrmTpd | Microsoft Docs","_op_ogTitle":"Import-AadrmTpd","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/import-aadrmtpd","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/import-aadrmtpd","external_help_file":"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml","online_version":"https://go.microsoft.com/fwlink/?LinkId=521420","schema":"2.0.0","ms.assetid":"CA482DE6-8575-4161-AD19-97F8A6C87605","updated_at":"02/13/2017 05:02 AM","ms.date":"02/13/2017","content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Import-AadrmTpd.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Import-AadrmTpd.md","gitcommit":"https://github.com/Azure/azure-docs-powershell-aip/blob/e4c765ba645ee6c466dd1ff7182695aa9e59fb44","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azipps-1.3.155.2/module/toc.json","toc_rel":"../toc.json","fileRelativePath":"azipps-1.3.155.2/module/AADRM/Import-AadrmTpd.html"},"themesRelativePathToOutputRoot":"_themes/"}