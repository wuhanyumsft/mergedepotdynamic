{"content":"\r\n<h1 id=\"azipps_1_3_155_2_AADRM_Set_AadrmMaxUseLicenseValidityTime_md\">Set-AadrmMaxUseLicenseValidityTime</h1>\r\n\r\n\r\n\t<div class=\"summary\">Sets the maximum validity time for Rights Management use licenses.</div>\r\n\r\n<nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n  <h3>In this Article</h3>\r\n</nav>\r\n\t<h2 class=\"cli\" id=\"syntax\">Syntax</h2>\r\n\t\t<pre class=\"syntax loading\"><code class=\"lang-powershell\" dir=\"ltr\">Set-AadrmMaxUseLicenseValidityTime [-MaxUseLicenseValidityTime] &lt;UInt16&gt; [-Force] [-Confirm] [-WhatIf]\r\n [&lt;CommonParameters&gt;]</code></pre>\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"description\">Description</h2>\r\n\t<p>The <strong>Set-AadrmMaxUseLicenseValidityTime</strong> cmdlet sets the maximum validity time for use licenses that Azure Rights Management grants for your organization when it protects files and email messages. The default value is 30 days.<br><br>You must use PowerShell to set this configuration at the organization level; you cannot do this configuration by using a management portal.<br><br>A use license is a per-document certificate that is granted to a user who opens a protected file or email message. This certificate contains that user&#39;s rights for the file or email message and the encryption key that was used to encrypt the content, as well as additional access restrictions defined in the document&#39;s policy.<br><br>When the validity period of the use license is expired for a file or email message, the user credentials must be submitted to Azure RMS again to open that content. If the credentials are cached, the user is not prompted, and this happens in the background but an Internet connection is still required to send the cached credentials. <br><br>For example, if a user shares a protected file by email and the protected file has the default use license validity period of 30 days:<br><br>--Anna opens the file immediately, authenticates to Azure RMS, and reads the file.\nThe following day, she reads the file again but does not have an Internet connection.\nBecause the use license validity period has not expired, she can read the file.\nShe accesses the file again 30 days later when she has an Internet connection and re-authenticates with Azure RMS, so she could now continue to read the file without authenticating again for a further 30 days.<br><br>--John does not open the file for 31 days.\nWhen he does, he has Internet access that lets him authenticates to Azure RMS, and he can then open and read the file.\nJohn can continue to re-open and read the file even if he does not have an Internet connection again for a further 30 days.<br><br>--Amelia opens the file a week after it arrives, and then does not open it again for two months.\nWhen she tries to open it this second time, she does not have an Internet access and cannot open the file.<br><br>This setting at the Azure RMS tenant level can be overridden by a more restrictive setting in a Rights Management template because of the <em>LicenseValidityDuration</em> parameter in the <a href=\"./set-aadrmtemplateproperty\">Set-AadrmTemplateProperty</a> and <a href=\"./add-aadrmtemplate\">Add-AadrmTemplate</a> cmdlets, which administrators can also set in the Azure classic portal by configuring the offline access option, Number of days the content is available without an Internet connection.<br><br>This setting can also be overridden by a user for a document when they use the RMS sharing application, and select the &quot;Allow me to instantly revoke access to these documents&quot; option, which effectively sets the use license validity time to 0. When there are different values like this, Azure RMS uses the most restrictive value.<br><br>Because the use license validity time can be overridden with more restrictive values, when you change the default value by using this cmdlet, choose a maximum value that best suits your organization. <br><br>Decide on the best compromise between security and offline access for longer periods:<br><br>--The lower the value, the more often users will be authenticated (which requires an Internet connection) but is a more secure setting because users will more quickly pick up changes such as the document has been revoked or the usage rights have changed for the protected document.<br><br>--The higher the value, the less frequently users will be authenticated (and can continue to access protected documents even without an Internet connection) and is less secure because it will take longer for users to pick up changes such as the document has been revoked or the usage rights have changed for the protected document.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"examples\">Examples</h2>\r\n\t<p><strong>Example 1: Set the maximum validity time</strong></p>\r\n\t\r\n\t<pre class=\"loading\"><code class=\"lang-powershell\">PS C:\\>Set-AadrmMaxUseLicenseValidityTime 60</code></pre>\r\n\t<p>This command sets the maximum validity time for use licenses to be 60 days.</p>\n\r\n\r\n\t<h2 class=\"cli\" id=\"parameters\">Parameters</h2>\r\n  <div class=\"parameterName\">-Force</div>\r\n\t<div class=\"parameterSummary\"><p>Indicates that this cmdlet sets the value for the maximum validity time for use licenses without prompting you for confirmation.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-MaxUseLicenseValidityTime</div>\r\n\t<div class=\"parameterSummary\"><p>Specifies the maximum validity time (0 - 65535) for use licenses in days.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>UInt16</td></tr>\r\n\t\t<tr><td>Required:</td><td>True</td></tr>\r\n\t\t<tr><td>Position:</td><td>1</td></tr>\r\n\t\t<tr><td>Default value:</td><td>None</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-Confirm</div>\r\n\t<div class=\"parameterSummary\"><p>Prompts you for confirmation before running the cmdlet.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>cf</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n  <div class=\"parameterName\">-WhatIf</div>\r\n\t<div class=\"parameterSummary\"><p>Shows what would happen if the cmdlet runs. The cmdlet is not run.<br><br></p>\n</div>\r\n  <div class=\"parameterSummary\">\r\n\t<table class=\"nameValue\">\r\n\t\t<tr><td>Type:</td><td>SwitchParameter</td></tr>\r\n\t\t<tr><td>Aliases:</td><td>wi</td></tr>\r\n\t\t<tr><td>Required:</td><td>False</td></tr>\r\n\t\t<tr><td>Position:</td><td>Named</td></tr>\r\n\t\t<tr><td>Default value:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept pipeline input:</td><td>False</td></tr>\r\n\t\t<tr><td>Accept wildcard characters:</td><td>False</td></tr>\r\n\t</table>  \r\n  </div>\r\n\r\n\r\n\r\n\r\n\t<h2 class=\"cli\" id=\"related-links\">Related Links</h2>\r\n\t<ul class=\"list-clean\">\r\n\t<li><a href=\"./get-aadrmmaxuselicensevaliditytime\">Get-AadrmMaxUseLicenseValidityTime</a></li>\r\n\t</ul>\r\n","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"description\" content=\"Sets the maximum validity time for Rights Management use licenses.\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"PowerShell\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"PowerShell\">\r\n<meta name=\"depot_name\" content=\"PowerShell.PowerShell\">\r\n<meta name=\"ms.gitsourceurl\" content=\"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Set-AadrmMaxUseLicenseValidityTime.md\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"external_help_file\" content=\"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml\">\r\n<meta name=\"online_version\" content=\"http://go.microsoft.com/fwlink/?LinkID=529559\">\r\n<meta name=\"schema\" content=\"2.0.0\">\r\n<meta name=\"ms.assetid\" content=\"E04D855C-C9AF-42DA-A1B4-9D51FE4045D9\">\r\n<meta name=\"updated_at\" content=\"02/13/2017 05:02 AM\">\r\n<meta name=\"ms.date\" content=\"02/13/2017\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Set-AadrmMaxUseLicenseValidityTime.md\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/Azure/azure-docs-powershell-aip/blob/e4c765ba645ee6c466dd1ff7182695aa9e59fb44\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"PowerShellHelpPub\">\r\n<meta name=\"keywords\" content=\"powershell, cmdlet\">\r\n<meta name=\"toc_rel\" content=\"../toc2.json\">\r\n","rawMetadata":{"commandList":[],"description":"Sets the maximum validity time for Rights Management use licenses.","search.ms_sitename":"Docs","search.ms_docsetname":"PowerShell","version":0,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/powershell/","locale":"en-us","site_name":"Docs","search.ms_product":"PowerShell","_op_openToPublicContributors":true,"depot_name":"PowerShell.PowerShell","open_to_public_contributors":true,"ms.gitsourceurl":"https://github.com/MicrosoftDocs/azure-powershell-docs/blob/master/azipps/1.3.155.2/AADRM/Set-AadrmMaxUseLicenseValidityTime.md","layout":"Conceptual","_op_layout":"Conceptual","pagetype":"Reference","title":"Set-AadrmMaxUseLicenseValidityTime | Microsoft Docs","_op_ogTitle":"Set-AadrmMaxUseLicenseValidityTime","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/set-aadrmmaxuselicensevaliditytime","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/module/aadrm/set-aadrmmaxuselicensevaliditytime","external_help_file":"Microsoft.RightsManagementServices.Online.Admin.PowerShell.dll-Help.xml","online_version":"http://go.microsoft.com/fwlink/?LinkID=529559","schema":"2.0.0","ms.assetid":"E04D855C-C9AF-42DA-A1B4-9D51FE4045D9","updated_at":"02/13/2017 05:02 AM","ms.date":"02/13/2017","content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Set-AadrmMaxUseLicenseValidityTime.md","original_content_git_url":"https://github.com/Azure/azure-docs-powershell-aip/blob/master/Azure%20Information%20Protection/AADRM/vlatest/Set-AadrmMaxUseLicenseValidityTime.md","gitcommit":"https://github.com/Azure/azure-docs-powershell-aip/blob/e4c765ba645ee6c466dd1ff7182695aa9e59fb44","ms.topic":"reference","author":"erickson-doug","ms.author":"PowerShellHelpPub","keywords":"powershell, cmdlet","toc_asset_id":"azipps-1.3.155.2/module/toc.json","toc_rel":"../toc.json","_op_displayDate":"2017-2-13","_op_displayDate_source":"2017-02-13T00:00:00Z","fileRelativePath":"azipps-1.3.155.2/module/AADRM/Set-AadrmMaxUseLicenseValidityTime.html"},"themesRelativePathToOutputRoot":"_themes/"}