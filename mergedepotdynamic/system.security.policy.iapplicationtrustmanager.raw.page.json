{"content":"    \r\n    <h1 id=\"System_Security_Policy_IApplicationTrustManager\">\r\n      <span class=\"lang-csharp\">IApplicationTrustManager</span>\r\n        Interface\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Determines whether an application should be executed and which set of permissions should be granted to it.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">[System.Runtime.InteropServices.ComVisible(true)]\npublic interface IApplicationTrustManager : System.Security.ISecurityEncodable</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>Trust managers must implement the IApplicationTrustManager interface. The host calls the <a class=\"xref\" href=\"system.security.policy.iapplicationtrustmanager#System_Security_Policy_IApplicationTrustManager_DetermineApplicationTrust_\" data-linktype=\"relative-path\">DetermineApplicationTrust</a> method to determine whether an application should be executed and which permissions should be granted to the application.  </p>\n<p> In the .NET Framework 4 and later, there is only one trust manager, which can be a custom implementation of the IApplicationTrustManager interface. The default trust manager implementation prompts the user for permission to install the application and to elevate the permissions granted to the application. Other trust manager implementations might provide different user experiences. For example, an implementation might check an enterprise list for trusted applications instead of prompting the user for that information.</p>\n\r\n    \r\n    \r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Security_Policy_IApplicationTrustManager_DetermineApplicationTrust_System_ActivationContext_System_Security_Policy_TrustManagerContext_\" data-linktype=\"self-bookmark\">DetermineApplicationTrust(ActivationContext,TrustManagerContext)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Determines whether an application should be executed and which set of permissions should be granted to it.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Security_Policy_IApplicationTrustManager_DetermineApplicationTrust_System_ActivationContext_System_Security_Policy_TrustManagerContext_\">\r\n    \r\n            <a id=\"System_Security_Policy_IApplicationTrustManager_DetermineApplicationTrust_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">DetermineApplicationTrust(ActivationContext,TrustManagerContext)</div>        \r\n          </div>\r\n    \r\n            <p>Determines whether an application should be executed and which set of permissions should be granted to it.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public System.Security.Policy.ApplicationTrust DetermineApplicationTrust (ActivationContext activationContext, System.Security.Policy.TrustManagerContext context);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>activationContext</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.activationcontext\" data-linktype=\"relative-path\">ActivationContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The activation context for the application.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>context</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.policy.trustmanagercontext\" data-linktype=\"relative-path\">TrustManagerContext</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The trust manager context for the application.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.policy.applicationtrust\" data-linktype=\"relative-path\">ApplicationTrust</a></div>\r\n                  </div>\r\n                  <p>An object that contains security decisions about the application.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The DetermineApplicationTrust method is called by the host to determine whether an application should be executed and which set of permissions it should be granted. DetermineApplicationTrust returns an <a class=\"xref\" href=\"system.security.policy.applicationtrust\" data-linktype=\"relative-path\">ApplicationTrust</a> object with a <a class=\"xref\" href=\"system.security.policy.applicationtrust#System_Security_Policy_ApplicationTrust_DefaultGrantSet_\" data-linktype=\"relative-path\">DefaultGrantSet</a> property that contains a permission set representing the permissions to be granted to each assembly executing within the context of the application. The granted permissions do not apply to assemblies in the global assembly cache. The <a class=\"xref\" href=\"system.security.policy.applicationtrust\" data-linktype=\"relative-path\">ApplicationTrust</a> object also has an <a class=\"xref\" href=\"system.security.policy.applicationtrust#System_Security_Policy_ApplicationTrust_IsApplicationTrustedToRun_\" data-linktype=\"relative-path\">IsApplicationTrustedToRun</a> property that the trust manager sets to indicate whether the application should be trusted. If the trust manager indicates that the application can be trusted, the host activates the application and grants its assemblies the set of permissions provided in the <a class=\"xref\" href=\"system.security.policy.applicationtrust\" data-linktype=\"relative-path\">ApplicationTrust</a> collection.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows an implementation of the DetermineApplicationTrust method for a custom trust manager. This code example is part of a larger example provided for the <a class=\"xref\" href=\"system.security.policy.iapplicationtrustmanager\" data-linktype=\"relative-path\">IApplicationTrustManager</a> interface.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Security.Policy.IApplicationTrustManager#2\">\t\tpublic ApplicationTrust DetermineApplicationTrust(ActivationContext appContext, TrustManagerContext context)\n\t\t{\n\t\t\tApplicationTrust trust = new ApplicationTrust(appContext.Identity);\n\t\t\ttrust.IsApplicationTrustedToRun = false;\n\n\t\t\tApplicationSecurityInfo asi = new ApplicationSecurityInfo(appContext);\n\t\t\ttrust.DefaultGrantSet = new PolicyStatement(asi.DefaultRequestSet, PolicyStatementAttribute.Nothing);\n\t\t\tif (context.UIContext == TrustManagerUIContext.Run)\n\t\t\t{\n\t\t\t\tstring message = &quot;Do you want to run &quot; + asi.ApplicationId.Name + &quot; ?&quot;;\n\t\t\t\tstring caption = &quot;MyTrustManager&quot;;\n\t\t\t\tMessageBoxButtons buttons = MessageBoxButtons.YesNo;\n\t\t\t\tDialogResult result;\n\n\t\t\t\t// Displays the MessageBox.\n\n\t\t\t\tresult = MessageBox.Show(message, caption, buttons);\n\n\t\t\t\tif (result == DialogResult.Yes)\n\t\t\t\t{\n\t\t\t\t\ttrust.IsApplicationTrustedToRun = true;\n\t\t\t\t\tif (context != null)\n\t\t\t\t\t\ttrust.Persist = context.Persist;\n\t\t\t\t\telse\n\t\t\t\t\t\ttrust.Persist = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn trust;\n\t\t}\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Security.Policy.IApplicationTrustManager#2\">    Public Function DetermineApplicationTrust(ByVal appContext As ActivationContext, ByVal context As TrustManagerContext) As ApplicationTrust Implements IApplicationTrustManager.DetermineApplicationTrust\n        Dim trust As New ApplicationTrust(appContext.Identity)\n        trust.IsApplicationTrustedToRun = False\n\n        Dim asi As New ApplicationSecurityInfo(appContext)\n        trust.DefaultGrantSet = New PolicyStatement(asi.DefaultRequestSet, _\n        PolicyStatementAttribute.Nothing)\n        If context.UIContext = TrustManagerUIContext.Run Then\n            Dim message As String = &quot;Do you want to run &quot; + asi.ApplicationId.Name + &quot; ?&quot;\n            Dim caption As String = &quot;MyTrustManager&quot;\n            Dim buttons As MessageBoxButtons = MessageBoxButtons.YesNo\n            Dim result As DialogResult\n\n            &#39; Displays the MessageBox.\n            result = MessageBox.Show(message, caption, buttons)\n\n            If result = DialogResult.Yes Then\n                trust.IsApplicationTrustedToRun = True\n                If Not (context Is Nothing) Then\n                    trust.Persist = context.Persist\n                Else\n                    trust.Persist = False\n                End If\n            End If\n        End If\n        Return trust\n\n    End Function &#39;DetermineApplicationTrust\n    \n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Security.Policy.IApplicationTrustManager.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Security.Policy.IApplicationTrustManager.yml\">\r\n<meta name=\"APIName\" content=\"System.Security.Policy.IApplicationTrustManager\">\r\n<meta name=\"APIName\" content=\"System.Security.Policy.IApplicationTrustManager.DetermineApplicationTrust\">\r\n<meta name=\"APILocation\" content=\"mscorlib.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"c1e83730-89c4-9f0e-4f2f-2f595332a5c1\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Determines whether an application should be executed and which set of permissions should be granted to it.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Security.Policy/toc.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Security.Policy.IApplicationTrustManager\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Security.Policy.IApplicationTrustManager.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Security.Policy.IApplicationTrustManager.yml","open_to_public_contributors":true,"api_name":["System.Security.Policy.IApplicationTrustManager","System.Security.Policy.IApplicationTrustManager.DetermineApplicationTrust"],"api_location":["mscorlib.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Security.Policy.IApplicationTrustManager","System::Security::Policy::IApplicationTrustManager","System.Security.Policy.IApplicationTrustManager.DetermineApplicationTrust","System::Security::Policy::IApplicationTrustManager::DetermineApplicationTrust"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"c1e83730-89c4-9f0e-4f2f-2f595332a5c1","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Security.Policy/IApplicationTrustManager.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"IApplicationTrustManager interface | Microsoft Docs","_op_ogTitle":"IApplicationTrustManager interface","description":"Determines whether an application should be executed and which set of permissions should be granted to it.\n","toc_asset_id":"_splitted/System.Security.Policy/toc.json","toc_rel":"_splitted/System.Security.Policy/toc.json","source_url":"","ms.assetid":"System.Security.Policy.IApplicationTrustManager","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.security.policy.iapplicationtrustmanager","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.security.policy.iapplicationtrustmanager","fileRelativePath":"System.Security.Policy.IApplicationTrustManager.html"},"themesRelativePathToOutputRoot":"_themes/"}