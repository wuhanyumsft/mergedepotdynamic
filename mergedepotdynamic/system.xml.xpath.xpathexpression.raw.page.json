{"content":"    \r\n    <h1 id=\"System_Xml_XPath_XPathExpression\">\r\n      <span class=\"lang-csharp\">XPathExpression</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Provides a typed class that represents a compiled XPath expression.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract class XPathExpression</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l1\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">XPathExpression</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>This class is returned as the result of the <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator#System_Xml_XPath_XPathNavigator_Compile_\" data-linktype=\"relative-path\">Compile</a> method of the <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator\" data-linktype=\"relative-path\">XPathNavigator</a> class. It is a parameter to the <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator#System_Xml_XPath_XPathNavigator_Evaluate_\" data-linktype=\"relative-path\">Evaluate</a>, <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator#System_Xml_XPath_XPathNavigator_Matches_\" data-linktype=\"relative-path\">Matches</a>, <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator#System_Xml_XPath_XPathNavigator_Select_\" data-linktype=\"relative-path\">Select</a>, and <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator#System_Xml_XPath_XPathNavigator_SelectSingleNode_\" data-linktype=\"relative-path\">SelectSingleNode</a> methods of the <a class=\"xref\" href=\"system.xml.xpath.xpathnavigator\" data-linktype=\"relative-path\">XPathNavigator</a> class.</p>\n\r\n    \r\n    \r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_Expression\" data-linktype=\"self-bookmark\">Expression</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, gets a <code>string</code> representation of the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_ReturnType\" data-linktype=\"self-bookmark\">ReturnType</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, gets the result type of the XPath expression.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_AddSort_System_Object_System_Collections_IComparer_\" data-linktype=\"self-bookmark\">AddSort(Object,IComparer)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, sorts the nodes selected by the XPath expression according to the specified <a class=\"xref\" href=\"system.collections.icomparer\" data-linktype=\"relative-path\">IComparer</a> object.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_AddSort_System_Object_System_Xml_XPath_XmlSortOrder_System_Xml_XPath_XmlCaseOrder_System_String_System_Xml_XPath_XmlDataType_\" data-linktype=\"self-bookmark\">AddSort(Object,XmlSortOrder,XmlCaseOrder,String,XmlDataType)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, sorts the nodes selected by the XPath expression according to the supplied parameters.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_Clone\" data-linktype=\"self-bookmark\">Clone()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, returns a clone of this <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a>.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_Compile_System_String_\" data-linktype=\"self-bookmark\">Compile(String)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Compiles the XPath expression specified and returns an <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object representing the XPath expression.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_Compile_System_String_System_Xml_IXmlNamespaceResolver_\" data-linktype=\"self-bookmark\">Compile(String,IXmlNamespaceResolver)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Compiles the specified XPath expression, with the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> object specified for namespace resolution, and returns an <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object that represents the XPath expression.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_SetContext_System_Xml_IXmlNamespaceResolver_\" data-linktype=\"self-bookmark\">SetContext(IXmlNamespaceResolver)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, specifies the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> object to use for namespace resolution.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Xml_XPath_XPathExpression_SetContext_System_Xml_XmlNamespaceManager_\" data-linktype=\"self-bookmark\">SetContext(XmlNamespaceManager)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, specifies the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object to use for namespace resolution.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_Expression\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_Expression_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Expression</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, gets a <code>string</code> representation of the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract string Expression { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </div>\r\n                  <p>A <code>string</code> representation of the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_ReturnType\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_ReturnType_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ReturnType</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, gets the result type of the XPath expression.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract System.Xml.XPath.XPathResultType ReturnType { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a> value representing the result type of the XPath expression.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to use the XPath return type to determine how to process the XPath expression.  </p>\n<pre><code class=\"lang-cs\" name=\"XPathExpression.ReturnType#1\">using System;\nusing System.Xml;\nusing System.Xml.XPath;\n\npublic class XPathExpressionExample\n{\n    public static void Main()\n    {\n        XPathDocument document = new XPathDocument(&quot;contosoBooks.xml&quot;);\n        XPathNavigator navigator = document.CreateNavigator();\n\n        XPathExpression expression1 = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;); // Returns a number.\n        XPathExpression expression2 = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;); // Returns a nodeset.\n\n        XmlNamespaceManager manager = new XmlNamespaceManager(navigator.NameTable);\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;);\n\n        expression1.SetContext(manager);\n        expression2.SetContext(manager);\n\n        Evaluate(expression1, navigator);\n        Evaluate(expression2, navigator);\n    }\n\n    public static void Evaluate(XPathExpression expression, XPathNavigator navigator)\n    {\n        switch (expression.ReturnType)\n        {\n            case XPathResultType.Number:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n\n            case XPathResultType.NodeSet:\n                XPathNodeIterator nodes = navigator.Select(expression);\n                while (nodes.MoveNext())\n                {\n                    Console.WriteLine(nodes.Current.ToString());\n                }\n                break;\n\n            case XPathResultType.Boolean:\n                if ((bool)navigator.Evaluate(expression))\n                    Console.WriteLine(&quot;True!&quot;);\n                break;\n\n            case XPathResultType.String:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n        }\n    }\n}\n</code></pre><pre><code class=\"lang-cpp\" name=\"XPathExpression.ReturnType#1\">public ref class Sample\n{\npublic:\n   static void Evaluate( XPathExpression^ expr, XPathNavigator^ nav )\n   {\n      XPathNodeIterator^ i = nav-&gt;Select(expr);\n      switch ( expr-&gt;ReturnType )\n      {\n         case XPathResultType::Number:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n\n         case XPathResultType::NodeSet:\n            while ( i-&gt;MoveNext() )\n                        Console::WriteLine( i-&gt;Current );\n            break;\n\n         case XPathResultType::Boolean:\n            if ( *safe_cast&lt;bool^&gt;(nav-&gt;Evaluate( expr )) )\n                        Console::WriteLine( &quot;True!&quot; );\n            break;\n\n         case XPathResultType::String:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n      }\n   }\n\n};\n\nint main()\n{\n   XPathDocument^ doc = gcnew XPathDocument( &quot;contosoBooks.xml&quot; );\n   XPathNavigator^ nav = doc-&gt;CreateNavigator();\n   XPathExpression^ expr1 = nav-&gt;Compile( &quot;.//price/text()*10&quot; ); // Returns a number.\n\n   XPathExpression^ expr2 = nav-&gt;Compile( &quot;bookstore/book/price&quot; ); // Returns a nodeset.\n\n   Sample^ MySample = gcnew Sample;\n   MySample-&gt;Evaluate( expr1, nav );\n   MySample-&gt;Evaluate( expr2, nav );\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"XPathExpression.ReturnType#1\">Imports System\nImports System.Xml\nImports System.Xml.XPath\n\nPublic Class XPathExpressionExample\n\n    Public Shared Sub Main()\n        Dim document As XPathDocument = New XPathDocument(&quot;contosoBooks.xml&quot;)\n        Dim navigator As XPathNavigator = document.CreateNavigator()\n\n        Dim expression1 As XPathExpression = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;)  &#39; Returns a number.\n        Dim expression2 As XPathExpression = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;)  &#39; Returns a nodeset.\n\n        Dim manager As XmlNamespaceManager = New XmlNamespaceManager(navigator.NameTable)\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;)\n\n        expression1.SetContext(manager)\n        expression2.SetContext(manager)\n\n        Evaluate(expression1, navigator)\n        Evaluate(expression2, navigator)\n\n    End Sub\n\n    Public Shared Sub Evaluate(ByVal expression As XPathExpression, ByVal navigator As XPathNavigator)\n\n        Select Case expression.ReturnType\n            Case XPathResultType.Number\n                Console.WriteLine(navigator.Evaluate(expression))\n                Exit Sub\n\n            Case XPathResultType.NodeSet\n                Dim nodes As XPathNodeIterator = navigator.Select(expression)\n                While nodes.MoveNext()\n                    Console.WriteLine(nodes.Current.ToString())\n                End While\n\n            Case XPathResultType.Boolean\n                If CType(navigator.Evaluate(expression), Boolean) Then\n                    Console.WriteLine(&quot;True!&quot;)\n                End If\n\n            Case XPathResultType.String\n                Console.WriteLine(navigator.Evaluate(expression))\n        End Select\n\n    End Sub\nEnd Class\n</code></pre><p> The example takes the <code>contosoBooks.xml</code> file as input.  </p>\n<pre><code class=\"lang-xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;  \n&lt;bookstore xmlns=&quot;http://www.contoso.com/books&quot;&gt;  \n    &lt;book genre=&quot;autobiography&quot; publicationdate=&quot;1981-03-22&quot; ISBN=&quot;1-861003-11-0&quot;&gt;  \n        &lt;title&gt;The Autobiography of Benjamin Franklin&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Benjamin&lt;/first-name&gt;  \n            &lt;last-name&gt;Franklin&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;8.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;novel&quot; publicationdate=&quot;1967-11-17&quot; ISBN=&quot;0-201-63361-2&quot;&gt;  \n        &lt;title&gt;The Confidence Man&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Herman&lt;/first-name&gt;  \n            &lt;last-name&gt;Melville&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;11.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;philosophy&quot; publicationdate=&quot;1991-02-15&quot; ISBN=&quot;1-861001-57-6&quot;&gt;  \n        &lt;title&gt;The Gorgias&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;name&gt;Plato&lt;/name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;9.99&lt;/price&gt;  \n    &lt;/book&gt;  \n&lt;/bookstore&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_AddSort_System_Object_System_Collections_IComparer_\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_AddSort_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">AddSort(Object,IComparer)</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, sorts the nodes selected by the XPath expression according to the specified <a class=\"xref\" href=\"system.collections.icomparer\" data-linktype=\"relative-path\">IComparer</a> object.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract void AddSort (object expr, System.Collections.IComparer comparer);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>expr</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An object representing the sort key. This can be the <code>string</code> value of the node or an <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object with a compiled XPath expression.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>comparer</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.icomparer\" data-linktype=\"relative-path\">IComparer</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An <a class=\"xref\" href=\"system.collections.icomparer\" data-linktype=\"relative-path\">IComparer</a> object that provides the specific data type comparisons for comparing two objects for equivalence.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexception\" data-linktype=\"relative-path\">XPathException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> or sort key includes a prefix and either an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> is not provided, or the prefix cannot be found in the supplied <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The AddSort method enables users to sort objects by their data type instead of by string or number. The <a class=\"xref\" href=\"system.collections.icomparer\" data-linktype=\"relative-path\">IComparer</a> object provides an implementation of the <a class=\"xref\" href=\"system.collections.icomparer#System_Collections_IComparer_Compare_\" data-linktype=\"relative-path\">Compare</a> method that supports sorting on user-defined classes.  </p>\n<p> In the following example, the books are sorted by ISBN number, where <code>isbn</code> is an object that implements the <a class=\"xref\" href=\"system.collections.icomparer\" data-linktype=\"relative-path\">IComparer</a> interface.  </p>\n<pre><code class=\"lang-vb#\">Dim expression As XPathExpression = navigator.Compile(&quot;bookstore/book&quot;)  \nDim isbn As ISBN = New ISBN()  \nexpression.AddSort(&quot;@ISBN&quot;, (IComparer)isbn)\n</code></pre><pre><code class=\"lang-c#\">XPathExpression expression = navigator.Compile(&quot;bookstore/book&quot;);  \nISBN isbn = new ISBN();  \nexpression.AddSort(&quot;@ISBN&quot;, (IComparer)isbn);\n</code></pre><p> The following are important notes to consider when using the AddSort method.  </p>\n<ul>\n<li><p>The order in which the sorts are added provides the sort key order.  </p>\n</li>\n<li><p>If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> or the sort key requires namespace resolution, you must use the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method to provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> for namespace resolution.  </p>\n</li>\n<li><p>If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> does not include a prefix, it is assumed that the namespace Uniform Resource Identifier (URI) is the empty namespace. If your XML includes a default namespace, you must still use the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method and provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> that contains a prefix and namespace URI to handle the default namespace.</p>\n</li>\n</ul>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_AddSort_System_Object_System_Xml_XPath_XmlSortOrder_System_Xml_XPath_XmlCaseOrder_System_String_System_Xml_XPath_XmlDataType_\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_AddSort_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">AddSort(Object,XmlSortOrder,XmlCaseOrder,String,XmlDataType)</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, sorts the nodes selected by the XPath expression according to the supplied parameters.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract void AddSort (object expr, System.Xml.XPath.XmlSortOrder order, System.Xml.XPath.XmlCaseOrder caseOrder, string lang, System.Xml.XPath.XmlDataType dataType);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>expr</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An object representing the sort key. This can be the <code>string</code> value of the node or an <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object with a compiled XPath expression.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>order</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xmlsortorder\" data-linktype=\"relative-path\">XmlSortOrder</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xpath.xmlsortorder\" data-linktype=\"relative-path\">XmlSortOrder</a> value indicating the sort order.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>caseOrder</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xmlcaseorder\" data-linktype=\"relative-path\">XmlCaseOrder</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xpath.xmlcaseorder\" data-linktype=\"relative-path\">XmlCaseOrder</a> value indicating how to sort uppercase and lowercase letters.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>lang</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The language to use for comparison. Uses the <a class=\"xref\" href=\"system.globalization.cultureinfo\" data-linktype=\"relative-path\">CultureInfo</a> class that can be passed to the <span class=\"xref\">stem.String.Compare*</span> method for the language types, for example, &quot;us-en&quot; for U.S. English. If an empty string is specified, the system environment is used to determine the <a class=\"xref\" href=\"system.globalization.cultureinfo\" data-linktype=\"relative-path\">CultureInfo</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>dataType</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xmldatatype\" data-linktype=\"relative-path\">XmlDataType</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xpath.xmldatatype\" data-linktype=\"relative-path\">XmlDataType</a> value indicating the sort order for the data type.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexception\" data-linktype=\"relative-path\">XPathException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> or sort key includes a prefix and either an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> is not provided, or the prefix cannot be found in the supplied <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <ul>\n<li><p>The order in which the sorts are added provides the sort key order.  </p>\n</li>\n<li><p>If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> or the sort key requires namespace resolution, you must use the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method to provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> for namespace resolution.  </p>\n</li>\n<li><p>If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> does not include a prefix, it is assumed that the namespace Uniform Resource Identifier (URI) is the empty namespace. If your XML includes a default namespace, you must still use the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method and provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> that contains a prefix and namespace URI to handle the default namespace.</p>\n</li>\n</ul>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to sort the books document by price in descending order.  </p>\n<pre><code class=\"lang-vb\" name=\"XPathXMLExamples#4\">Imports System.Xml\nImports System.Xml.XPath\nModule Module1\n\n    Sub Main()\n        Dim doc As New XPathDocument(&quot;contosoBooks.xml&quot;)\n        Dim nav As XPathNavigator = doc.CreateNavigator()\n\n        Dim expr As XPathExpression\n        expr = nav.Compile(&quot;/bookstore/book&quot;)\n\n        expr.AddSort(&quot;price&quot;, XmlSortOrder.Descending, _\n                          XmlCaseOrder.None, &quot;&quot;, XmlDataType.Number)\n\n        Dim iterator As XPathNodeIterator = nav.Select(expr)\n        Do While iterator.MoveNext()\n\n            If (iterator.Current.HasChildren()) Then\n                Dim childIter As XPathNodeIterator = _\n                iterator.Current.SelectChildren(XPathNodeType.Element)\n                Do While childIter.MoveNext()\n                    Console.WriteLine(childIter.Current.Value)\n                Loop\n\n            End If\n        Loop\n\n    End Sub\n\nEnd Module\n</code></pre><pre><code class=\"lang-cs\" name=\"XPathXMLExamples#5\">using System;\nusing System.Xml;\nusing System.Xml.XPath;\n\nnamespace SortBooks\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            XPathDocument doc = new XPathDocument(&quot;contosoBooks.xml&quot;);\n            XPathNavigator nav = doc.CreateNavigator();\n\n            XPathExpression expr;\n            expr = nav.Compile(&quot;/bookstore/book&quot;);\n\n            expr.AddSort(&quot;price&quot;, XmlSortOrder.Descending,\n                           XmlCaseOrder.None, &quot;&quot;, XmlDataType.Number);\n\n            XPathNodeIterator iterator = nav.Select(expr);\n            while (iterator.MoveNext())\n            {\n                if (iterator.Current.HasChildren)\n                {\n                    XPathNodeIterator childIter =\n              iterator.Current.SelectChildren(XPathNodeType.Element);\n                    while (childIter.MoveNext())\n                    {\n                        Console.WriteLine(childIter.Current.Value);\n\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre><p> The example takes the <code>books.xml</code> file as input.  </p>\n<pre><code class=\"lang-xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;   \n&lt;bookstore&gt;  \n    &lt;book genre=&quot;autobiography&quot; publicationdate=&quot;1981-03-22&quot; ISBN=&quot;1-861003-11-0&quot;&gt;  \n        &lt;title&gt;The Autobiography of Benjamin Franklin&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Benjamin&lt;/first-name&gt;  \n            &lt;last-name&gt;Franklin&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;8.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;novel&quot; publicationdate=&quot;1967-11-17&quot; ISBN=&quot;0-201-63361-2&quot;&gt;  \n        &lt;title&gt;The Confidence Man&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Herman&lt;/first-name&gt;  \n            &lt;last-name&gt;Melville&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;11.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;philosophy&quot; publicationdate=&quot;1991-02-15&quot; ISBN=&quot;1-861001-57-6&quot;&gt;  \n        &lt;title&gt;The Gorgias&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;name&gt;Plato&lt;/name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;9.99&lt;/price&gt;  \n    &lt;/book&gt;  \n&lt;/bookstore&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_Clone\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_Clone_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Clone()</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, returns a clone of this <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a>.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract System.Xml.XPath.XPathExpression Clone ();</code></pre>\r\n    \r\n    \r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a></div>\r\n                  </div>\r\n                  <p>A new <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>When overridden in a derived class, the Clone method returns a clone of this <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object with the same state as this <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_Compile_System_String_\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_Compile_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Compile(String)</div>        \r\n          </div>\r\n    \r\n            <p>Compiles the XPath expression specified and returns an <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object representing the XPath expression.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Xml.XPath.XPathExpression Compile (string xpath);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>xpath</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An XPath expression.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p>The XPath expression parameter is not a valid XPath expression.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexception\" data-linktype=\"relative-path\">XPathException</a></div>\r\n                  </div>\r\n                  <p>The XPath expression is not valid.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>An XPath expression is evaluated to yield one of the following result types.  </p>\n<ul>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n</li>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n</li>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n</li>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n\n</li>\n</ul>\n<div class=\"NOTE\"><h5>Note</h5><p> If a user-defined function with an invalid number of arguments (or an unimplemented user-defined function) is specified in the XPath expression, an exception occurs only at run time. User-defined functions are not checked at compile time and exceptions that result from user-defined functions occur only if execution evaluates the expression.</p>\n</div>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to use the XPath return type to determine how to process the XPath expression. The example uses the Compile method to return the new <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> objects.  </p>\n<pre><code class=\"lang-cs\" name=\"XPathExpression.ReturnType#1\">using System;\nusing System.Xml;\nusing System.Xml.XPath;\n\npublic class XPathExpressionExample\n{\n    public static void Main()\n    {\n        XPathDocument document = new XPathDocument(&quot;contosoBooks.xml&quot;);\n        XPathNavigator navigator = document.CreateNavigator();\n\n        XPathExpression expression1 = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;); // Returns a number.\n        XPathExpression expression2 = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;); // Returns a nodeset.\n\n        XmlNamespaceManager manager = new XmlNamespaceManager(navigator.NameTable);\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;);\n\n        expression1.SetContext(manager);\n        expression2.SetContext(manager);\n\n        Evaluate(expression1, navigator);\n        Evaluate(expression2, navigator);\n    }\n\n    public static void Evaluate(XPathExpression expression, XPathNavigator navigator)\n    {\n        switch (expression.ReturnType)\n        {\n            case XPathResultType.Number:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n\n            case XPathResultType.NodeSet:\n                XPathNodeIterator nodes = navigator.Select(expression);\n                while (nodes.MoveNext())\n                {\n                    Console.WriteLine(nodes.Current.ToString());\n                }\n                break;\n\n            case XPathResultType.Boolean:\n                if ((bool)navigator.Evaluate(expression))\n                    Console.WriteLine(&quot;True!&quot;);\n                break;\n\n            case XPathResultType.String:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n        }\n    }\n}\n</code></pre><pre><code class=\"lang-cpp\" name=\"XPathExpression.ReturnType#1\">public ref class Sample\n{\npublic:\n   static void Evaluate( XPathExpression^ expr, XPathNavigator^ nav )\n   {\n      XPathNodeIterator^ i = nav-&gt;Select(expr);\n      switch ( expr-&gt;ReturnType )\n      {\n         case XPathResultType::Number:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n\n         case XPathResultType::NodeSet:\n            while ( i-&gt;MoveNext() )\n                        Console::WriteLine( i-&gt;Current );\n            break;\n\n         case XPathResultType::Boolean:\n            if ( *safe_cast&lt;bool^&gt;(nav-&gt;Evaluate( expr )) )\n                        Console::WriteLine( &quot;True!&quot; );\n            break;\n\n         case XPathResultType::String:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n      }\n   }\n\n};\n\nint main()\n{\n   XPathDocument^ doc = gcnew XPathDocument( &quot;contosoBooks.xml&quot; );\n   XPathNavigator^ nav = doc-&gt;CreateNavigator();\n   XPathExpression^ expr1 = nav-&gt;Compile( &quot;.//price/text()*10&quot; ); // Returns a number.\n\n   XPathExpression^ expr2 = nav-&gt;Compile( &quot;bookstore/book/price&quot; ); // Returns a nodeset.\n\n   Sample^ MySample = gcnew Sample;\n   MySample-&gt;Evaluate( expr1, nav );\n   MySample-&gt;Evaluate( expr2, nav );\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"XPathExpression.ReturnType#1\">Imports System\nImports System.Xml\nImports System.Xml.XPath\n\nPublic Class XPathExpressionExample\n\n    Public Shared Sub Main()\n        Dim document As XPathDocument = New XPathDocument(&quot;contosoBooks.xml&quot;)\n        Dim navigator As XPathNavigator = document.CreateNavigator()\n\n        Dim expression1 As XPathExpression = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;)  &#39; Returns a number.\n        Dim expression2 As XPathExpression = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;)  &#39; Returns a nodeset.\n\n        Dim manager As XmlNamespaceManager = New XmlNamespaceManager(navigator.NameTable)\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;)\n\n        expression1.SetContext(manager)\n        expression2.SetContext(manager)\n\n        Evaluate(expression1, navigator)\n        Evaluate(expression2, navigator)\n\n    End Sub\n\n    Public Shared Sub Evaluate(ByVal expression As XPathExpression, ByVal navigator As XPathNavigator)\n\n        Select Case expression.ReturnType\n            Case XPathResultType.Number\n                Console.WriteLine(navigator.Evaluate(expression))\n                Exit Sub\n\n            Case XPathResultType.NodeSet\n                Dim nodes As XPathNodeIterator = navigator.Select(expression)\n                While nodes.MoveNext()\n                    Console.WriteLine(nodes.Current.ToString())\n                End While\n\n            Case XPathResultType.Boolean\n                If CType(navigator.Evaluate(expression), Boolean) Then\n                    Console.WriteLine(&quot;True!&quot;)\n                End If\n\n            Case XPathResultType.String\n                Console.WriteLine(navigator.Evaluate(expression))\n        End Select\n\n    End Sub\nEnd Class\n</code></pre><p> The example takes the <code>contosoBooks.xml</code> file as input.  </p>\n<pre><code class=\"lang-xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;  \n&lt;bookstore xmlns=&quot;http://www.contoso.com/books&quot;&gt;  \n    &lt;book genre=&quot;autobiography&quot; publicationdate=&quot;1981-03-22&quot; ISBN=&quot;1-861003-11-0&quot;&gt;  \n        &lt;title&gt;The Autobiography of Benjamin Franklin&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Benjamin&lt;/first-name&gt;  \n            &lt;last-name&gt;Franklin&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;8.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;novel&quot; publicationdate=&quot;1967-11-17&quot; ISBN=&quot;0-201-63361-2&quot;&gt;  \n        &lt;title&gt;The Confidence Man&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Herman&lt;/first-name&gt;  \n            &lt;last-name&gt;Melville&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;11.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;philosophy&quot; publicationdate=&quot;1991-02-15&quot; ISBN=&quot;1-861001-57-6&quot;&gt;  \n        &lt;title&gt;The Gorgias&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;name&gt;Plato&lt;/name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;9.99&lt;/price&gt;  \n    &lt;/book&gt;  \n&lt;/bookstore&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_Compile_System_String_System_Xml_IXmlNamespaceResolver_\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_Compile_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Compile(String,IXmlNamespaceResolver)</div>        \r\n          </div>\r\n    \r\n            <p>Compiles the specified XPath expression, with the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> object specified for namespace resolution, and returns an <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object that represents the XPath expression.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Xml.XPath.XPathExpression Compile (string xpath, System.Xml.IXmlNamespaceResolver nsResolver);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>xpath</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An XPath expression.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>nsResolver</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An object that implements the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> interface for namespace resolution.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a></div>\r\n                  </div>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></div>\r\n                  </div>\r\n                  <p>The XPath expression parameter is not a valid XPath expression.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexception\" data-linktype=\"relative-path\">XPathException</a></div>\r\n                  </div>\r\n                  <p>The XPath expression is not valid.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>An XPath expression is evaluated to yield one of the following result types.  </p>\n<ul>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n</li>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n</li>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n</li>\n<li><a class=\"xref\" href=\"system.xml.xpath.xpathresulttype\" data-linktype=\"relative-path\">XPathResultType</a>  \n\n</li>\n</ul>\n<div class=\"NOTE\"><h5>Note</h5><p> If a user-defined function with an invalid number of arguments (or an unimplemented user-defined function) is specified in the XPath expression, an exception occurs only at run-time. User-defined functions are not checked at compile time and exceptions resulting from user-defined functions occur only if execution evaluates the expression.  </p>\n</div>\n<div class=\"NOTE\"><h5>Note</h5><p> It is not possible to compile a <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> with a custom context in one step by passing an <a class=\"xref\" href=\"system.xml.xsl.xsltcontext\" data-linktype=\"relative-path\">XsltContext</a>, which implements <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a>, as an argument to this method. To use a <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> with a custom context, you must call the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method after compiling the expression.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_SetContext_System_Xml_IXmlNamespaceResolver_\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_SetContext_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SetContext(IXmlNamespaceResolver)</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, specifies the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> object to use for namespace resolution.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract void SetContext (System.Xml.IXmlNamespaceResolver nsResolver);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>nsResolver</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An object that implements the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> interface to use for namespace resolution.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexception\" data-linktype=\"relative-path\">XPathException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> object parameter is not derived from <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Namespace resolution is supported using classes that implement the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> interface, such as the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> class. The <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> stores prefix and namespace Uniform Resource Identifier (URI) mappings. If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> requires namespace resolution, the prefix and namespace URI pair must be added to an object, such as the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> class, which implements the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> interface, and the SetContext method must be called to specify the <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> interface object to use for namespace resolution.  </p>\n<p> The following are important notes to consider when using the SetContext method.  </p>\n<ul>\n<li><p>If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> does not include a prefix, it is assumed that the namespace URI is the empty namespace. If your XML includes a default namespace, you must still use the SetContext method and provide an object that contains a prefix and namespace URI to handle the default namespace.  </p>\n</li>\n<li><p>You can also supply an <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> interface object for namespace resolution to the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_Compile_\" data-linktype=\"relative-path\">Compile</a> method when you create your <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object.  </p>\n</li>\n<li><p>SetContext accepts <a class=\"xref\" href=\"system.xml.xsl.xsltcontext\" data-linktype=\"relative-path\">XsltContext</a> as a namespace resolver, so you can implement a custom context and use functions and variables based on <a class=\"xref\" href=\"system.xml.xsl.ixsltcontextfunction\" data-linktype=\"relative-path\">IXsltContextFunction</a> and <a class=\"xref\" href=\"system.xml.xsl.ixsltcontextvariable\" data-linktype=\"relative-path\">IXsltContextVariable</a>. The XPath expression will execute them. For more information, see <a href=\"../Topic/User%20Defined%20Functions%20and%20Variables.md\" data-linktype=\"relative-path\">User Defined Functions and Variables</a>.</p>\n</li>\n</ul>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to use the XPath return type to determine how to process the XPath expression, and how to use the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> method to provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object for namespace resolution.  </p>\n<pre><code class=\"lang-cs\" name=\"XPathExpression.ReturnType#1\">using System;\nusing System.Xml;\nusing System.Xml.XPath;\n\npublic class XPathExpressionExample\n{\n    public static void Main()\n    {\n        XPathDocument document = new XPathDocument(&quot;contosoBooks.xml&quot;);\n        XPathNavigator navigator = document.CreateNavigator();\n\n        XPathExpression expression1 = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;); // Returns a number.\n        XPathExpression expression2 = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;); // Returns a nodeset.\n\n        XmlNamespaceManager manager = new XmlNamespaceManager(navigator.NameTable);\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;);\n\n        expression1.SetContext(manager);\n        expression2.SetContext(manager);\n\n        Evaluate(expression1, navigator);\n        Evaluate(expression2, navigator);\n    }\n\n    public static void Evaluate(XPathExpression expression, XPathNavigator navigator)\n    {\n        switch (expression.ReturnType)\n        {\n            case XPathResultType.Number:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n\n            case XPathResultType.NodeSet:\n                XPathNodeIterator nodes = navigator.Select(expression);\n                while (nodes.MoveNext())\n                {\n                    Console.WriteLine(nodes.Current.ToString());\n                }\n                break;\n\n            case XPathResultType.Boolean:\n                if ((bool)navigator.Evaluate(expression))\n                    Console.WriteLine(&quot;True!&quot;);\n                break;\n\n            case XPathResultType.String:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n        }\n    }\n}\n</code></pre><pre><code class=\"lang-cpp\" name=\"XPathExpression.ReturnType#1\">public ref class Sample\n{\npublic:\n   static void Evaluate( XPathExpression^ expr, XPathNavigator^ nav )\n   {\n      XPathNodeIterator^ i = nav-&gt;Select(expr);\n      switch ( expr-&gt;ReturnType )\n      {\n         case XPathResultType::Number:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n\n         case XPathResultType::NodeSet:\n            while ( i-&gt;MoveNext() )\n                        Console::WriteLine( i-&gt;Current );\n            break;\n\n         case XPathResultType::Boolean:\n            if ( *safe_cast&lt;bool^&gt;(nav-&gt;Evaluate( expr )) )\n                        Console::WriteLine( &quot;True!&quot; );\n            break;\n\n         case XPathResultType::String:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n      }\n   }\n\n};\n\nint main()\n{\n   XPathDocument^ doc = gcnew XPathDocument( &quot;contosoBooks.xml&quot; );\n   XPathNavigator^ nav = doc-&gt;CreateNavigator();\n   XPathExpression^ expr1 = nav-&gt;Compile( &quot;.//price/text()*10&quot; ); // Returns a number.\n\n   XPathExpression^ expr2 = nav-&gt;Compile( &quot;bookstore/book/price&quot; ); // Returns a nodeset.\n\n   Sample^ MySample = gcnew Sample;\n   MySample-&gt;Evaluate( expr1, nav );\n   MySample-&gt;Evaluate( expr2, nav );\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"XPathExpression.ReturnType#1\">Imports System\nImports System.Xml\nImports System.Xml.XPath\n\nPublic Class XPathExpressionExample\n\n    Public Shared Sub Main()\n        Dim document As XPathDocument = New XPathDocument(&quot;contosoBooks.xml&quot;)\n        Dim navigator As XPathNavigator = document.CreateNavigator()\n\n        Dim expression1 As XPathExpression = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;)  &#39; Returns a number.\n        Dim expression2 As XPathExpression = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;)  &#39; Returns a nodeset.\n\n        Dim manager As XmlNamespaceManager = New XmlNamespaceManager(navigator.NameTable)\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;)\n\n        expression1.SetContext(manager)\n        expression2.SetContext(manager)\n\n        Evaluate(expression1, navigator)\n        Evaluate(expression2, navigator)\n\n    End Sub\n\n    Public Shared Sub Evaluate(ByVal expression As XPathExpression, ByVal navigator As XPathNavigator)\n\n        Select Case expression.ReturnType\n            Case XPathResultType.Number\n                Console.WriteLine(navigator.Evaluate(expression))\n                Exit Sub\n\n            Case XPathResultType.NodeSet\n                Dim nodes As XPathNodeIterator = navigator.Select(expression)\n                While nodes.MoveNext()\n                    Console.WriteLine(nodes.Current.ToString())\n                End While\n\n            Case XPathResultType.Boolean\n                If CType(navigator.Evaluate(expression), Boolean) Then\n                    Console.WriteLine(&quot;True!&quot;)\n                End If\n\n            Case XPathResultType.String\n                Console.WriteLine(navigator.Evaluate(expression))\n        End Select\n\n    End Sub\nEnd Class\n</code></pre><p> The example takes the <code>contosoBooks.xml</code> file as input.  </p>\n<pre><code class=\"lang-xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;  \n&lt;bookstore xmlns=&quot;http://www.contoso.com/books&quot;&gt;  \n    &lt;book genre=&quot;autobiography&quot; publicationdate=&quot;1981-03-22&quot; ISBN=&quot;1-861003-11-0&quot;&gt;  \n        &lt;title&gt;The Autobiography of Benjamin Franklin&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Benjamin&lt;/first-name&gt;  \n            &lt;last-name&gt;Franklin&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;8.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;novel&quot; publicationdate=&quot;1967-11-17&quot; ISBN=&quot;0-201-63361-2&quot;&gt;  \n        &lt;title&gt;The Confidence Man&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Herman&lt;/first-name&gt;  \n            &lt;last-name&gt;Melville&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;11.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;philosophy&quot; publicationdate=&quot;1991-02-15&quot; ISBN=&quot;1-861001-57-6&quot;&gt;  \n        &lt;title&gt;The Gorgias&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;name&gt;Plato&lt;/name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;9.99&lt;/price&gt;  \n    &lt;/book&gt;  \n&lt;/bookstore&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Xml_XPath_XPathExpression_SetContext_System_Xml_XmlNamespaceManager_\">\r\n    \r\n            <a id=\"System_Xml_XPath_XPathExpression_SetContext_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">SetContext(XmlNamespaceManager)</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, specifies the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object to use for namespace resolution.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public abstract void SetContext (System.Xml.XmlNamespaceManager nsManager);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>nsManager</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object to use for namespace resolution.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.xml.xpath.xpathexception\" data-linktype=\"relative-path\">XPathException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object parameter is not derived from the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> class.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Namespace resolution is supported using the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> class which stores prefix and namespace Uniform Resource Identifier (URI) mappings. If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> requires namespace resolution, the prefix and namespace URI pair must be added to the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object and the SetContext method must be called to specify the <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object to use for namespace resolution.  </p>\n<p> The following are important notes to consider when using the SetContext method.  </p>\n<ul>\n<li><p>If the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> does not include a prefix, it is assumed that the namespace URI is the empty namespace. If your XML includes a default namespace, you must still use the SetContext method and provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object that contains a prefix and namespace URI to handle the default namespace.  </p>\n</li>\n<li><p>You can also supply an <a class=\"xref\" href=\"system.xml.ixmlnamespaceresolver\" data-linktype=\"relative-path\">IXmlNamespaceResolver</a> object for namespace resolution to the <a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_Compile_\" data-linktype=\"relative-path\">Compile</a> method when you create your <a class=\"xref\" href=\"system.xml.xpath.xpathexpression\" data-linktype=\"relative-path\">XPathExpression</a> object.  </p>\n</li>\n<li><p><a class=\"xref\" href=\"system.xml.xpath.xpathexpression#System_Xml_XPath_XPathExpression_SetContext_\" data-linktype=\"relative-path\">SetContext</a> accepts <a class=\"xref\" href=\"system.xml.xsl.xsltcontext\" data-linktype=\"relative-path\">XsltContext</a> as a namespace resolver, so you can implement a custom context and use functions and variables based on <a class=\"xref\" href=\"system.xml.xsl.ixsltcontextfunction\" data-linktype=\"relative-path\">IXsltContextFunction</a> and <a class=\"xref\" href=\"system.xml.xsl.ixsltcontextvariable\" data-linktype=\"relative-path\">IXsltContextVariable</a>. The XPath expression will execute them. For more information, see <a href=\"../Topic/User%20Defined%20Functions%20and%20Variables.md\" data-linktype=\"relative-path\">User Defined Functions and Variables</a>.</p>\n</li>\n</ul>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following example shows how to use the XPath return type to determine how to process the XPath expression, and how to use the SetContext method to provide an <a class=\"xref\" href=\"system.xml.xmlnamespacemanager\" data-linktype=\"relative-path\">XmlNamespaceManager</a> object for namespace resolution.  </p>\n<pre><code class=\"lang-cs\" name=\"XPathExpression.ReturnType#1\">using System;\nusing System.Xml;\nusing System.Xml.XPath;\n\npublic class XPathExpressionExample\n{\n    public static void Main()\n    {\n        XPathDocument document = new XPathDocument(&quot;contosoBooks.xml&quot;);\n        XPathNavigator navigator = document.CreateNavigator();\n\n        XPathExpression expression1 = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;); // Returns a number.\n        XPathExpression expression2 = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;); // Returns a nodeset.\n\n        XmlNamespaceManager manager = new XmlNamespaceManager(navigator.NameTable);\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;);\n\n        expression1.SetContext(manager);\n        expression2.SetContext(manager);\n\n        Evaluate(expression1, navigator);\n        Evaluate(expression2, navigator);\n    }\n\n    public static void Evaluate(XPathExpression expression, XPathNavigator navigator)\n    {\n        switch (expression.ReturnType)\n        {\n            case XPathResultType.Number:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n\n            case XPathResultType.NodeSet:\n                XPathNodeIterator nodes = navigator.Select(expression);\n                while (nodes.MoveNext())\n                {\n                    Console.WriteLine(nodes.Current.ToString());\n                }\n                break;\n\n            case XPathResultType.Boolean:\n                if ((bool)navigator.Evaluate(expression))\n                    Console.WriteLine(&quot;True!&quot;);\n                break;\n\n            case XPathResultType.String:\n                Console.WriteLine(navigator.Evaluate(expression));\n                break;\n        }\n    }\n}\n</code></pre><pre><code class=\"lang-cpp\" name=\"XPathExpression.ReturnType#1\">public ref class Sample\n{\npublic:\n   static void Evaluate( XPathExpression^ expr, XPathNavigator^ nav )\n   {\n      XPathNodeIterator^ i = nav-&gt;Select(expr);\n      switch ( expr-&gt;ReturnType )\n      {\n         case XPathResultType::Number:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n\n         case XPathResultType::NodeSet:\n            while ( i-&gt;MoveNext() )\n                        Console::WriteLine( i-&gt;Current );\n            break;\n\n         case XPathResultType::Boolean:\n            if ( *safe_cast&lt;bool^&gt;(nav-&gt;Evaluate( expr )) )\n                        Console::WriteLine( &quot;True!&quot; );\n            break;\n\n         case XPathResultType::String:\n            Console::WriteLine( nav-&gt;Evaluate( expr ) );\n            break;\n      }\n   }\n\n};\n\nint main()\n{\n   XPathDocument^ doc = gcnew XPathDocument( &quot;contosoBooks.xml&quot; );\n   XPathNavigator^ nav = doc-&gt;CreateNavigator();\n   XPathExpression^ expr1 = nav-&gt;Compile( &quot;.//price/text()*10&quot; ); // Returns a number.\n\n   XPathExpression^ expr2 = nav-&gt;Compile( &quot;bookstore/book/price&quot; ); // Returns a nodeset.\n\n   Sample^ MySample = gcnew Sample;\n   MySample-&gt;Evaluate( expr1, nav );\n   MySample-&gt;Evaluate( expr2, nav );\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"XPathExpression.ReturnType#1\">Imports System\nImports System.Xml\nImports System.Xml.XPath\n\nPublic Class XPathExpressionExample\n\n    Public Shared Sub Main()\n        Dim document As XPathDocument = New XPathDocument(&quot;contosoBooks.xml&quot;)\n        Dim navigator As XPathNavigator = document.CreateNavigator()\n\n        Dim expression1 As XPathExpression = XPathExpression.Compile(&quot;.//bk:price/text()*10&quot;)  &#39; Returns a number.\n        Dim expression2 As XPathExpression = XPathExpression.Compile(&quot;bk:bookstore/bk:book/bk:price&quot;)  &#39; Returns a nodeset.\n\n        Dim manager As XmlNamespaceManager = New XmlNamespaceManager(navigator.NameTable)\n        manager.AddNamespace(&quot;bk&quot;, &quot;http://www.contoso.com/books&quot;)\n\n        expression1.SetContext(manager)\n        expression2.SetContext(manager)\n\n        Evaluate(expression1, navigator)\n        Evaluate(expression2, navigator)\n\n    End Sub\n\n    Public Shared Sub Evaluate(ByVal expression As XPathExpression, ByVal navigator As XPathNavigator)\n\n        Select Case expression.ReturnType\n            Case XPathResultType.Number\n                Console.WriteLine(navigator.Evaluate(expression))\n                Exit Sub\n\n            Case XPathResultType.NodeSet\n                Dim nodes As XPathNodeIterator = navigator.Select(expression)\n                While nodes.MoveNext()\n                    Console.WriteLine(nodes.Current.ToString())\n                End While\n\n            Case XPathResultType.Boolean\n                If CType(navigator.Evaluate(expression), Boolean) Then\n                    Console.WriteLine(&quot;True!&quot;)\n                End If\n\n            Case XPathResultType.String\n                Console.WriteLine(navigator.Evaluate(expression))\n        End Select\n\n    End Sub\nEnd Class\n</code></pre><p> The example takes the <code>contosoBooks.xml</code> file as input.  </p>\n<pre><code class=\"lang-xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;  \n&lt;bookstore xmlns=&quot;http://www.contoso.com/books&quot;&gt;  \n    &lt;book genre=&quot;autobiography&quot; publicationdate=&quot;1981-03-22&quot; ISBN=&quot;1-861003-11-0&quot;&gt;  \n        &lt;title&gt;The Autobiography of Benjamin Franklin&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Benjamin&lt;/first-name&gt;  \n            &lt;last-name&gt;Franklin&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;8.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;novel&quot; publicationdate=&quot;1967-11-17&quot; ISBN=&quot;0-201-63361-2&quot;&gt;  \n        &lt;title&gt;The Confidence Man&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;first-name&gt;Herman&lt;/first-name&gt;  \n            &lt;last-name&gt;Melville&lt;/last-name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;11.99&lt;/price&gt;  \n    &lt;/book&gt;  \n    &lt;book genre=&quot;philosophy&quot; publicationdate=&quot;1991-02-15&quot; ISBN=&quot;1-861001-57-6&quot;&gt;  \n        &lt;title&gt;The Gorgias&lt;/title&gt;  \n        &lt;author&gt;  \n            &lt;name&gt;Plato&lt;/name&gt;  \n        &lt;/author&gt;  \n        &lt;price&gt;9.99&lt;/price&gt;  \n    &lt;/book&gt;  \n&lt;/bookstore&gt;\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Xml.XPath.XPathExpression.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Xml.XPath.XPathExpression.yml\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression.AddSort\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression.Clone\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression.Compile\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression.Expression\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression.ReturnType\">\r\n<meta name=\"APIName\" content=\"System.Xml.XPath.XPathExpression.SetContext\">\r\n<meta name=\"APILocation\" content=\"System.Xml.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"fdde6a52-fb21-6a05-30af-8058dba23762\">\r\n<meta name=\"original_ecmaxml_local_path\" content=\"W:\\vejk\\s\\fulldocset\\xml\\System.Xml.XPath\\XPathExpression.xml\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides a typed class that represents a compiled XPath expression.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Xml.XPath/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Xml.XPath.XPathExpression\">\r\n","rawMetadata":{"breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Xml.XPath.XPathExpression.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Xml.XPath.XPathExpression.yml","open_to_public_contributors":true,"api_name":["System.Xml.XPath.XPathExpression","System.Xml.XPath.XPathExpression.AddSort","System.Xml.XPath.XPathExpression.Clone","System.Xml.XPath.XPathExpression.Compile","System.Xml.XPath.XPathExpression.Expression","System.Xml.XPath.XPathExpression.ReturnType","System.Xml.XPath.XPathExpression.SetContext"],"api_location":["System.Xml.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Xml.XPath.XPathExpression","System::Xml::XPath::XPathExpression","System.Xml.XPath.XPathExpression.AddSort","System::Xml::XPath::XPathExpression::AddSort","System.Xml.XPath.XPathExpression.Clone","System::Xml::XPath::XPathExpression::Clone","System.Xml.XPath.XPathExpression.Compile","System::Xml::XPath::XPathExpression::Compile","System.Xml.XPath.XPathExpression.Expression","System::Xml::XPath::XPathExpression::Expression","System.Xml.XPath.XPathExpression.ReturnType","System::Xml::XPath::XPathExpression::ReturnType","System.Xml.XPath.XPathExpression.SetContext","System::Xml::XPath::XPathExpression::SetContext"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"fdde6a52-fb21-6a05-30af-8058dba23762","original_ecmaxml_local_path":"W:\\vejk\\s\\fulldocset\\xml\\System.Xml.XPath\\XPathExpression.xml","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Xml.XPath/XPathExpression.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"XPathExpression class | Microsoft Docs","_op_ogTitle":"XPathExpression class","description":"Provides a typed class that represents a compiled XPath expression.\n","toc_asset_id":"_splitted/System.Xml.XPath/toc.json","toc_rel":"_splitted/System.Xml.XPath/toc.json","source_url":"","ms.assetid":"System.Xml.XPath.XPathExpression","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.xml.xpath.xpathexpression","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.xml.xpath.xpathexpression","fileRelativePath":"System.Xml.XPath.XPathExpression.html"},"themesRelativePathToOutputRoot":"_themes/"}