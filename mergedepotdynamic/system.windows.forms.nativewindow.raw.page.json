{"content":"    \r\n    <h1 id=\"System_Windows_Forms_NativeWindow\">\r\n      <span class=\"lang-csharp\">NativeWindow</span>\r\n        Class\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t<p>Provides a low-level encapsulation of a window handle and a window procedure.</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public class NativeWindow : MarshalByRefObject, System.Windows.Forms.IWin32Window</code></pre>\r\n    \r\n    \r\n    \r\n    <h3>Inheritance Hierarchy</h3>\r\n    <ul class=\"inheritance\">\r\n        <li class=\"l0\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a>\r\n          </div>\r\n        </li>\r\n        <li class=\"l1\">\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.marshalbyrefobject\" data-linktype=\"relative-path\">System.MarshalByRefObject</a>\r\n          </div>\r\n        </li>\r\n      <li class=\"l2\">\r\n        <div class=\"xref\">\r\n          <div class=\"lang-csharp\">NativeWindow</div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4></h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_CreateObjRef_System_Type_\" data-linktype=\"relative-path\">CreateObjRef(Type)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_GetLifetimeService\" data-linktype=\"relative-path\">GetLifetimeService()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_InitializeLifetimeService\" data-linktype=\"relative-path\">InitializeLifetimeService()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_MemberwiseClone_System_Boolean_\" data-linktype=\"relative-path\">MemberwiseClone(Boolean)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a>\r\n          </div>\r\n          , \r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>This class automatically manages window class creation and registration.  </p>\n<p> A window is not eligible for garbage collection when it is associated with a window handle. To ensure proper garbage collection, handles must either be destroyed manually using <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_DestroyHandle_\" data-linktype=\"relative-path\">DestroyHandle</a> or released using <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a> method is called when the WM_NCDESTROY message is processed. This means there are cases in which when you do not need to manually call <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a>, but it is good practice to do so.  </p>\n</div>\n<p> The NativeWindow class provides the following properties and methods to manage handles: <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a>, <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_CreateHandle_\" data-linktype=\"relative-path\">CreateHandle</a>, <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_AssignHandle_\" data-linktype=\"relative-path\">AssignHandle</a>, <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_DestroyHandle_\" data-linktype=\"relative-path\">DestroyHandle</a>, and <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a>.</p>\n\r\n    \r\n    \r\n    <h2>Constructors\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow__ctor\" data-linktype=\"self-bookmark\">NativeWindow()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Initializes an instance of the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_Handle\" data-linktype=\"self-bookmark\">Handle</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Gets the handle for this window.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_AssignHandle_System_IntPtr_\" data-linktype=\"self-bookmark\">AssignHandle(IntPtr)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Assigns a handle to this window.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_CreateHandle_System_Windows_Forms_CreateParams_\" data-linktype=\"self-bookmark\">CreateHandle(CreateParams)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Creates a window and its handle with the specified creation parameters.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_DefWndProc_System_Windows_Forms_Message__\" data-linktype=\"self-bookmark\">DefWndProc(Message)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Invokes the default window procedure associated with this window.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_DestroyHandle\" data-linktype=\"self-bookmark\">DestroyHandle()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Destroys the window and its handle.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_Finalize\" data-linktype=\"self-bookmark\">Finalize()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Releases the resources associated with this window.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_FromHandle_System_IntPtr_\" data-linktype=\"self-bookmark\">FromHandle(IntPtr)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Retrieves the window associated with the specified handle.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_OnHandleChange\" data-linktype=\"self-bookmark\">OnHandleChange()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Specifies a notification method that is called when the handle for a window is changed.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_OnThreadException_System_Exception_\" data-linktype=\"self-bookmark\">OnThreadException(Exception)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>When overridden in a derived class, manages an unhandled thread exception.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_ReleaseHandle\" data-linktype=\"self-bookmark\">ReleaseHandle()</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Releases the handle associated with this window.</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#System_Windows_Forms_NativeWindow_WndProc_System_Windows_Forms_Message__\" data-linktype=\"self-bookmark\">WndProc(Message)</a></div>\r\n          </td>\r\n            <td>\r\n            <p>Invokes the default window procedure associated with this window.</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"constructors\">\r\n        <h2>Constructors\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow__ctor\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow__ctor_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">NativeWindow()</div>        \r\n          </div>\r\n    \r\n            <p>Initializes an instance of the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public NativeWindow ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This is the default NativeWindow constructor provided by the compiler. The <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class also has a static constructor that initializes application domain-wide message handlers and hash tables.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_Handle\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_Handle_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Handle</div>        \r\n          </div>\r\n    \r\n            <p>Gets the handle for this window.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public IntPtr Handle { get; }</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.intptr\" data-linktype=\"relative-path\">IntPtr</a></div>\r\n                  </div>\r\n                  <p>If successful, an <a class=\"xref\" href=\"system.intptr\" data-linktype=\"relative-path\">IntPtr</a> representing the handle to the associated native Win32 window; otherwise, 0 if no handle is associated with the window.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Use this method when calling Windows API methods that require a handle for a window or control.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates creating a window with a specific operating system window class name. The example creates a class that inherits from <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> to accomplish this. The example also demonstrates overriding the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_OnHandleChange_\" data-linktype=\"relative-path\">OnHandleChange</a> method to be notified when the Handle changes.  </p>\n<p> The <code>MyNativeWindow</code> class creates a new window with the <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_ClassName_\" data-linktype=\"relative-path\">ClassName</a> set to BUTTON. This creates a Win32 button window. The location and size of the button is set, along with specifying additional window styles. The class demonstrates how to use the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_CreateHandle_\" data-linktype=\"relative-path\">CreateHandle</a> method and override the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_WndProc_\" data-linktype=\"relative-path\">WndProc</a> method to intercept window messages that are received. Although the example looks for the WM_ACTIVATEAPP message, this could be replaced in a real program with window messages specific to the type created.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Some control types send their window messages to the window parent instead of the window. See the Windows Platform SDK for more information.  </p>\n</div>\n<pre><code class=\"lang-cpp\" name=\"NativeWindow#3\">// MyNativeWindow class to create a window given a class name.\nref class MyNativeWindow: public NativeWindow\n{\nprivate:\n\n   // Constant values were found in the S&quot;windows.h&quot; header file.\n   literal int WS_CHILD = 0x40000000,WS_VISIBLE = 0x10000000,WM_ACTIVATEAPP = 0x001C;\n   int windowHandle;\n\npublic:\n   MyNativeWindow( Form^ parent )\n   {\n      CreateParams^ cp = gcnew CreateParams;\n\n      // Fill in the CreateParams details.\n      cp-&gt;Caption = &quot;Click here&quot;;\n      cp-&gt;ClassName = &quot;Button&quot;;\n\n      // Set the position on the form\n      cp-&gt;X = 100;\n      cp-&gt;Y = 100;\n      cp-&gt;Height = 100;\n      cp-&gt;Width = 100;\n\n      // Specify the form as the parent.\n      cp-&gt;Parent = parent-&gt;Handle;\n\n      // Create as a child of the specified parent\n      cp-&gt;Style = WS_CHILD | WS_VISIBLE;\n\n      // Create the actual window\n      this-&gt;CreateHandle( cp );\n   }\n\nprotected:\n\n   // Listen to when the handle changes to keep the variable in sync\n\n   virtual void OnHandleChange() override\n   {\n      windowHandle = (int)this-&gt;Handle;\n   }\n\n   virtual void WndProc( Message % m ) override\n   {\n      // Listen for messages that are sent to the button window. Some messages are sent\n      // to the parent window instead of the button&#39;s window.\n      switch ( m.Msg )\n      {\n         case WM_ACTIVATEAPP:\n            \n            // Do something here in response to messages\n            break;\n      }\n      NativeWindow::WndProc( m );\n   }\n};\n</code></pre><pre><code class=\"lang-cs\" name=\"NativeWindow#3\">    // MyNativeWindow class to create a window given a class name.\n    [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n    internal class MyNativeWindow : NativeWindow\n    {\n\n        // Constant values were found in the &quot;windows.h&quot; header file.\n        private const int WS_CHILD = 0x40000000,\n                          WS_VISIBLE = 0x10000000,\n                          WM_ACTIVATEAPP = 0x001C;\n\n        private int windowHandle;\n\n        public MyNativeWindow(Form parent)\n        {\n\n            CreateParams cp = new CreateParams();\n\n            // Fill in the CreateParams details.\n            cp.Caption = &quot;Click here&quot;;\n            cp.ClassName = &quot;Button&quot;;\n\n            // Set the position on the form\n            cp.X = 100;\n            cp.Y = 100;\n            cp.Height = 100;\n            cp.Width = 100;\n\n            // Specify the form as the parent.\n            cp.Parent = parent.Handle;\n\n            // Create as a child of the specified parent\n            cp.Style = WS_CHILD | WS_VISIBLE;\n\n            // Create the actual window\n            this.CreateHandle(cp);\n        }\n\n        // Listen to when the handle changes to keep the variable in sync\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void OnHandleChange()\n        {\n            windowHandle = (int)this.Handle;\n        }\n\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void WndProc(ref Message m)\n        {\n            // Listen for messages that are sent to the button window. Some messages are sent\n            // to the parent window instead of the button&#39;s window.\n\n            switch (m.Msg)\n            {\n                case WM_ACTIVATEAPP:\n                    // Do something here in response to messages\n                    break;\n            }\n            base.WndProc(ref m);\n        }\n    }\n</code></pre><pre><code class=\"lang-vb\" name=\"NativeWindow#3\">&#39; MyNativeWindow class to create a window given a class name.\n&lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\nFriend Class MyNativeWindow\n    Inherits NativeWindow\n\n    &#39; Constant values were found in the &quot;windows.h&quot; header file.\n    Private Const WS_CHILD As Integer = &amp;H40000000, _\n                  WS_VISIBLE As Integer = &amp;H10000000, _\n                  WM_ACTIVATEAPP As Integer = &amp;H1C\n\n    Private windowHandle As Integer\n\n    Public Sub New(ByVal parent As Form)\n\n        Dim cp As CreateParams = New CreateParams()\n\n        &#39; Fill in the CreateParams details.\n        cp.Caption = &quot;Click here&quot;\n        cp.ClassName = &quot;Button&quot;\n\n        &#39; Set the position on the form\n        cp.X = 100\n        cp.Y = 100\n        cp.Height = 100\n        cp.Width = 100\n\n        &#39; Specify the form as the parent.\n        cp.Parent = parent.Handle\n\n        &#39; Create as a child of the specified parent\n        cp.Style = WS_CHILD Or WS_VISIBLE\n\n        &#39; Create the actual window\n        Me.CreateHandle(cp)\n    End Sub\n\n    &#39; Listen to when the handle changes to keep the variable in sync\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n    Protected Overrides Sub OnHandleChange()\n        windowHandle = Me.Handle.ToInt32()\n    End Sub\n\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n        Protected Overrides Sub WndProc(ByRef m As Message)\n        &#39; Listen for messages that are sent to the button window. Some messages are sent\n        &#39; to the parent window instead of the button&#39;s window.\n\n        Select Case (m.Msg)\n            Case WM_ACTIVATEAPP\n                &#39; Do something here in response to messages\n        End Select\n\n        MyBase.WndProc(m)\n    End Sub\n\nEnd Class\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_AssignHandle_System_IntPtr_\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_AssignHandle_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">AssignHandle(IntPtr)</div>        \r\n          </div>\r\n    \r\n            <p>Assigns a handle to this window.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void AssignHandle (IntPtr handle);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>handle</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.intptr\" data-linktype=\"relative-path\">IntPtr</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The handle to assign to this window.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a></div>\r\n                  </div>\r\n                  <p>This window already has a handle.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.win32exception\" data-linktype=\"relative-path\">Win32Exception</a></div>\r\n                  </div>\r\n                  <p>The windows procedure for the associated native window could not be retrieved.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p><a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_WndProc_\" data-linktype=\"relative-path\">WndProc</a> intercepts window messages sent to the <code>handle</code> parameter. Use <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a> to reset the handle&#39;s window procedure to the default window procedure.  </p>\n<p> The AssignHandle method calls the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_OnHandleChange_\" data-linktype=\"relative-path\">OnHandleChange</a> method to indicate that the value of the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a> property has changed.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The handle to assign cannot be in a different application process.</p>\n</div>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates intercepting operating system window messages in a window procedure. The example creates a class that inherits from <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> to accomplish this.  </p>\n<p> The <code>MyNativeWindowListener</code> class hooks into the window procedure of the form passed into the constructor, and overrides the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_WndProc_\" data-linktype=\"relative-path\">WndProc</a> method to intercepts the <code>WM_ACTIVATEAPP</code> window message. The class demonstrates the use of the AssignHandle and <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a> methods to identify which window handle the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> will use. The handle is assigned based upon the <a class=\"xref\" href=\"system.windows.forms.control#System_Windows_Forms_Control_HandleCreated\" data-linktype=\"relative-path\">System.Windows.Forms.Control.HandleCreated</a> and <a class=\"xref\" href=\"system.windows.forms.control#System_Windows_Forms_Control_HandleDestroyed\" data-linktype=\"relative-path\">System.Windows.Forms.Control.HandleDestroyed</a> events. When the <code>WM_ACTIVATEAPP</code> window message is received, the class calls the <code>form1``ApplicationActivated</code> method.  </p>\n<p> This code is an excerpt from the example shown in the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class overview. Some code is not shown for the purpose of brevity. See <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> for the whole code listing.  </p>\n<pre><code class=\"lang-cpp\" name=\"NativeWindow#2\">// NativeWindow class to listen to operating system messages.\nref class MyNativeWindowListener: public NativeWindow\n{\nprivate:\n\n   // Constant value was found in the S&quot;windows.h&quot; header file.\n   literal int WM_ACTIVATEAPP = 0x001C;\n   Form1^ parent;\n\npublic:\n   MyNativeWindowListener( Form1^ parent )\n   {\n      parent-&gt;HandleCreated += gcnew EventHandler( this, &amp;MyNativeWindowListener::OnHandleCreated );\n      parent-&gt;HandleDestroyed += gcnew EventHandler( this, &amp;MyNativeWindowListener::OnHandleDestroyed );\n      this-&gt;parent = parent;\n   }\n\ninternal:\n\n   // Listen for the control&#39;s window creation and then hook into it.\n   void OnHandleCreated( Object^ sender, EventArgs^ /*e*/ )\n   {\n      // Window is now created, assign handle to NativeWindow.\n      AssignHandle( (dynamic_cast&lt;Form1^&gt;(sender))-&gt;Handle );\n   }\n\n   void OnHandleDestroyed( Object^ /*sender*/, EventArgs^ /*e*/ )\n   {\n      // Window was destroyed, release hook.\n      ReleaseHandle();\n   }\n\nprotected:\n\n   virtual void WndProc( Message %m ) override\n   {\n      // Listen for operating system messages\n      switch ( m.Msg )\n      {\n         case WM_ACTIVATEAPP:\n\n            // Notify the form that this message was received.\n            // Application is activated or deactivated,\n            // based upon the WParam parameter.\n            parent-&gt;ApplicationActived( ((int)m.WParam != 0) );\n            break;\n      }\n      NativeWindow::WndProc( m );\n   }\n\n};\n</code></pre><pre><code class=\"lang-cs\" name=\"NativeWindow#2\">    // NativeWindow class to listen to operating system messages.\n    [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n    internal class MyNativeWindowListener : NativeWindow\n    {\n\n        // Constant value was found in the &quot;windows.h&quot; header file.\n        private const int WM_ACTIVATEAPP = 0x001C;\n\n        private Form1 parent;\n\n        public MyNativeWindowListener(Form1 parent)\n        {\n\n            parent.HandleCreated += new EventHandler(this.OnHandleCreated);\n            parent.HandleDestroyed += new EventHandler(this.OnHandleDestroyed);\n            this.parent = parent;\n        }\n\n        // Listen for the control&#39;s window creation and then hook into it.\n        internal void OnHandleCreated(object sender, EventArgs e)\n        {\n            // Window is now created, assign handle to NativeWindow.\n            AssignHandle(((Form1)sender).Handle);\n        }\n        internal void OnHandleDestroyed(object sender, EventArgs e)\n        {\n            // Window was destroyed, release hook.\n            ReleaseHandle();\n        }\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void WndProc(ref Message m)\n        {\n            // Listen for operating system messages\n\n            switch (m.Msg)\n            {\n                case WM_ACTIVATEAPP:\n\n                    // Notify the form that this message was received.\n                    // Application is activated or deactivated, \n                    // based upon the WParam parameter.\n                    parent.ApplicationActivated(((int)m.WParam != 0));\n\n                    break;\n            }\n            base.WndProc(ref m);\n        }\n    }\n</code></pre><pre><code class=\"lang-vb\" name=\"NativeWindow#2\">&#39; NativeWindow class to listen to operating system messages.\nFriend Class MyNativeWindowListener\n    Inherits NativeWindow\n\n    &#39; Constant value was found in the &quot;windows.h&quot; header file.\n    Private Const WM_ACTIVATEAPP As Integer = &amp;H1C\n\n    Private parent As Form1\n\n    Public Sub New(ByVal parent As Form1)\n\n        AddHandler parent.HandleCreated, AddressOf Me.OnHandleCreated\n        AddHandler parent.HandleDestroyed, AddressOf Me.OnHandleDestroyed\n        Me.parent = parent\n    End Sub\n\n    &#39; Listen for the control&#39;s window creation and hook into it.    \n    Private Sub OnHandleCreated(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; Window is now created, assign handle to NativeWindow.\n        AssignHandle(CType(sender, Form).Handle)\n    End Sub\n\n    Private Sub OnHandleDestroyed(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; Window was destroyed, release hook.\n        ReleaseHandle()\n    End Sub\n\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n        Protected Overrides Sub WndProc(ByRef m As Message)\n        &#39; Listen for operating system messages\n\n        Select Case (m.Msg)\n            Case WM_ACTIVATEAPP\n\n                &#39; Notify the form that this message was received.\n                &#39; Application is activated or deactivated, \n                &#39; based upon the WParam parameter.\n                parent.ApplicationActivated(m.WParam.ToInt32() &lt;&gt; 0)\n\n        End Select\n\n        MyBase.WndProc(m)\n    End Sub\nEnd Class\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_CreateHandle_System_Windows_Forms_CreateParams_\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_CreateHandle_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">CreateHandle(CreateParams)</div>        \r\n          </div>\r\n    \r\n            <p>Creates a window and its handle with the specified creation parameters.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual void CreateHandle (System.Windows.Forms.CreateParams cp);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>cp</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.createparams\" data-linktype=\"relative-path\">CreateParams</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A <a class=\"xref\" href=\"system.windows.forms.createparams\" data-linktype=\"relative-path\">CreateParams</a> that specifies the creation parameters for this window.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.outofmemoryexception\" data-linktype=\"relative-path\">OutOfMemoryException</a></div>\r\n                  </div>\r\n                  <p>The operating system ran out of resources when trying to create the native window.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.win32exception\" data-linktype=\"relative-path\">Win32Exception</a></div>\r\n                  </div>\r\n                  <p>The native Win32 API could not create the specified window.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>The handle of the current native window is already assigned; in explanation, the <span class=\"xref\">stem.Windows.Forms.NativeWindow.Handle*</span> property is not equal to <a class=\"xref\" href=\"system.intptr#System_IntPtr_Zero\" data-linktype=\"relative-path\">Zero</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The <code>cp</code> parameter specifies the values that are passed to the native Win32 <code>CreateWindowEx</code> method to create a window and its handle.  </p>\n<p> When the <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_ClassName_\" data-linktype=\"relative-path\">ClassName</a> field is not <code>null</code>, the newly created window handle inherits from the specified class. For example, if <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_ClassName_\" data-linktype=\"relative-path\">ClassName</a> is set to <code>BUTTON</code>, the newly created window is based on the Win32 <code>BUTTON</code> window class. The <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_Param_\" data-linktype=\"relative-path\">Param</a> property of the <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_ClassName_\" data-linktype=\"relative-path\">ClassName</a> object must either be <code>null</code> or reference an instance of a class that was declared as a structure.  </p>\n<p> This code is an excerpt from the example shown in the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class overview. Some code is not shown for the purpose of brevity. See <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> for the whole code listing.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The class name provided is registered with the operating system.</p>\n</div>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates creating a window with a specific operating system window class name. The example creates a class that inherits from <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> to accomplish this.  </p>\n<p> The <code>MyNativeWindow</code> class creates a new window with the <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_ClassName_\" data-linktype=\"relative-path\">ClassName</a> set to <code>BUTTON</code>. This creates a Win32 button window. The location and size of the button is set, along with specifying additional window styles. The class demonstrates how to use the CreateHandle method and override the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_WndProc_\" data-linktype=\"relative-path\">WndProc</a> method to intercept window messages that are received. Although the example looks for the WM_ACTIVATEAPP message, this can be replaced in a real program with window messages specific to the type created.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Some control types send their window messages to the window parent instead of the window. See the Windows Platform SDK for more information.  </p>\n</div>\n<pre><code class=\"lang-cpp\" name=\"NativeWindow#3\">// MyNativeWindow class to create a window given a class name.\nref class MyNativeWindow: public NativeWindow\n{\nprivate:\n\n   // Constant values were found in the S&quot;windows.h&quot; header file.\n   literal int WS_CHILD = 0x40000000,WS_VISIBLE = 0x10000000,WM_ACTIVATEAPP = 0x001C;\n   int windowHandle;\n\npublic:\n   MyNativeWindow( Form^ parent )\n   {\n      CreateParams^ cp = gcnew CreateParams;\n\n      // Fill in the CreateParams details.\n      cp-&gt;Caption = &quot;Click here&quot;;\n      cp-&gt;ClassName = &quot;Button&quot;;\n\n      // Set the position on the form\n      cp-&gt;X = 100;\n      cp-&gt;Y = 100;\n      cp-&gt;Height = 100;\n      cp-&gt;Width = 100;\n\n      // Specify the form as the parent.\n      cp-&gt;Parent = parent-&gt;Handle;\n\n      // Create as a child of the specified parent\n      cp-&gt;Style = WS_CHILD | WS_VISIBLE;\n\n      // Create the actual window\n      this-&gt;CreateHandle( cp );\n   }\n\nprotected:\n\n   // Listen to when the handle changes to keep the variable in sync\n\n   virtual void OnHandleChange() override\n   {\n      windowHandle = (int)this-&gt;Handle;\n   }\n\n   virtual void WndProc( Message % m ) override\n   {\n      // Listen for messages that are sent to the button window. Some messages are sent\n      // to the parent window instead of the button&#39;s window.\n      switch ( m.Msg )\n      {\n         case WM_ACTIVATEAPP:\n            \n            // Do something here in response to messages\n            break;\n      }\n      NativeWindow::WndProc( m );\n   }\n};\n</code></pre><pre><code class=\"lang-cs\" name=\"NativeWindow#3\">    // MyNativeWindow class to create a window given a class name.\n    [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n    internal class MyNativeWindow : NativeWindow\n    {\n\n        // Constant values were found in the &quot;windows.h&quot; header file.\n        private const int WS_CHILD = 0x40000000,\n                          WS_VISIBLE = 0x10000000,\n                          WM_ACTIVATEAPP = 0x001C;\n\n        private int windowHandle;\n\n        public MyNativeWindow(Form parent)\n        {\n\n            CreateParams cp = new CreateParams();\n\n            // Fill in the CreateParams details.\n            cp.Caption = &quot;Click here&quot;;\n            cp.ClassName = &quot;Button&quot;;\n\n            // Set the position on the form\n            cp.X = 100;\n            cp.Y = 100;\n            cp.Height = 100;\n            cp.Width = 100;\n\n            // Specify the form as the parent.\n            cp.Parent = parent.Handle;\n\n            // Create as a child of the specified parent\n            cp.Style = WS_CHILD | WS_VISIBLE;\n\n            // Create the actual window\n            this.CreateHandle(cp);\n        }\n\n        // Listen to when the handle changes to keep the variable in sync\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void OnHandleChange()\n        {\n            windowHandle = (int)this.Handle;\n        }\n\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void WndProc(ref Message m)\n        {\n            // Listen for messages that are sent to the button window. Some messages are sent\n            // to the parent window instead of the button&#39;s window.\n\n            switch (m.Msg)\n            {\n                case WM_ACTIVATEAPP:\n                    // Do something here in response to messages\n                    break;\n            }\n            base.WndProc(ref m);\n        }\n    }\n</code></pre><pre><code class=\"lang-vb\" name=\"NativeWindow#3\">&#39; MyNativeWindow class to create a window given a class name.\n&lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\nFriend Class MyNativeWindow\n    Inherits NativeWindow\n\n    &#39; Constant values were found in the &quot;windows.h&quot; header file.\n    Private Const WS_CHILD As Integer = &amp;H40000000, _\n                  WS_VISIBLE As Integer = &amp;H10000000, _\n                  WM_ACTIVATEAPP As Integer = &amp;H1C\n\n    Private windowHandle As Integer\n\n    Public Sub New(ByVal parent As Form)\n\n        Dim cp As CreateParams = New CreateParams()\n\n        &#39; Fill in the CreateParams details.\n        cp.Caption = &quot;Click here&quot;\n        cp.ClassName = &quot;Button&quot;\n\n        &#39; Set the position on the form\n        cp.X = 100\n        cp.Y = 100\n        cp.Height = 100\n        cp.Width = 100\n\n        &#39; Specify the form as the parent.\n        cp.Parent = parent.Handle\n\n        &#39; Create as a child of the specified parent\n        cp.Style = WS_CHILD Or WS_VISIBLE\n\n        &#39; Create the actual window\n        Me.CreateHandle(cp)\n    End Sub\n\n    &#39; Listen to when the handle changes to keep the variable in sync\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n    Protected Overrides Sub OnHandleChange()\n        windowHandle = Me.Handle.ToInt32()\n    End Sub\n\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n        Protected Overrides Sub WndProc(ByRef m As Message)\n        &#39; Listen for messages that are sent to the button window. Some messages are sent\n        &#39; to the parent window instead of the button&#39;s window.\n\n        Select Case (m.Msg)\n            Case WM_ACTIVATEAPP\n                &#39; Do something here in response to messages\n        End Select\n\n        MyBase.WndProc(m)\n    End Sub\n\nEnd Class\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_DefWndProc_System_Windows_Forms_Message__\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_DefWndProc_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">DefWndProc(Message)</div>        \r\n          </div>\r\n    \r\n            <p>Invokes the default window procedure associated with this window.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public void DefWndProc (ref System.Windows.Forms.Message m);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>m</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.message\" data-linktype=\"relative-path\">Message</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The message that is currently being processed.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Typically, you only call the DefWndProc method when you are intercepting window messages and would like the default window procedure to handle the message. DefWndProc should not be called to send a window message to the window; call the Win32 <code>SendMessage</code> function instead.  </p>\n<p> It is an error to call DefWndProc when the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a> property is 0.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_DestroyHandle\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_DestroyHandle_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">DestroyHandle()</div>        \r\n          </div>\r\n    \r\n            <p>Destroys the window and its handle.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual void DestroyHandle ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method destroys the window associated with the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a>, sets the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a> property to 0, and calls the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_OnHandleChange_\" data-linktype=\"relative-path\">OnHandleChange</a> method to reflect the change. Typically, you only call DestroyHandle when you are done with the native window.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class automatically will destroy the associated window and release its resources in response to a WM_DESTROY message.</p>\n</div>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_Finalize\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_Finalize_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Finalize()</div>        \r\n          </div>\r\n    \r\n            <p>Releases the resources associated with this window.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">~NativeWindow ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>The Finalize method removes the Win32 derived class associated with the current <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> instance, releases the handle, and posts a WM_CLOSE message to the associated window.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_FromHandle_System_IntPtr_\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_FromHandle_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">FromHandle(IntPtr)</div>        \r\n          </div>\r\n    \r\n            <p>Retrieves the window associated with the specified handle.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public static System.Windows.Forms.NativeWindow FromHandle (IntPtr handle);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>handle</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.intptr\" data-linktype=\"relative-path\">IntPtr</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A handle to a window.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> associated with the specified handle. This method returns <code>null</code> when the handle does not have an associated window.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>If you receive a handle from another method, use this method to retrieve the window associated with the handle. The handle must already be owned by another <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> in the current process; otherwise, <code>null</code> is returned.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_OnHandleChange\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_OnHandleChange_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OnHandleChange()</div>        \r\n          </div>\r\n    \r\n            <p>Specifies a notification method that is called when the handle for a window is changed.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual void OnHandleChange ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method is invoked when the value of the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a> property has changed.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates creating a window with a specific operating system window class name. The example creates a class that inherits from <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> to accomplish this. The example also demonstrates overriding the OnHandleChange method to be notified when the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a> changes.  </p>\n<p> The <code>MyNativeWindow</code> class creates a new window with the <a class=\"xref\" href=\"system.windows.forms.createparams#System_Windows_Forms_CreateParams_ClassName_\" data-linktype=\"relative-path\">ClassName</a> set to <code>BUTTON</code>. This creates a Win32 button window. The location and size of the button is set, along with specifying additional window styles. The class demonstrates how to use the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_CreateHandle_\" data-linktype=\"relative-path\">CreateHandle</a> method and override the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_WndProc_\" data-linktype=\"relative-path\">WndProc</a> method to intercept window messages that are received. Although the example looks for the WM_ACTIVATEAPP message, this can be replaced in a real program with window messages specific to the type created.  </p>\n<p> This code is an excerpt from the example shown in the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class overview. Some code is not shown for the purpose of brevity. See <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> for the whole code listing.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Some control types send their window messages to the window parent instead of the window. See the Windows Platform SDK for more information.  </p>\n</div>\n<pre><code class=\"lang-cpp\" name=\"NativeWindow#3\">// MyNativeWindow class to create a window given a class name.\nref class MyNativeWindow: public NativeWindow\n{\nprivate:\n\n   // Constant values were found in the S&quot;windows.h&quot; header file.\n   literal int WS_CHILD = 0x40000000,WS_VISIBLE = 0x10000000,WM_ACTIVATEAPP = 0x001C;\n   int windowHandle;\n\npublic:\n   MyNativeWindow( Form^ parent )\n   {\n      CreateParams^ cp = gcnew CreateParams;\n\n      // Fill in the CreateParams details.\n      cp-&gt;Caption = &quot;Click here&quot;;\n      cp-&gt;ClassName = &quot;Button&quot;;\n\n      // Set the position on the form\n      cp-&gt;X = 100;\n      cp-&gt;Y = 100;\n      cp-&gt;Height = 100;\n      cp-&gt;Width = 100;\n\n      // Specify the form as the parent.\n      cp-&gt;Parent = parent-&gt;Handle;\n\n      // Create as a child of the specified parent\n      cp-&gt;Style = WS_CHILD | WS_VISIBLE;\n\n      // Create the actual window\n      this-&gt;CreateHandle( cp );\n   }\n\nprotected:\n\n   // Listen to when the handle changes to keep the variable in sync\n\n   virtual void OnHandleChange() override\n   {\n      windowHandle = (int)this-&gt;Handle;\n   }\n\n   virtual void WndProc( Message % m ) override\n   {\n      // Listen for messages that are sent to the button window. Some messages are sent\n      // to the parent window instead of the button&#39;s window.\n      switch ( m.Msg )\n      {\n         case WM_ACTIVATEAPP:\n            \n            // Do something here in response to messages\n            break;\n      }\n      NativeWindow::WndProc( m );\n   }\n};\n</code></pre><pre><code class=\"lang-cs\" name=\"NativeWindow#3\">    // MyNativeWindow class to create a window given a class name.\n    [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n    internal class MyNativeWindow : NativeWindow\n    {\n\n        // Constant values were found in the &quot;windows.h&quot; header file.\n        private const int WS_CHILD = 0x40000000,\n                          WS_VISIBLE = 0x10000000,\n                          WM_ACTIVATEAPP = 0x001C;\n\n        private int windowHandle;\n\n        public MyNativeWindow(Form parent)\n        {\n\n            CreateParams cp = new CreateParams();\n\n            // Fill in the CreateParams details.\n            cp.Caption = &quot;Click here&quot;;\n            cp.ClassName = &quot;Button&quot;;\n\n            // Set the position on the form\n            cp.X = 100;\n            cp.Y = 100;\n            cp.Height = 100;\n            cp.Width = 100;\n\n            // Specify the form as the parent.\n            cp.Parent = parent.Handle;\n\n            // Create as a child of the specified parent\n            cp.Style = WS_CHILD | WS_VISIBLE;\n\n            // Create the actual window\n            this.CreateHandle(cp);\n        }\n\n        // Listen to when the handle changes to keep the variable in sync\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void OnHandleChange()\n        {\n            windowHandle = (int)this.Handle;\n        }\n\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void WndProc(ref Message m)\n        {\n            // Listen for messages that are sent to the button window. Some messages are sent\n            // to the parent window instead of the button&#39;s window.\n\n            switch (m.Msg)\n            {\n                case WM_ACTIVATEAPP:\n                    // Do something here in response to messages\n                    break;\n            }\n            base.WndProc(ref m);\n        }\n    }\n</code></pre><pre><code class=\"lang-vb\" name=\"NativeWindow#3\">&#39; MyNativeWindow class to create a window given a class name.\n&lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\nFriend Class MyNativeWindow\n    Inherits NativeWindow\n\n    &#39; Constant values were found in the &quot;windows.h&quot; header file.\n    Private Const WS_CHILD As Integer = &amp;H40000000, _\n                  WS_VISIBLE As Integer = &amp;H10000000, _\n                  WM_ACTIVATEAPP As Integer = &amp;H1C\n\n    Private windowHandle As Integer\n\n    Public Sub New(ByVal parent As Form)\n\n        Dim cp As CreateParams = New CreateParams()\n\n        &#39; Fill in the CreateParams details.\n        cp.Caption = &quot;Click here&quot;\n        cp.ClassName = &quot;Button&quot;\n\n        &#39; Set the position on the form\n        cp.X = 100\n        cp.Y = 100\n        cp.Height = 100\n        cp.Width = 100\n\n        &#39; Specify the form as the parent.\n        cp.Parent = parent.Handle\n\n        &#39; Create as a child of the specified parent\n        cp.Style = WS_CHILD Or WS_VISIBLE\n\n        &#39; Create the actual window\n        Me.CreateHandle(cp)\n    End Sub\n\n    &#39; Listen to when the handle changes to keep the variable in sync\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n    Protected Overrides Sub OnHandleChange()\n        windowHandle = Me.Handle.ToInt32()\n    End Sub\n\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n        Protected Overrides Sub WndProc(ByRef m As Message)\n        &#39; Listen for messages that are sent to the button window. Some messages are sent\n        &#39; to the parent window instead of the button&#39;s window.\n\n        Select Case (m.Msg)\n            Case WM_ACTIVATEAPP\n                &#39; Do something here in response to messages\n        End Select\n\n        MyBase.WndProc(m)\n    End Sub\n\nEnd Class\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_OnThreadException_System_Exception_\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_OnThreadException_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">OnThreadException(Exception)</div>        \r\n          </div>\r\n    \r\n            <p>When overridden in a derived class, manages an unhandled thread exception.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual void OnThreadException (Exception e);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>e</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>An <a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a> that specifies the unhandled thread exception.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>Typically, <a class=\"xref\" href=\"system.windows.forms.application#System_Windows_Forms_Application_OnThreadException_\" data-linktype=\"relative-path\">OnThreadException</a> handles thread exceptions.</p>\n\r\n    \r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_ReleaseHandle\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_ReleaseHandle_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">ReleaseHandle()</div>        \r\n          </div>\r\n    \r\n            <p>Releases the handle associated with this window.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public virtual void ReleaseHandle ();</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method does not destroy the window handle. Instead, it sets the handle&#39;s window procedure to the default window procedure. It sets the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_Handle_\" data-linktype=\"relative-path\">Handle</a> property to 0 and calls <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_OnHandleChange_\" data-linktype=\"relative-path\">OnHandleChange</a> to reflect the change.  </p>\n<p> A window automatically calls this method if it receives a native Win32 WM_NCDESTROY message, indicating that Windows has destroyed the handle.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates intercepting operating system window messages in a window procedure. The example creates a class that inherits from <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> to accomplish this.  </p>\n<p> The <code>MyNativeWindowListener</code> class hooks into the window procedure of the form passed into the constructor, and overrides the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_WndProc_\" data-linktype=\"relative-path\">WndProc</a> method to intercepts the <code>WM_ACTIVATEAPP</code> window message. The class demonstrates the use of the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_AssignHandle_\" data-linktype=\"relative-path\">AssignHandle</a> and ReleaseHandle methods to identify the window handle the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> will use. The handle is assign based upon the <a class=\"xref\" href=\"system.windows.forms.control#System_Windows_Forms_Control_HandleCreated\" data-linktype=\"relative-path\">System.Windows.Forms.Control.HandleCreated</a> and <a class=\"xref\" href=\"system.windows.forms.control#System_Windows_Forms_Control_HandleDestroyed\" data-linktype=\"relative-path\">System.Windows.Forms.Control.HandleDestroyed</a> events. When the <code>WM_ACTIVATEAPP</code> window message is received, the class calls the <code>form1``ApplicationActivated</code> method.  </p>\n<p> This code is an excerpt from the example shown in the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class overview. Some code is not shown for the purpose of brevity. See <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> for the whole code listing.  </p>\n<pre><code class=\"lang-cpp\" name=\"NativeWindow#2\">// NativeWindow class to listen to operating system messages.\nref class MyNativeWindowListener: public NativeWindow\n{\nprivate:\n\n   // Constant value was found in the S&quot;windows.h&quot; header file.\n   literal int WM_ACTIVATEAPP = 0x001C;\n   Form1^ parent;\n\npublic:\n   MyNativeWindowListener( Form1^ parent )\n   {\n      parent-&gt;HandleCreated += gcnew EventHandler( this, &amp;MyNativeWindowListener::OnHandleCreated );\n      parent-&gt;HandleDestroyed += gcnew EventHandler( this, &amp;MyNativeWindowListener::OnHandleDestroyed );\n      this-&gt;parent = parent;\n   }\n\ninternal:\n\n   // Listen for the control&#39;s window creation and then hook into it.\n   void OnHandleCreated( Object^ sender, EventArgs^ /*e*/ )\n   {\n      // Window is now created, assign handle to NativeWindow.\n      AssignHandle( (dynamic_cast&lt;Form1^&gt;(sender))-&gt;Handle );\n   }\n\n   void OnHandleDestroyed( Object^ /*sender*/, EventArgs^ /*e*/ )\n   {\n      // Window was destroyed, release hook.\n      ReleaseHandle();\n   }\n\nprotected:\n\n   virtual void WndProc( Message %m ) override\n   {\n      // Listen for operating system messages\n      switch ( m.Msg )\n      {\n         case WM_ACTIVATEAPP:\n\n            // Notify the form that this message was received.\n            // Application is activated or deactivated,\n            // based upon the WParam parameter.\n            parent-&gt;ApplicationActived( ((int)m.WParam != 0) );\n            break;\n      }\n      NativeWindow::WndProc( m );\n   }\n\n};\n</code></pre><pre><code class=\"lang-cs\" name=\"NativeWindow#2\">    // NativeWindow class to listen to operating system messages.\n    [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n    internal class MyNativeWindowListener : NativeWindow\n    {\n\n        // Constant value was found in the &quot;windows.h&quot; header file.\n        private const int WM_ACTIVATEAPP = 0x001C;\n\n        private Form1 parent;\n\n        public MyNativeWindowListener(Form1 parent)\n        {\n\n            parent.HandleCreated += new EventHandler(this.OnHandleCreated);\n            parent.HandleDestroyed += new EventHandler(this.OnHandleDestroyed);\n            this.parent = parent;\n        }\n\n        // Listen for the control&#39;s window creation and then hook into it.\n        internal void OnHandleCreated(object sender, EventArgs e)\n        {\n            // Window is now created, assign handle to NativeWindow.\n            AssignHandle(((Form1)sender).Handle);\n        }\n        internal void OnHandleDestroyed(object sender, EventArgs e)\n        {\n            // Window was destroyed, release hook.\n            ReleaseHandle();\n        }\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void WndProc(ref Message m)\n        {\n            // Listen for operating system messages\n\n            switch (m.Msg)\n            {\n                case WM_ACTIVATEAPP:\n\n                    // Notify the form that this message was received.\n                    // Application is activated or deactivated, \n                    // based upon the WParam parameter.\n                    parent.ApplicationActivated(((int)m.WParam != 0));\n\n                    break;\n            }\n            base.WndProc(ref m);\n        }\n    }\n</code></pre><pre><code class=\"lang-vb\" name=\"NativeWindow#2\">&#39; NativeWindow class to listen to operating system messages.\nFriend Class MyNativeWindowListener\n    Inherits NativeWindow\n\n    &#39; Constant value was found in the &quot;windows.h&quot; header file.\n    Private Const WM_ACTIVATEAPP As Integer = &amp;H1C\n\n    Private parent As Form1\n\n    Public Sub New(ByVal parent As Form1)\n\n        AddHandler parent.HandleCreated, AddressOf Me.OnHandleCreated\n        AddHandler parent.HandleDestroyed, AddressOf Me.OnHandleDestroyed\n        Me.parent = parent\n    End Sub\n\n    &#39; Listen for the control&#39;s window creation and hook into it.    \n    Private Sub OnHandleCreated(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; Window is now created, assign handle to NativeWindow.\n        AssignHandle(CType(sender, Form).Handle)\n    End Sub\n\n    Private Sub OnHandleDestroyed(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; Window was destroyed, release hook.\n        ReleaseHandle()\n    End Sub\n\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n        Protected Overrides Sub WndProc(ByRef m As Message)\n        &#39; Listen for operating system messages\n\n        Select Case (m.Msg)\n            Case WM_ACTIVATEAPP\n\n                &#39; Notify the form that this message was received.\n                &#39; Application is activated or deactivated, \n                &#39; based upon the WParam parameter.\n                parent.ApplicationActivated(m.WParam.ToInt32() &lt;&gt; 0)\n\n        End Select\n\n        MyBase.WndProc(m)\n    End Sub\nEnd Class\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"System_Windows_Forms_NativeWindow_WndProc_System_Windows_Forms_Message__\">\r\n    \r\n            <a id=\"System_Windows_Forms_NativeWindow_WndProc_\"></a>\r\n    \r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">WndProc(Message)</div>        \r\n          </div>\r\n    \r\n            <p>Invokes the default window procedure associated with this window.</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">protected virtual void WndProc (ref System.Windows.Forms.Message m);</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>m</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.message\" data-linktype=\"relative-path\">Message</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>A <a class=\"xref\" href=\"system.windows.forms.message\" data-linktype=\"relative-path\">Message</a> that is associated with the current Windows message.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n    \r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>This method is called when a window message is sent to the handle of the window.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>The following code example demonstrates intercepting operating system window messages in a window procedure. The example creates a class that inherits from <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> to accomplish this.  </p>\n<p> The <code>MyNativeWindowListener</code> class hooks into the window procedure of the form passed into the constructor, and overrides the WndProc method to intercept the <code>WM_ACTIVATEAPP</code> window message. The class demonstrates the use of the <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_AssignHandle_\" data-linktype=\"relative-path\">AssignHandle</a> and <a class=\"xref\" href=\"system.windows.forms.nativewindow#System_Windows_Forms_NativeWindow_ReleaseHandle_\" data-linktype=\"relative-path\">ReleaseHandle</a> methods to identify the window handle the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> will use. The handle is assigned based upon the <a class=\"xref\" href=\"system.windows.forms.control#System_Windows_Forms_Control_HandleCreated\" data-linktype=\"relative-path\">System.Windows.Forms.Control.HandleCreated</a> and <a class=\"xref\" href=\"system.windows.forms.control#System_Windows_Forms_Control_HandleDestroyed\" data-linktype=\"relative-path\">System.Windows.Forms.Control.HandleDestroyed</a> events. When the <code>WM_ACTIVATEAPP</code> window message is received, the class calls the <code>form1``ApplicationActivated</code> method.  </p>\n<p> This code is an excerpt from the example shown in the <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> class overview. Some code is not shown for the purpose of brevity. See <a class=\"xref\" href=\"system.windows.forms.nativewindow\" data-linktype=\"relative-path\">NativeWindow</a> for the whole code listing.  </p>\n<pre><code class=\"lang-cpp\" name=\"NativeWindow#2\">// NativeWindow class to listen to operating system messages.\nref class MyNativeWindowListener: public NativeWindow\n{\nprivate:\n\n   // Constant value was found in the S&quot;windows.h&quot; header file.\n   literal int WM_ACTIVATEAPP = 0x001C;\n   Form1^ parent;\n\npublic:\n   MyNativeWindowListener( Form1^ parent )\n   {\n      parent-&gt;HandleCreated += gcnew EventHandler( this, &amp;MyNativeWindowListener::OnHandleCreated );\n      parent-&gt;HandleDestroyed += gcnew EventHandler( this, &amp;MyNativeWindowListener::OnHandleDestroyed );\n      this-&gt;parent = parent;\n   }\n\ninternal:\n\n   // Listen for the control&#39;s window creation and then hook into it.\n   void OnHandleCreated( Object^ sender, EventArgs^ /*e*/ )\n   {\n      // Window is now created, assign handle to NativeWindow.\n      AssignHandle( (dynamic_cast&lt;Form1^&gt;(sender))-&gt;Handle );\n   }\n\n   void OnHandleDestroyed( Object^ /*sender*/, EventArgs^ /*e*/ )\n   {\n      // Window was destroyed, release hook.\n      ReleaseHandle();\n   }\n\nprotected:\n\n   virtual void WndProc( Message %m ) override\n   {\n      // Listen for operating system messages\n      switch ( m.Msg )\n      {\n         case WM_ACTIVATEAPP:\n\n            // Notify the form that this message was received.\n            // Application is activated or deactivated,\n            // based upon the WParam parameter.\n            parent-&gt;ApplicationActived( ((int)m.WParam != 0) );\n            break;\n      }\n      NativeWindow::WndProc( m );\n   }\n\n};\n</code></pre><pre><code class=\"lang-cs\" name=\"NativeWindow#2\">    // NativeWindow class to listen to operating system messages.\n    [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n    internal class MyNativeWindowListener : NativeWindow\n    {\n\n        // Constant value was found in the &quot;windows.h&quot; header file.\n        private const int WM_ACTIVATEAPP = 0x001C;\n\n        private Form1 parent;\n\n        public MyNativeWindowListener(Form1 parent)\n        {\n\n            parent.HandleCreated += new EventHandler(this.OnHandleCreated);\n            parent.HandleDestroyed += new EventHandler(this.OnHandleDestroyed);\n            this.parent = parent;\n        }\n\n        // Listen for the control&#39;s window creation and then hook into it.\n        internal void OnHandleCreated(object sender, EventArgs e)\n        {\n            // Window is now created, assign handle to NativeWindow.\n            AssignHandle(((Form1)sender).Handle);\n        }\n        internal void OnHandleDestroyed(object sender, EventArgs e)\n        {\n            // Window was destroyed, release hook.\n            ReleaseHandle();\n        }\n        [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name = &quot;FullTrust&quot;)]\n        protected override void WndProc(ref Message m)\n        {\n            // Listen for operating system messages\n\n            switch (m.Msg)\n            {\n                case WM_ACTIVATEAPP:\n\n                    // Notify the form that this message was received.\n                    // Application is activated or deactivated, \n                    // based upon the WParam parameter.\n                    parent.ApplicationActivated(((int)m.WParam != 0));\n\n                    break;\n            }\n            base.WndProc(ref m);\n        }\n    }\n</code></pre><pre><code class=\"lang-vb\" name=\"NativeWindow#2\">&#39; NativeWindow class to listen to operating system messages.\nFriend Class MyNativeWindowListener\n    Inherits NativeWindow\n\n    &#39; Constant value was found in the &quot;windows.h&quot; header file.\n    Private Const WM_ACTIVATEAPP As Integer = &amp;H1C\n\n    Private parent As Form1\n\n    Public Sub New(ByVal parent As Form1)\n\n        AddHandler parent.HandleCreated, AddressOf Me.OnHandleCreated\n        AddHandler parent.HandleDestroyed, AddressOf Me.OnHandleDestroyed\n        Me.parent = parent\n    End Sub\n\n    &#39; Listen for the control&#39;s window creation and hook into it.    \n    Private Sub OnHandleCreated(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; Window is now created, assign handle to NativeWindow.\n        AssignHandle(CType(sender, Form).Handle)\n    End Sub\n\n    Private Sub OnHandleDestroyed(ByVal sender As Object, ByVal e As EventArgs)\n        &#39; Window was destroyed, release hook.\n        ReleaseHandle()\n    End Sub\n\n    &lt;System.Security.Permissions.PermissionSetAttribute(System.Security.Permissions.SecurityAction.Demand, Name:=&quot;FullTrust&quot;)&gt; _\n        Protected Overrides Sub WndProc(ByRef m As Message)\n        &#39; Listen for operating system messages\n\n        Select Case (m.Msg)\n            Case WM_ACTIVATEAPP\n\n                &#39; Notify the form that this message was received.\n                &#39; Application is activated or deactivated, \n                &#39; based upon the WParam parameter.\n                parent.ApplicationActivated(m.WParam.ToInt32() &lt;&gt; 0)\n\n        End Select\n\n        MyBase.WndProc(m)\n    End Sub\nEnd Class\n</code></pre>\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc.json\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"fulldocset\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.fulldocset\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Windows.Forms.NativeWindow.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Windows.Forms.NativeWindow.yml\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow..ctor\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.AssignHandle\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.CreateHandle\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.DefWndProc\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.DestroyHandle\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.Finalize\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.FromHandle\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.Handle\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.OnHandleChange\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.OnThreadException\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.ReleaseHandle\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.NativeWindow.WndProc\">\r\n<meta name=\"APILocation\" content=\"System.Windows.Forms.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-01 01:37 AM\">\r\n<meta name=\"document_id\" content=\"9beb00c4-e399-5edf-df5f-cd92b2939fd6\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides a low-level encapsulation of a window handle and a window procedure.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/System.Windows.Forms/toc.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Windows.Forms.NativeWindow\">\r\n","rawMetadata":{"author":"dotnet-bot","breadcrumb_path":"breadcrumb/toc.json","search.ms_sitename":"Docs","search.ms_docsetname":"fulldocset","version":null,"_op_canonicalUrlPrefix":"https://ppe.docs.microsoft.com/en-us/fulldotnet/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":true,"depot_name":"MSDN.fulldocset","_op_gitRefSkeletonCommitHistory":[{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"use plugin in master","commit_sha":"501959ac03e19ac52a27aa4c6bbeb980f8b11c8c","commit_date":"2017-03-01 09:31:20 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"switch from platform to version","commit_sha":"78cdacb5ca782478af490a6b30c3a2cb2b6b873e","commit_date":"2017-02-28 15:09:51 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update platforms","commit_sha":"39ad5a8919a59afc93a79ac4bd8e07c3b471b37a","commit_date":"2017-02-28 10:38:59 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"checkin yml","commit_sha":"da161b792852497df7140d7768cee2eccd9cb43f","commit_date":"2017-02-28 09:36:15 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"delete ymls","commit_sha":"417c04fd1daf0cb211ec4909020356fc1fe69260","commit_date":"2017-02-27 14:12:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"update latest xml","commit_sha":"1e40a158586a88a698e0cb5342785002a56898b2","commit_date":"2017-02-24 16:20:57 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"add exceptions to reference section","commit_sha":"2f337ac32baa36b4ee4b5d8987b29dba4ce77336","commit_date":"2017-02-24 11:22:25 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"transform see cref and fix paramref format","commit_sha":"3d0ea34483c97ac77f4020a7f294757d67a5c1d4","commit_date":"2017-02-23 10:03:17 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"fix param transform, fix escaped xref","commit_sha":"2af997a764c82488dfa824f1c7bc4d736757d943","commit_date":"2017-02-22 17:04:48 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"convert exceptions","commit_sha":"0a5bf3370731dd35a596c91081e5dc82e2eace3a","commit_date":"2017-02-22 11:54:30 +0800"},{"author_name":"Tianqi Zhang","author_email":"tianzh@microsoft.com","committer_name":"Tianqi Zhang","comitter_email":"tianzh@microsoft.com","message":"remove _yml from url","commit_sha":"f9314af8858edb8c329d223328490093aef4f55f","commit_date":"2017-02-17 15:31:12 +0800"}],"ref_skeleton_gitcommit":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/501959ac03e19ac52a27aa4c6bbeb980f8b11c8c/fulldocset/System.Windows.Forms.NativeWindow.yml","original_ref_skeleton_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/System.Windows.Forms.NativeWindow.yml","open_to_public_contributors":true,"api_name":["System.Windows.Forms.NativeWindow","System.Windows.Forms.NativeWindow..ctor","System.Windows.Forms.NativeWindow.AssignHandle","System.Windows.Forms.NativeWindow.CreateHandle","System.Windows.Forms.NativeWindow.DefWndProc","System.Windows.Forms.NativeWindow.DestroyHandle","System.Windows.Forms.NativeWindow.Finalize","System.Windows.Forms.NativeWindow.FromHandle","System.Windows.Forms.NativeWindow.Handle","System.Windows.Forms.NativeWindow.OnHandleChange","System.Windows.Forms.NativeWindow.OnThreadException","System.Windows.Forms.NativeWindow.ReleaseHandle","System.Windows.Forms.NativeWindow.WndProc"],"api_location":["System.Windows.Forms.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Windows.Forms.NativeWindow","System::Windows::Forms::NativeWindow","System.Windows.Forms.NativeWindow.#ctor","System::Windows::Forms::NativeWindow::#ctor","System.Windows.Forms.NativeWindow.AssignHandle","System::Windows::Forms::NativeWindow::AssignHandle","System.Windows.Forms.NativeWindow.CreateHandle","System::Windows::Forms::NativeWindow::CreateHandle","System.Windows.Forms.NativeWindow.DefWndProc","System::Windows::Forms::NativeWindow::DefWndProc","System.Windows.Forms.NativeWindow.DestroyHandle","System::Windows::Forms::NativeWindow::DestroyHandle","System.Windows.Forms.NativeWindow.Finalize","System::Windows::Forms::NativeWindow::Finalize","System.Windows.Forms.NativeWindow.FromHandle","System::Windows::Forms::NativeWindow::FromHandle","System.Windows.Forms.NativeWindow.Handle","System::Windows::Forms::NativeWindow::Handle","System.Windows.Forms.NativeWindow.OnHandleChange","System::Windows::Forms::NativeWindow::OnHandleChange","System.Windows.Forms.NativeWindow.OnThreadException","System::Windows::Forms::NativeWindow::OnThreadException","System.Windows.Forms.NativeWindow.ReleaseHandle","System::Windows::Forms::NativeWindow::ReleaseHandle","System.Windows.Forms.NativeWindow.WndProc","System::Windows::Forms::NativeWindow::WndProc"],"dev_langs":["csharp"],"updated_at":"2017-03-01 01:37 AM","document_id":"9beb00c4-e399-5edf-df5f-cd92b2939fd6","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/fulldocset/xml/System.Windows.Forms/NativeWindow.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"NativeWindow class | Microsoft Docs","_op_ogTitle":"NativeWindow class","description":"Provides a low-level encapsulation of a window handle and a window procedure.\n","toc_asset_id":"_splitted/System.Windows.Forms/toc.json","toc_rel":"_splitted/System.Windows.Forms/toc.json","source_url":"","ms.assetid":"System.Windows.Forms.NativeWindow","canonical_url":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.windows.forms.nativewindow","_op_canonicalUrl":"https://ppe.docs.microsoft.com/en-us/mergedepotdynamic/system.windows.forms.nativewindow","fileRelativePath":"System.Windows.Forms.NativeWindow.html"},"themesRelativePathToOutputRoot":"_themes/"}